2021-09-18T07:48:43.6445940+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T07:48:43.8373651+05:30 800008a8-0001-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T07:48:43.9253168+05:30 800008a8-0001-fb00-b63f-84710c7967bb [INF] Request finished in 95.5389ms 404  (791a596a)
2021-09-18T07:49:59.4019233+05:30 80000435-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:49:59.4022805+05:30 80000094-0001-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:49:59.4026008+05:30 800008aa-0001-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:49:59.4118939+05:30 80000094-0001-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4118939+05:30 80000435-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4118939+05:30 800008aa-0001-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4202135+05:30 80000435-0001-fa00-b63f-84710c7967bb [INF] Request finished in 19.6074ms 204  (791a596a)
2021-09-18T07:49:59.4200277+05:30 800008aa-0001-fb00-b63f-84710c7967bb [INF] Request finished in 18.5416ms 204  (791a596a)
2021-09-18T07:49:59.4208786+05:30 80000094-0001-fc00-b63f-84710c7967bb [INF] Request finished in 18.7132ms 204  (791a596a)
2021-09-18T07:49:59.4283240+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:49:59.4285335+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:49:59.4292257+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4292258+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4316952+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:49:59.4318876+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.4429974+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:49:59.4429973+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:49:59.4429974+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:49:59.5897378+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:49:59.5897234+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:49:59.5897057+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:49:59.9802644+05:30 800004fc-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:49:59.9803982+05:30 800004fc-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.9810697+05:30 800004fc-0006-fb00-b63f-84710c7967bb [INF] Request finished in 0.6905ms 204  (791a596a)
2021-09-18T07:49:59.9872141+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:49:59.9873414+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:49:59.9938901+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:49:59.9981831+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:50:05.2087385+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:50:05.2087413+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:50:05.2087385+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:50:05.2087385+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:50:08.3152179+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("371"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:08.3476728+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T07:50:08.3579126+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 8758.5613ms (afa2e885)
2021-09-18T07:50:08.3580610+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:08.3719560+05:30 80000494-0004-ff00-b63f-84710c7967bb [INF] Request finished in 8943.4437ms 204  (791a596a)
2021-09-18T07:50:08.6591582+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("317"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:50:09.0917735+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("317"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T07:50:09.3886166+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("306"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:09.3923211+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T07:50:09.4442363+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 9853.6319ms (afa2e885)
2021-09-18T07:50:09.4445694+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:09.4470718+05:30 800002ae-0005-fe00-b63f-84710c7967bb [INF] Request finished in 10018.6841ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:10.2080339+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("378"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:50:10.9357052+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("286"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:50:11.2382770+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("549"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:11.5382028+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("315"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:50:11.5911232+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T07:50:11.6165890+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12026.2284ms (afa2e885)
2021-09-18T07:50:11.6166903+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:11.6201652+05:30 8000016f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 12192.076ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:11.6286391+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T07:50:11.6316117+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 11633.3087ms (afa2e885)
2021-09-18T07:50:11.6316746+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:11.7536006+05:30 800003aa-0005-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571314681217961"", Request ID ""800003aa-0005-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T07:50:11.7537265+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Request finished in 11766.6686ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:11.9702016+05:30 800003aa-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("356"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T07:50:12.4210164+05:30 800003aa-0005-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T07:50:26.3640255+05:30 80000171-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:50:26.3654899+05:30 800002ac-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:50:26.3655124+05:30 80000171-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3659654+05:30 800002ac-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3662685+05:30 800004f6-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:50:26.3665938+05:30 800004f6-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3672596+05:30 80000171-0006-fc00-b63f-84710c7967bb [INF] Request finished in 3.6403ms 204  (791a596a)
2021-09-18T07:50:26.3672763+05:30 800004f6-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.8757ms 204  (791a596a)
2021-09-18T07:50:26.3672946+05:30 800002ac-0007-ff00-b63f-84710c7967bb [INF] Request finished in 1.6595ms 204  (791a596a)
2021-09-18T07:50:26.3780104+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:50:26.3782124+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3787324+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:50:26.3791944+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3803838+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:50:26.3805260+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:26.3857462+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:50:26.3857463+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:50:26.3857655+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:50:26.3870944+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:50:26.3904884+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:50:26.3904976+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:50:30.2735674+05:30 8000012a-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:50:30.2741278+05:30 8000012a-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:30.2773232+05:30 8000012a-0002-ed00-b63f-84710c7967bb [INF] Request finished in 4.8872ms 204  (791a596a)
2021-09-18T07:50:31.6490507+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:50:31.6513378+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:50:36.5100456+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:50:36.5104546+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:50:36.5842687+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:50:36.8319761+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("331"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:36.8319516+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("320"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:36.8320035+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("331"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:50:40.5768056+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T07:50:40.5833457+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T07:50:40.5833434+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 14194.9871ms (afa2e885)
2021-09-18T07:50:40.5840924+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:40.5875454+05:30 80000173-0006-fc00-b63f-84710c7967bb [INF] Request finished in 14209.3642ms 204  (791a596a)
2021-09-18T07:50:40.5889307+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 14198.1692ms (afa2e885)
2021-09-18T07:50:40.5892556+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:40.5897718+05:30 8000077f-0002-f100-b63f-84710c7967bb [INF] Request finished in 14209.4955ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:41.2464227+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("315"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:50:42.0520348+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("399"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:50:42.0520339+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("406"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T07:50:42.0545733+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T07:50:42.0560255+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15665.4156ms (afa2e885)
2021-09-18T07:50:42.0561174+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:42.0563852+05:30 80000496-0004-ff00-b63f-84710c7967bb [INF] Request finished in 15677.7768ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:42.9843840+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("306"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:50:43.5975176+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("303"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:50:43.9545458+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T07:50:43.9569411+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 7445.9599ms (afa2e885)
2021-09-18T07:50:43.9572924+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:50:43.9713739+05:30 800004fe-0006-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456130900329725"", Request ID ""800004fe-0006-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T07:50:43.9721143+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Request finished in 12323.0103ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T07:50:44.3053063+05:30 800004fe-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("356"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T07:50:44.7217983+05:30 800004fe-0006-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T07:51:45.0247999+05:30 80000781-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:51:45.0263068+05:30 80000781-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0273642+05:30 8000043b-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:51:45.0297285+05:30 8000043b-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0344604+05:30 8000012c-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:51:45.0345080+05:30 80000781-0002-f100-b63f-84710c7967bb [INF] Request finished in 5.7785ms 204  (791a596a)
2021-09-18T07:51:45.0348037+05:30 8000043b-0003-f900-b63f-84710c7967bb [INF] Request finished in 7.8079ms 204  (791a596a)
2021-09-18T07:51:45.0447136+05:30 8000012c-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0451518+05:30 8000012c-0002-ed00-b63f-84710c7967bb [INF] Request finished in 14.6681ms 204  (791a596a)
2021-09-18T07:51:45.0466646+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:51:45.0496461+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0599795+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:51:45.0612826+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0614422+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:51:45.0612482+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:51:45.0648676+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:45.0648648+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:51:45.0649909+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:51:45.0653573+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:51:45.0653649+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:51:45.0653592+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:51:50.2531444+05:30 80000631-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:51:50.2534128+05:30 80000631-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:52.0487178+05:30 80000631-0000-f800-b63f-84710c7967bb [INF] Request finished in 1798.2898ms 204  (791a596a)
2021-09-18T07:51:55.0211565+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:51:55.0213006+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:51:55.0279077+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:51:55.0281314+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:51:55.9903836+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("972"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:51:55.9904042+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("971"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:51:55.9923633+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T07:51:55.9932451+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 10927.5263ms (afa2e885)
2021-09-18T07:51:55.9936008+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:51:55.9944299+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:51:55.9950604+05:30 80000783-0002-f100-b63f-84710c7967bb [INF] Request finished in 10948.7839ms 204  (791a596a)
2021-09-18T07:51:56.2920236+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("300"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:51:56.3304689+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("333"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T07:52:40.7701993+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("25,580"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:52:42.5885610+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("402"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:52:42.8849418+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("293"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:52:42.9230391+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("329"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:53:00.7411928+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("14,198"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:53:00.7468493+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T07:53:00.7475495+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T07:53:00.7623397+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 75696.8524ms (afa2e885)
2021-09-18T07:53:00.7627653+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:53:00.7644637+05:30 800000a1-0003-ff00-b63f-84710c7967bb [INF] Request finished in 75709.1796ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:53:00.7660866+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 75698.7634ms (afa2e885)
2021-09-18T07:53:00.7664960+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:53:00.7677216+05:30 8000043d-0003-f900-b63f-84710c7967bb [INF] Request finished in 75712.442ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:53:01.1176196+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T07:53:01.1198291+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 66091.5429ms (afa2e885)
2021-09-18T07:53:01.1202488+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:53:01.1305750+05:30 8000002d-0003-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628900129210412"", Request ID ""8000002d-0003-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T07:53:01.1308500+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Request finished in 66112.2368ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T07:53:01.5246094+05:30 8000002d-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("409"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T07:53:01.8768497+05:30 8000002d-0003-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T07:54:38.3452737+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T07:54:38.6047274+05:30 80000633-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T07:54:38.6835980+05:30 80000633-0000-f800-b63f-84710c7967bb [INF] Request finished in 82.0836ms 404  (791a596a)
2021-09-18T07:55:05.1555078+05:30 80000153-0006-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:55:05.1557208+05:30 8000165c-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:55:05.1835915+05:30 800008ac-0001-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:55:05.1892054+05:30 80000153-0006-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.1892385+05:30 800008ac-0001-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.1892472+05:30 8000165c-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.1951621+05:30 800008ac-0001-fb00-b63f-84710c7967bb [INF] Request finished in 11.7339ms 204  (791a596a)
2021-09-18T07:55:05.1951622+05:30 80000153-0006-fa00-b63f-84710c7967bb [INF] Request finished in 42.0387ms 204  (791a596a)
2021-09-18T07:55:05.1951621+05:30 8000165c-0006-fd00-b63f-84710c7967bb [INF] Request finished in 42.0016ms 204  (791a596a)
2021-09-18T07:55:05.2015274+05:30 800008ae-0001-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:55:05.2016411+05:30 800008ae-0001-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.2019397+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:55:05.2020368+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.2043426+05:30 8000002f-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:55:05.2044899+05:30 8000002f-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:05.2181966+05:30 8000002f-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:55:05.2181966+05:30 800008ae-0001-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:55:05.2183174+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:55:05.2859180+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:55:05.2859180+05:30 8000002f-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:55:05.2859180+05:30 800008ae-0001-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:55:08.2578482+05:30 800002ae-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:55:08.2583288+05:30 800002ae-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:08.2588689+05:30 800002ae-0007-ff00-b63f-84710c7967bb [INF] Request finished in 1.1112ms 204  (791a596a)
2021-09-18T07:55:08.2713847+05:30 80000096-0001-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:55:08.2715043+05:30 80000096-0001-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:55:08.2752816+05:30 80000096-0001-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:55:08.2823684+05:30 80000096-0001-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:55:09.0394510+05:30 80000096-0001-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:55:09.0394511+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:55:09.0394551+05:30 800008ae-0001-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:55:09.0394555+05:30 8000002f-0003-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:55:12.1055868+05:30 80000635-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("360"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:56:22.9322208+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T07:56:23.0467618+05:30 800003ac-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T07:56:23.1220802+05:30 800003ac-0005-fd00-b63f-84710c7967bb [INF] Request finished in 79.0386ms 404  (791a596a)
2021-09-18T07:56:47.7951080+05:30 800003ae-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:56:47.8114575+05:30 800003ae-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8165992+05:30 8000220a-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:56:47.8174974+05:30 8000220a-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8186530+05:30 8000220a-0002-f600-b63f-84710c7967bb [INF] Request finished in 2.2287ms 204  (791a596a)
2021-09-18T07:56:47.8186620+05:30 80000fda-0002-f400-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:56:47.8186530+05:30 800003ae-0005-fd00-b63f-84710c7967bb [INF] Request finished in 27.0084ms 204  (791a596a)
2021-09-18T07:56:47.8194331+05:30 80000fda-0002-f400-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8199046+05:30 80000fda-0002-f400-b63f-84710c7967bb [INF] Request finished in 1.2273ms 204  (791a596a)
2021-09-18T07:56:47.8379728+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:56:47.8379728+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:56:47.8380911+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8381013+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8454102+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:56:47.8455692+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:47.8540583+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:56:47.8540543+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:56:47.8540687+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:56:47.9471145+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:56:47.9471277+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:56:47.9471151+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:56:48.3618261+05:30 80000498-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:56:48.3626335+05:30 80000498-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:48.3632390+05:30 80000498-0004-ff00-b63f-84710c7967bb [INF] Request finished in 1.6682ms 204  (791a596a)
2021-09-18T07:56:48.3729542+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:56:48.3731427+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:56:48.3792277+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:56:48.3841565+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:56:51.6601025+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:56:51.6600989+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:56:51.6600976+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:56:51.6600976+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T07:56:54.3823387+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Executed DbCommand ("347"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:58:56.4915706+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("122,076"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:59:03.2390182+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T07:59:03.2531147+05:30 80000004-0002-ee00-b63f-84710c7967bb [ERR] An error occurred using the connection to database '"IoT-AppDatabase"' on server '"IoT-AppDatabase.mssql.somee.com"'. (5fc3407c)
2021-09-18T07:59:03.2531298+05:30 80000018-0002-f300-b63f-84710c7967bb [ERR] An error occurred using the connection to database '"IoT-AppDatabase"' on server '"IoT-AppDatabase.mssql.somee.com"'. (5fc3407c)
2021-09-18T07:59:03.2702960+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 135297.5875ms (afa2e885)
2021-09-18T07:59:03.2705965+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:59:03.3187912+05:30 80000fdc-0002-f400-b63f-84710c7967bb [INF] Request finished in 135481.0245ms 204  (791a596a)
2021-09-18T07:59:03.3491732+05:30 80000004-0002-ee00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
2021-09-18T07:59:03.3500772+05:30 80000018-0002-f300-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. Consider enabling transient error resiliency by adding 'EnableRetryOnFailure()' to the 'UseSqlServer' call.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: TCP Provider, error: 0 - An existing connection was forcibly closed by the remote host.)
 ---> System.ComponentModel.Win32Exception (10054): An existing connection was forcibly closed by the remote host.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
ClientConnectionId:e1949a6b-8e67-47ba-b572-818ef6cd0730
Error Number:10054,State:0,Class:20
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. Consider enabling transient error resiliency by adding 'EnableRetryOnFailure()' to the 'UseSqlServer' call.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: TCP Provider, error: 0 - An existing connection was forcibly closed by the remote host.)
 ---> System.ComponentModel.Win32Exception (10054): An existing connection was forcibly closed by the remote host.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
ClientConnectionId:e1949a6b-8e67-47ba-b572-818ef6cd0730
Error Number:10054,State:0,Class:20
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 120
   at IoT.DataLayer.Repository.UserRepository.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 101
   at IoT.BusinessLayer.UserBL.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 47
   at IoT.WebAPI.Controllers.UserController.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 74
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
2021-09-18T07:59:15.0599749+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 147111.2733ms (afa2e885)
2021-09-18T07:59:15.0599749+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 146674.745ms (afa2e885)
2021-09-18T07:59:15.0641596+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:59:15.0641598+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:59:15.1236239+05:30 80000004-0002-ee00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 31
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-09-18T07:59:15.1236563+05:30 80000018-0002-f300-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. Consider enabling transient error resiliency by adding 'EnableRetryOnFailure()' to the 'UseSqlServer' call.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: TCP Provider, error: 0 - An existing connection was forcibly closed by the remote host.)
 ---> System.ComponentModel.Win32Exception (10054): An existing connection was forcibly closed by the remote host.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
ClientConnectionId:e1949a6b-8e67-47ba-b572-818ef6cd0730
Error Number:10054,State:0,Class:20
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 120
   at IoT.DataLayer.Repository.UserRepository.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 101
   at IoT.BusinessLayer.UserBL.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 47
   at IoT.WebAPI.Controllers.UserController.GetAllUserPermissions(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 74
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-09-18T07:59:15.1620541+05:30 80000018-0002-f300-b63f-84710c7967bb [INF] Request finished in 147324.4798ms 500 text/plain (791a596a)
2021-09-18T07:59:15.1620541+05:30 80000004-0002-ee00-b63f-84710c7967bb [INF] Request finished in 146789.5446ms 500 text/plain (791a596a)
2021-09-18T07:59:15.8953626+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("310"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T07:59:16.5422257+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("309"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:59:16.6058889+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T07:59:16.6581920+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 148710.5793ms (afa2e885)
2021-09-18T07:59:16.6583614+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:59:16.6639837+05:30 8000220c-0002-f600-b63f-84710c7967bb [INF] Request finished in 148826.2784ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T07:59:25.1269316+05:30 8000027c-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:59:25.1278580+05:30 8000165e-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:59:25.1284499+05:30 8000027c-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1301105+05:30 8000165e-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1311795+05:30 8000027c-0005-fc00-b63f-84710c7967bb [INF] Request finished in 4.4643ms 204  (791a596a)
2021-09-18T07:59:25.1377988+05:30 8000165e-0006-fd00-b63f-84710c7967bb [INF] Request finished in 10.5269ms 204  (791a596a)
2021-09-18T07:59:25.1388541+05:30 80000500-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T07:59:25.1395133+05:30 80000500-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1409554+05:30 80000500-0006-fb00-b63f-84710c7967bb [INF] Request finished in 2.1326ms 204  (791a596a)
2021-09-18T07:59:25.1546089+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T07:59:25.1548202+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1557600+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T07:59:25.1558280+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T07:59:25.1558608+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1560011+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:25.1627811+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T07:59:25.1627811+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T07:59:25.1627811+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T07:59:25.1638683+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:59:25.1681954+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:59:27.8345923+05:30 800003b0-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T07:59:27.8348287+05:30 800003b0-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:27.8353967+05:30 800003b0-0005-fd00-b63f-84710c7967bb [INF] Request finished in 0.9329ms 204  (791a596a)
2021-09-18T07:59:27.8356915+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:59:31.3596295+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T07:59:31.3603786+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T07:59:31.3662547+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T07:59:31.3667737+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T07:59:31.6730972+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("310"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T07:59:31.9837001+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("307"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T07:59:36.3156035+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4,325"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T07:59:57.8919848+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T07:59:57.8941024+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30057.7025ms (afa2e885)
2021-09-18T07:59:57.8950968+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T07:59:57.8987535+05:30 8000027e-0005-fc00-b63f-84710c7967bb [INF] Request finished in 32742.4669ms 204  (791a596a)
2021-09-18T07:59:58.1871705+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("13,417"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:00:19.1167160+05:30 8000043f-0003-f900-b63f-84710c7967bb [ERR] An error occurred using the connection to database '"IoT-AppDatabase"' on server '"IoT-AppDatabase.mssql.somee.com"'. (5fc3407c)
2021-09-18T08:00:19.1277737+05:30 8000043f-0003-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.)
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction(IsolationLevel isolationLevel)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(DbContext _, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
ClientConnectionId:e4690faf-366d-4a05-931f-67952e2f6ebb
Error Number:258,State:0,Class:20" (170f029e)
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.)
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction(IsolationLevel isolationLevel)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(DbContext _, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 59
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 22
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
ClientConnectionId:e4690faf-366d-4a05-931f-67952e2f6ebb
Error Number:258,State:0,Class:20
2021-09-18T08:00:23.3986704+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4,278"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:00:23.4010024+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 58236.1706ms (afa2e885)
2021-09-18T08:00:23.4014430+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:00:23.4037936+05:30 8000043f-0003-f900-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.)
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction(IsolationLevel isolationLevel)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.BeginTransaction()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(DbContext _, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 59
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 22
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:e4690faf-366d-4a05-931f-67952e2f6ebb
Error Number:258,State:0,Class:20
2021-09-18T08:00:23.4075592+05:30 8000043f-0003-f900-b63f-84710c7967bb [INF] Request finished in 58251.1085ms 500 text/plain (791a596a)
2021-09-18T08:00:23.7740931+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("362"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:00:23.7766011+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:00:23.7817060+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 58611.737ms (afa2e885)
2021-09-18T08:00:23.7819229+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:00:23.7826205+05:30 80000031-0003-fe00-b63f-84710c7967bb [INF] Request finished in 58627.3575ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:00:24.0952125+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("280"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:00:24.5589673+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:00:24.5705808+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 53202.5978ms (afa2e885)
2021-09-18T08:00:24.5707936+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:00:24.6050866+05:30 8000049a-0004-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686498462106777"", Request ID ""8000049a-0004-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:00:24.6054387+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Request finished in 53245.0661ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:00:24.8147541+05:30 8000049a-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("294"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:00:25.2303678+05:30 8000049a-0004-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:01:10.9089956+05:30 80000508-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:01:10.9088710+05:30 8000049c-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:01:10.9102178+05:30 8000049c-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:10.9102178+05:30 80000508-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:10.9128608+05:30 80000508-0004-fc00-b63f-84710c7967bb [INF] Request finished in 3.8435ms 204  (791a596a)
2021-09-18T08:01:10.9128874+05:30 8000049c-0004-ff00-b63f-84710c7967bb [INF] Request finished in 4.9476ms 204  (791a596a)
2021-09-18T08:01:10.9259066+05:30 80000502-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:01:10.9266221+05:30 80000502-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:10.9281510+05:30 80000502-0006-fb00-b63f-84710c7967bb [INF] Request finished in 6.3765ms 204  (791a596a)
2021-09-18T08:01:10.9346239+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:01:10.9347733+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:10.9365912+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:01:10.9375927+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:01:10.9378382+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:01:10.9379725+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:10.9382050+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:01:10.9384576+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:01:14.5739832+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:01:14.5742320+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:14.5746187+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:01:14.5751790+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:01:14.5875277+05:30 80000504-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:01:14.5899602+05:30 80000504-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:14.5905163+05:30 80000504-0006-fb00-b63f-84710c7967bb [INF] Request finished in 3.3272ms 204  (791a596a)
2021-09-18T08:01:14.6103882+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:01:14.6105962+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:01:14.6129180+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:01:14.6207972+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:01:14.7174643+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:01:14.8886971+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("266"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:01:18.5914406+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3,969"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:01:18.5914693+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("3,702"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:01:18.5935408+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T08:01:18.5940022+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:01:18.5944022+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7656.2223ms (afa2e885)
2021-09-18T08:01:18.5945832+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:01:18.5959951+05:30 80000098-0001-fc00-b63f-84710c7967bb [INF] Request finished in 7661.1998ms 204  (791a596a)
2021-09-18T08:01:18.6014657+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 7662.4113ms (afa2e885)
2021-09-18T08:01:18.6017483+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:01:18.6032362+05:30 800008b0-0001-fb00-b63f-84710c7967bb [INF] Request finished in 7665.1636ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:01:19.2910711+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("306"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:01:19.9048026+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("334"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:01:19.9047836+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("308"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:01:20.2244718+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:01:20.2288915+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 5607.0847ms (afa2e885)
2021-09-18T08:01:20.2293536+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:01:20.2444923+05:30 8000220e-0002-f600-b63f-84710c7967bb [ERR] Connection ID ""17726168143530828301"", Request ID ""8000220e-0002-f600-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:01:20.2450350+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Request finished in 5634.6433ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:01:20.4860446+05:30 8000220e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("268"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:01:20.5222584+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("303"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:01:20.8383987+05:30 8000220e-0002-f600-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:01:21.1376399+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("302"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:01:21.1402200+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:01:21.1461231+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 6570.2787ms (afa2e885)
2021-09-18T08:01:21.1467865+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:01:21.1480703+05:30 80000437-0001-fa00-b63f-84710c7967bb [INF] Request finished in 6573.8422ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:02:36.8809734+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T08:02:37.1117530+05:30 8000050a-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T08:02:37.1755431+05:30 8000050a-0004-fc00-b63f-84710c7967bb [INF] Request finished in 68.26ms 404  (791a596a)
2021-09-18T08:02:49.5899870+05:30 8000050c-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:02:49.5913670+05:30 80000002-0001-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:02:49.5915096+05:30 800004f9-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:02:49.6012406+05:30 800004f9-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6012405+05:30 8000050c-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6012405+05:30 80000002-0001-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6079475+05:30 800004f9-0007-fe00-b63f-84710c7967bb [INF] Request finished in 27.9021ms 204  (791a596a)
2021-09-18T08:02:49.6079474+05:30 8000050c-0004-fc00-b63f-84710c7967bb [INF] Request finished in 39.9304ms 204  (791a596a)
2021-09-18T08:02:49.6079474+05:30 80000002-0001-f900-b63f-84710c7967bb [INF] Request finished in 29.9439ms 204  (791a596a)
2021-09-18T08:02:49.6135834+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:02:49.6135864+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:02:49.6140285+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6140284+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6200368+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:02:49.6201743+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:49.6259360+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:02:49.6259307+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:02:49.6259307+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:02:49.7225924+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:02:49.7225948+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:02:49.7225982+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:02:50.2386066+05:30 80000280-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:02:50.2387362+05:30 80000280-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:50.2394480+05:30 80000280-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.7328ms 204  (791a596a)
2021-09-18T08:02:50.2452072+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:02:50.2453485+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:02:50.2494412+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:02:50.2529824+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:02:51.2128211+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:02:51.2128211+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:02:51.2128211+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:02:51.2128211+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:02:52.6792392+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("82"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:02:52.6792309+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Executed DbCommand ("91"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:02:52.6792309+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Executed DbCommand ("91"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:02:52.6792896+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executed DbCommand ("86"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:02:52.7052545+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T08:02:52.7054134+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:02:52.7184249+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2983.9869ms (afa2e885)
2021-09-18T08:02:52.7186505+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:02:52.7331924+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 3009.7458ms (afa2e885)
2021-09-18T08:02:52.7333262+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:02:52.7399453+05:30 80000002-0001-f700-b63f-84710c7967bb [INF] Request finished in 3126.3144ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:02:52.7399798+05:30 80000002-0001-f800-b63f-84710c7967bb [INF] Request finished in 3126.4171ms 204  (791a596a)
2021-09-18T08:02:52.8942123+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:02:52.9021465+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:02:52.9217550+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:02:52.9360093+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:02:52.9607957+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:02:52.9965268+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 3272.9328ms (afa2e885)
2021-09-18T08:02:52.9966799+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:02:53.0049823+05:30 80000004-0001-f900-b63f-84710c7967bb [INF] Request finished in 3391.8115ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:02:53.0698706+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("21"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:02:53.0716740+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:02:53.0780989+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 2824.8808ms (afa2e885)
2021-09-18T08:02:53.0782054+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:02:53.1766062+05:30 80000787-0002-f100-b63f-84710c7967bb [ERR] Connection ID ""17365880173341181830"", Request ID ""80000787-0002-f100-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:02:53.1767688+05:30 80000787-0002-f100-b63f-84710c7967bb [INF] Request finished in 2931.59ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:02:53.1849021+05:30 80000787-0002-f100-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:04:54.6192665+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T08:04:54.7485633+05:30 80000637-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T08:04:54.8514206+05:30 80000637-0000-f800-b63f-84710c7967bb [INF] Request finished in 112.0482ms 404  (791a596a)
2021-09-18T08:05:19.7895123+05:30 800002b0-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:05:19.7895111+05:30 80000156-0006-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:05:19.7938920+05:30 80000157-0007-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:05:19.8162729+05:30 800002b0-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8162730+05:30 80000157-0007-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8162730+05:30 80000156-0006-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8226175+05:30 80000157-0007-fd00-b63f-84710c7967bb [INF] Request finished in 34.3023ms 204  (791a596a)
2021-09-18T08:05:19.8226051+05:30 800002b0-0007-ff00-b63f-84710c7967bb [INF] Request finished in 44.0321ms 204  (791a596a)
2021-09-18T08:05:19.8226050+05:30 80000156-0006-fa00-b63f-84710c7967bb [INF] Request finished in 35.2947ms 204  (791a596a)
2021-09-18T08:05:19.8295663+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:05:19.8305941+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8331948+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:05:19.8333499+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8351099+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:05:19.8355982+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:19.8385403+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:05:19.8385558+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:05:19.8386871+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:05:19.9671186+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:05:19.9671188+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:05:19.9671186+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:05:20.4320609+05:30 8000001a-0002-f300-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:05:20.4322139+05:30 8000001a-0002-f300-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:20.4328577+05:30 8000001a-0002-f300-b63f-84710c7967bb [INF] Request finished in 0.804ms 204  (791a596a)
2021-09-18T08:05:20.4391958+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:05:20.4393757+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:05:20.4449230+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:05:20.4492457+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:05:22.0592871+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:05:22.0592842+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:05:22.0592870+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:05:22.0593102+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:05:23.6635901+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("147"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:05:23.6636388+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("165"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:05:23.6636405+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("156"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:05:23.6636471+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("165"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:06:03.8766115+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:06:03.9546379+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 43977.994ms (afa2e885)
2021-09-18T08:06:03.9547449+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:06:03.9641703+05:30 80002210-0002-f600-b63f-84710c7967bb [INF] Request finished in 44134.7115ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:06:03.9792680+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserPermissionId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:06:03.9798902+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:06:03.9827616+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 44014.7988ms (afa2e885)
2021-09-18T08:06:03.9828462+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:06:03.9831516+05:30 80000145-0001-fd00-b63f-84710c7967bb [INF] Request finished in 44150.1167ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:06:04.0007525+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:06:04.0067560+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:06:04.0185450+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:06:04.0196367+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:06:04.0253770+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 44057.4308ms (afa2e885)
2021-09-18T08:06:04.0256377+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:06:04.0325137+05:30 80000441-0003-f900-b63f-84710c7967bb [INF] Request finished in 44200.8913ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:06:04.0369861+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:06:04.0972195+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:06:04.1008405+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:06:04.1048128+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 43655.373ms (afa2e885)
2021-09-18T08:06:04.1049199+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:06:04.1569094+05:30 80000159-0007-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571323271151960"", Request ID ""80000159-0007-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:06:04.1570785+05:30 80000159-0007-fd00-b63f-84710c7967bb [INF] Request finished in 43717.9744ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:06:04.1641041+05:30 80000159-0007-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:13:30.1025807+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T08:13:30.2486202+05:30 80000147-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T08:13:30.3148907+05:30 80000147-0001-fd00-b63f-84710c7967bb [INF] Request finished in 68.6433ms 404  (791a596a)
2021-09-18T08:13:49.6702117+05:30 800002b0-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:13:49.6701576+05:30 800003b2-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:13:49.6711438+05:30 80000443-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:13:49.6844904+05:30 800003b2-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.6844903+05:30 800002b0-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.6844903+05:30 80000443-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.6897466+05:30 80000443-0003-f900-b63f-84710c7967bb [INF] Request finished in 19.1292ms 204  (791a596a)
2021-09-18T08:13:49.6897466+05:30 800003b2-0005-fd00-b63f-84710c7967bb [INF] Request finished in 31.5255ms 204  (791a596a)
2021-09-18T08:13:49.6903891+05:30 800002b0-0005-fe00-b63f-84710c7967bb [INF] Request finished in 25.339ms 204  (791a596a)
2021-09-18T08:13:49.6974300+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:13:49.6975650+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:13:49.6980819+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.6980818+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.7080504+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:13:49.7082328+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:49.7186559+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:13:49.7186559+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:13:49.7204118+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:13:49.8522124+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:13:49.8522080+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:13:49.8522080+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:13:50.2639450+05:30 80003346-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:13:50.2640411+05:30 80003346-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:50.2646063+05:30 80003346-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.6282ms 204  (791a596a)
2021-09-18T08:13:50.2690707+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:13:50.2691761+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:13:50.2724995+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:13:50.2758245+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:13:51.9720549+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:13:51.9720549+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:13:51.9720549+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:13:51.9721104+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:13:53.3756252+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("107"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:13:53.3756834+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("103"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:13:53.3756834+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("107"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:13:53.3757029+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("96"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:14:10.1736625+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:14:10.3824043+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 20522.2002ms (afa2e885)
2021-09-18T08:14:10.3825118+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:14:10.3911634+05:30 80000149-0001-fd00-b63f-84710c7967bb [INF] Request finished in 20693.6761ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:14:10.4121178+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:14:10.4180890+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:14:10.4212376+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:14:12.6049727+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:14:12.6367368+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:14:12.6394228+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:14:12.6461277+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 22792.9796ms (afa2e885)
2021-09-18T08:14:12.6463433+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:14:12.6475692+05:30 8000049e-0004-ff00-b63f-84710c7967bb [INF] Request finished in 22950.2862ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:14:12.6553181+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 22802.3056ms (afa2e885)
2021-09-18T08:14:12.6572002+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:14:12.6774571+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:14:12.7084287+05:30 8000050e-0004-fc00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
System.Text.Json.JsonException: A possible object cycle was detected. This can either be due to a cycle or if the object depth is larger than the maximum allowed depth of 32. Consider using ReferenceHandler.Preserve on JsonSerializerOptions to support cycles.
   at System.Text.Json.ThrowHelper.ThrowJsonException_SerializerCycleDetected(Int32 maxDepth)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ICollectionOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.ListOfTConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCoreAsObject(Utf8JsonWriter writer, Object value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteCore[TValue](JsonConverter jsonConverter, Utf8JsonWriter writer, TValue& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteAsyncCore[TValue](Stream utf8Json, TValue value, Type inputType, JsonSerializerOptions options, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-09-18T08:14:12.7308263+05:30 8000050e-0004-fc00-b63f-84710c7967bb [INF] Request finished in 23033.562ms 500 text/plain (791a596a)
2021-09-18T08:14:12.7689629+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("14"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:14:12.7702961+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:14:12.7756944+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 22499.6887ms (afa2e885)
2021-09-18T08:14:12.7758039+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:14:12.7998032+05:30 80000158-0006-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398536862400855"", Request ID ""80000158-0006-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:14:12.7999574+05:30 80000158-0006-fa00-b63f-84710c7967bb [INF] Request finished in 22531.0412ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:14:12.8318068+05:30 80000158-0006-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:16:29.7487431+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T08:16:29.9236574+05:30 8000009b-0001-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T08:16:30.0592492+05:30 8000009b-0001-fc00-b63f-84710c7967bb [INF] Request finished in 134.8083ms 404  (791a596a)
2021-09-18T08:16:39.6123852+05:30 80000283-0000-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:16:39.6130293+05:30 8000015a-0006-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:16:39.6130996+05:30 80001ded-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:16:39.6283536+05:30 8000015a-0006-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6283562+05:30 80001ded-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6283535+05:30 80000283-0000-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6365592+05:30 80000283-0000-fc00-b63f-84710c7967bb [INF] Request finished in 38.3131ms 204  (791a596a)
2021-09-18T08:16:39.6365594+05:30 80001ded-0000-fb00-b63f-84710c7967bb [INF] Request finished in 25.5114ms 204  (791a596a)
2021-09-18T08:16:39.6365743+05:30 8000015a-0006-fa00-b63f-84710c7967bb [INF] Request finished in 30.8807ms 204  (791a596a)
2021-09-18T08:16:39.6528645+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:16:39.6530496+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:16:39.6540849+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6540849+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6554411+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:16:39.6563020+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:39.6698016+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:16:39.6698134+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:16:39.6698013+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:16:39.7909755+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:16:39.7909763+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:16:39.7909940+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:16:40.2012391+05:30 80001def-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:16:40.2015505+05:30 80001def-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:40.2027381+05:30 80001def-0000-fb00-b63f-84710c7967bb [INF] Request finished in 1.6011ms 204  (791a596a)
2021-09-18T08:16:40.2148503+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:16:40.2150288+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:16:40.2214686+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:16:40.2263429+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:16:41.9085958+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:16:41.9085898+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:16:41.9086015+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:16:41.9085908+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:16:43.4302778+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("89"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:16:43.4302429+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("91"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:16:43.4303241+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("84"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:16:43.4303052+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("92"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:16:43.6151310+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:16:43.7012871+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3890.5191ms (afa2e885)
2021-09-18T08:16:43.7015461+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:16:43.7251468+05:30 8000009d-0001-fc00-b63f-84710c7967bb [INF] Request finished in 4077.513ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:16:43.7538667+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:16:43.7814590+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:16:43.7861004+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 3994.3195ms (afa2e885)
2021-09-18T08:16:43.7862512+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:16:43.7867554+05:30 8000043a-0001-fa00-b63f-84710c7967bb [INF] Request finished in 4133.8119ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:16:43.8020193+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:16:43.8093235+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:16:43.8324405+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:16:43.8338116+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:16:43.8467705+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 4055.0564ms (afa2e885)
2021-09-18T08:16:43.8469274+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:16:43.8537249+05:30 80000510-0004-fc00-b63f-84710c7967bb [INF] Request finished in 4208.7823ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:16:43.8614057+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:16:43.9952282+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("23"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:16:44.0013190+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:16:44.0076827+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 3781.0701ms (afa2e885)
2021-09-18T08:16:44.0079114+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:16:44.1129190+05:30 80001df1-0000-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456105130532336"", Request ID ""80001df1-0000-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:16:44.1131429+05:30 80001df1-0000-fb00-b63f-84710c7967bb [INF] Request finished in 3898.3862ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:16:44.1235933+05:30 80001df1-0000-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:17:09.6569589+05:30 80001df3-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:17:09.6569589+05:30 8000015c-0006-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:17:09.6597329+05:30 80001df3-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6597329+05:30 8000015c-0006-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6601005+05:30 80000283-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:17:09.6606114+05:30 80000283-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6619629+05:30 80000283-0005-fc00-b63f-84710c7967bb [INF] Request finished in 1.8364ms 204  (791a596a)
2021-09-18T08:17:09.6619629+05:30 80001df3-0000-fb00-b63f-84710c7967bb [INF] Request finished in 6.3198ms 204  (791a596a)
2021-09-18T08:17:09.6625381+05:30 8000015c-0006-fa00-b63f-84710c7967bb [INF] Request finished in 8.2102ms 204  (791a596a)
2021-09-18T08:17:09.6801371+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:17:09.6802977+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6846177+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:17:09.6847894+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6854193+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:17:09.6855599+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:09.6896245+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:09.6898080+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:09.6905311+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:09.6916893+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:09.6961269+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:09.6961268+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:09.7081200+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:09.7090286+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:09.7098266+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:17:09.7115436+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:17:09.7121518+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:17:09.7123734+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.0182ms (afa2e885)
2021-09-18T08:17:09.7124780+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:09.7128638+05:30 80001df5-0000-fb00-b63f-84710c7967bb [INF] Request finished in 27.4999ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:09.7139077+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:17:09.7146394+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 22.4585ms (afa2e885)
2021-09-18T08:17:09.7148964+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:09.7151447+05:30 80000285-0000-fc00-b63f-84710c7967bb [INF] Request finished in 30.5613ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:09.7203943+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:17:09.7262198+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:17:09.7266310+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:17:09.7271962+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 30.9178ms (afa2e885)
2021-09-18T08:17:09.7272933+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:09.7274465+05:30 8000043c-0001-fa00-b63f-84710c7967bb [INF] Request finished in 47.4474ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:38.0467147+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-18T08:17:38.1713797+05:30 80000512-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:17:38.1713797+05:30 80000132-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-18T08:17:38.1859136+05:30 80000512-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:38.2116066+05:30 80000512-0004-fc00-b63f-84710c7967bb [INF] Request finished in 46.4766ms 204  (791a596a)
2021-09-18T08:17:38.2124048+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:17:38.2128337+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:38.3070414+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:38.3085245+05:30 80000132-0002-ed00-b63f-84710c7967bb [INF] Request finished in 144.2636ms 404  (791a596a)
2021-09-18T08:17:38.4423653+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:39.5452701+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:17:40.3861197+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("41"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:17:40.5342061+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:17:40.5718798+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:40.6366485+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("14"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:17:40.6442897+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:17:40.6936053+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 2242.5141ms (afa2e885)
2021-09-18T08:17:40.6937211+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:40.7022160+05:30 800004fc-0007-fe00-b63f-84710c7967bb [INF] Request finished in 2491.6279ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:48.3334275+05:30 800004fe-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:17:48.3402569+05:30 80000073-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:17:48.3412276+05:30 8000014c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:17:48.3418557+05:30 800004fe-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3454113+05:30 8000014c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3453120+05:30 80000073-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3511120+05:30 800004fe-0007-fe00-b63f-84710c7967bb [INF] Request finished in 20.2865ms 204  (791a596a)
2021-09-18T08:17:48.3547119+05:30 8000014c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 15.3166ms 204  (791a596a)
2021-09-18T08:17:48.3577792+05:30 80000073-0000-f700-b63f-84710c7967bb [INF] Request finished in 17.3417ms 204  (791a596a)
2021-09-18T08:17:48.3640310+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:17:48.3640303+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:17:48.3640304+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:17:48.3649630+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3649641+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3649630+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.3718956+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:48.3718902+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:48.3719686+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:48.3791817+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:48.3794167+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:48.3795381+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:48.4139651+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:48.4385075+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:17:48.4385074+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:17:48.4442513+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:17:48.4458915+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:17:48.4468872+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:48.4568488+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 77.1038ms (afa2e885)
2021-09-18T08:17:48.4569944+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:48.4574740+05:30 800003b4-0005-fd00-b63f-84710c7967bb [INF] Request finished in 94.2419ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:48.4788623+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:17:48.4848330+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:17:48.4858150+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:17:48.4916101+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 112.2331ms (afa2e885)
2021-09-18T08:17:48.4916749+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:48.4938531+05:30 80000035-0003-fe00-b63f-84710c7967bb [INF] Request finished in 130.685ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:48.5032095+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:17:48.5110422+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:17:48.5122560+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 132.7078ms (afa2e885)
2021-09-18T08:17:48.5123502+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:48.5130091+05:30 80000445-0003-f900-b63f-84710c7967bb [INF] Request finished in 149.8672ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:48.8774865+05:30 80000514-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:17:48.8789726+05:30 80000514-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.8806070+05:30 80000514-0004-fc00-b63f-84710c7967bb [INF] Request finished in 3.9145ms 204  (791a596a)
2021-09-18T08:17:48.8892701+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:17:48.8894833+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:17:48.8928927+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:17:48.8946325+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:17:48.9126830+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:17:48.9306597+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:17:48.9384435+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:17:48.9539308+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:17:48.9559761+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 60.4946ms (afa2e885)
2021-09-18T08:17:48.9562278+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:17:48.9604448+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:17:49.0661552+05:30 80000447-0003-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340929939571782"", Request ID ""80000447-0003-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:17:49.0663813+05:30 80000447-0003-f900-b63f-84710c7967bb [INF] Request finished in 177.2215ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:17:49.0676601+05:30 80000447-0003-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:18:20.3899185+05:30 800003b6-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:18:20.3941696+05:30 800003b6-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.3958317+05:30 80000500-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:18:20.3983224+05:30 80000500-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.4009929+05:30 80000500-0007-fe00-b63f-84710c7967bb [INF] Request finished in 6.0153ms 204  (791a596a)
2021-09-18T08:18:20.4023703+05:30 800003b6-0005-fd00-b63f-84710c7967bb [INF] Request finished in 14.1477ms 204  (791a596a)
2021-09-18T08:18:20.4238460+05:30 80000516-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:18:20.4244183+05:30 80000516-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.4262828+05:30 80000516-0004-fc00-b63f-84710c7967bb [INF] Request finished in 2.5068ms 204  (791a596a)
2021-09-18T08:18:20.4336833+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:18:20.4342432+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.4348957+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:18:20.4355822+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.4433017+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:18:20.4433027+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:18:20.4442537+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:18:20.4442450+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:18:20.4463146+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:18:20.4466089+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:18:20.4474206+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:18:20.4479978+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:18:20.4542928+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:18:20.4566922+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:18:20.4594531+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 14.7479ms (afa2e885)
2021-09-18T08:18:20.4596624+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:18:20.4597346+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:18:20.4603409+05:30 800002b2-0005-fe00-b63f-84710c7967bb [INF] Request finished in 25.7603ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:18:20.4665153+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:18:20.4760319+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:18:20.4763681+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:18:20.4828728+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:18:20.4858156+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:18:20.4864811+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:18:20.4873405+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:18:20.4892116+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 43.9481ms (afa2e885)
2021-09-18T08:18:20.4893953+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:18:20.4898678+05:30 800003b8-0005-fd00-b63f-84710c7967bb [INF] Request finished in 56.4212ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:18:20.4964755+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 48.2312ms (afa2e885)
2021-09-18T08:18:20.4966375+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:18:20.4970565+05:30 80000518-0004-fc00-b63f-84710c7967bb [INF] Request finished in 51.0284ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:20:18.7241490+05:30 80000286-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:20:18.7246949+05:30 80000286-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:18.7254488+05:30 80000286-0005-fc00-b63f-84710c7967bb [INF] Request finished in 2.1733ms 204  (791a596a)
2021-09-18T08:20:18.7307781+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:20:18.7309320+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:18.7327491+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:20:18.7334372+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:20:18.7484925+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:20:18.7548819+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:20:18.7593061+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:20:18.7633345+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:20:18.7640214+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 30.4549ms (afa2e885)
2021-09-18T08:20:18.7641385+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:20:18.7667131+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:20:18.7689376+05:30 8000078d-0002-f100-b63f-84710c7967bb [ERR] Connection ID ""17365880173341181836"", Request ID ""8000078d-0002-f100-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:20:18.7691196+05:30 8000078d-0002-f100-b63f-84710c7967bb [INF] Request finished in 38.563ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:20:18.7768651+05:30 8000078d-0002-f100-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T08:20:21.0300345+05:30 80000075-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:20:21.0306101+05:30 8000051a-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:20:21.0306394+05:30 80000075-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0316371+05:30 8000051a-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0323460+05:30 8000078f-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:20:21.0330488+05:30 8000078f-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0331815+05:30 8000051a-0004-fc00-b63f-84710c7967bb [INF] Request finished in 2.7363ms 204  (791a596a)
2021-09-18T08:20:21.0332217+05:30 80000075-0000-f700-b63f-84710c7967bb [INF] Request finished in 11.5196ms 204  (791a596a)
2021-09-18T08:20:21.0343833+05:30 8000078f-0002-f100-b63f-84710c7967bb [INF] Request finished in 1.9762ms 204  (791a596a)
2021-09-18T08:20:21.0487818+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:20:21.0487800+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:20:21.0497851+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0498117+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0531935+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:20:21.0534094+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:20:21.0535767+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.0608336+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:20:21.0616719+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:20:21.0621986+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:20:21.0622733+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:20:21.0630770+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:20:21.0692469+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:20:21.0727805+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:20:21.0767212+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:20:21.0832312+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:20:21.0844494+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:20:21.0863772+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:20:21.0863845+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:20:21.0890260+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 25.6992ms (afa2e885)
2021-09-18T08:20:21.0892068+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:20:21.0897283+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 27.7522ms (afa2e885)
2021-09-18T08:20:21.0899014+05:30 8000014e-0001-fd00-b63f-84710c7967bb [INF] Request finished in 36.8489ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:20:21.0899263+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:20:21.0912992+05:30 80000288-0005-fc00-b63f-84710c7967bb [INF] Request finished in 42.5463ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:20:21.0940106+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:20:21.1062434+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:20:21.1071425+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:20:21.1081933+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 45.7304ms (afa2e885)
2021-09-18T08:20:21.1083167+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:20:21.1086188+05:30 80000077-0000-f700-b63f-84710c7967bb [INF] Request finished in 60.0414ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:20:21.6945979+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:20:21.6951897+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:20:21.6961474+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:20:21.6974069+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:20:21.7085430+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:20:21.7195690+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:20:21.7247096+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:20:21.7352730+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:20:21.7356157+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:20:21.7377319+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 39.8965ms (afa2e885)
2021-09-18T08:20:21.7379347+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:20:21.7388219+05:30 8000028a-0005-fc00-b63f-84710c7967bb [INF] Request finished in 44.2791ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:21:09.1378590+05:30 80001660-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:21:09.1382088+05:30 80001660-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1390617+05:30 80001660-0006-fd00-b63f-84710c7967bb [INF] Request finished in 1.3327ms 204  (791a596a)
2021-09-18T08:21:09.1405141+05:30 800004a0-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:21:09.1407647+05:30 800004a0-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1465393+05:30 8000051c-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:21:09.1473809+05:30 8000051c-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1482245+05:30 8000051c-0004-fc00-b63f-84710c7967bb [INF] Request finished in 1.7401ms 204  (791a596a)
2021-09-18T08:21:09.1540687+05:30 800004a0-0004-ff00-b63f-84710c7967bb [INF] Request finished in 4.0588ms 204  (791a596a)
2021-09-18T08:21:09.1709562+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:21:09.1711299+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1711936+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:21:09.1713225+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1717357+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:21:09.1717333+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:21:09.1721737+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:21:09.1721729+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:21:09.1875715+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:21:09.1878509+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:21:09.1884237+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:21:09.1892065+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:21:09.1917325+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:21:09.1943972+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:21:09.1994806+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:21:09.2012193+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.769ms (afa2e885)
2021-09-18T08:21:09.2013835+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:21:09.2016506+05:30 80000791-0002-f100-b63f-84710c7967bb [INF] Request finished in 17.2377ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:21:09.2029620+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:21:09.2051628+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:21:09.2068837+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:21:09.2080075+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 35.6419ms (afa2e885)
2021-09-18T08:21:09.2081007+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:21:09.2084330+05:30 800003ba-0005-fd00-b63f-84710c7967bb [INF] Request finished in 37.543ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:21:09.2132501+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:21:09.2175048+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:21:09.2181051+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:21:09.2188628+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 46.539ms (afa2e885)
2021-09-18T08:21:09.2189231+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:21:09.2191409+05:30 8000028c-0005-fc00-b63f-84710c7967bb [INF] Request finished in 47.9744ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:28:57.2514207+05:30 80000793-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:28:57.2520728+05:30 80000793-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:28:57.2535894+05:30 80000793-0002-f100-b63f-84710c7967bb [INF] Request finished in 2.3226ms 204  (791a596a)
2021-09-18T08:28:57.2583081+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:28:57.2584866+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:28:57.2589002+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:28:57.2592813+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:28:57.2743396+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:28:57.2795090+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:28:57.2827279+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:28:57.2865676+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:28:57.2872903+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 27.8778ms (afa2e885)
2021-09-18T08:28:57.2873605+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:28:57.2946979+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:28:57.3001141+05:30 8000028e-0005-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513720643289741"", Request ID ""8000028e-0005-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:28:57.3002621+05:30 8000028e-0005-fc00-b63f-84710c7967bb [INF] Request finished in 41.9436ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:28:57.3051989+05:30 8000028e-0005-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:29:00.0339626+05:30 80000290-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:29:00.0340611+05:30 80000290-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0343024+05:30 80000795-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:29:00.0343889+05:30 80000795-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0344787+05:30 80000290-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.5913ms 204  (791a596a)
2021-09-18T08:29:00.0346503+05:30 80000795-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.3617ms 204  (791a596a)
2021-09-18T08:29:00.0354938+05:30 80000150-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:29:00.0355990+05:30 80000150-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0360320+05:30 80000150-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.6038ms 204  (791a596a)
2021-09-18T08:29:00.0405204+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:29:00.0406283+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0410321+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:29:00.0410761+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0411730+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:29:00.0413887+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:29:00.0414648+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:29:00.0415112+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:29:00.0415606+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.0416340+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:29:00.0417666+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:29:00.0419834+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:29:00.0458913+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:29:00.0467614+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:29:00.0472728+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:29:00.0483563+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.7754ms (afa2e885)
2021-09-18T08:29:00.0484234+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:29:00.0486077+05:30 80000502-0007-fe00-b63f-84710c7967bb [INF] Request finished in 8.1347ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:29:00.0494199+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:29:00.0500253+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:29:00.0556116+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:29:00.0558917+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:29:00.0570140+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:29:00.0578576+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 16.0954ms (afa2e885)
2021-09-18T08:29:00.0579083+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:29:00.0580995+05:30 80000449-0003-f900-b63f-84710c7967bb [INF] Request finished in 17.0836ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:29:00.0604262+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:29:00.0610628+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:29:00.0618516+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 19.697ms (afa2e885)
2021-09-18T08:29:00.0619161+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:29:00.0621315+05:30 80000292-0005-fc00-b63f-84710c7967bb [INF] Request finished in 20.6267ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:29:00.5597933+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:29:00.5599800+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:29:00.5602138+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:29:00.5605153+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:29:00.5746815+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:29:00.5790226+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:29:00.5815321+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:29:00.5923657+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:29:00.5932291+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 32.5865ms (afa2e885)
2021-09-18T08:29:00.5933040+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:29:00.5961738+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:29:00.5973463+05:30 8000063b-0000-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283323016742458"", Request ID ""8000063b-0000-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:29:00.5974482+05:30 8000063b-0000-f800-b63f-84710c7967bb [INF] Request finished in 37.6981ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:29:00.6081972+05:30 8000063b-0000-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:30:57.8660627+05:30 80000504-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:30:57.8661743+05:30 80000504-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8665808+05:30 80000504-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.5336ms 204  (791a596a)
2021-09-18T08:30:57.8675187+05:30 8000051e-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:30:57.8678633+05:30 8000051e-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8681616+05:30 8000051e-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.7153ms 204  (791a596a)
2021-09-18T08:30:57.8700689+05:30 80000506-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:30:57.8701785+05:30 80000506-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8704314+05:30 80000506-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.3965ms 204  (791a596a)
2021-09-18T08:30:57.8756462+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:30:57.8757928+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8764925+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:30:57.8769467+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:30:57.8784219+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:30:57.8786475+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8786495+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:30:57.8786858+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:57.8790709+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:30:57.8800873+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:30:57.8802393+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:30:57.8833772+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:30:57.8885366+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:30:57.8890225+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:30:57.8892163+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:30:57.8897634+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 12.5953ms (afa2e885)
2021-09-18T08:30:57.8898148+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:30:57.8900218+05:30 80000294-0005-fc00-b63f-84710c7967bb [INF] Request finished in 14.4233ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:30:57.8904365+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:30:57.8919470+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:30:57.8955023+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:30:57.8960531+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:30:57.8964649+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 12.9943ms (afa2e885)
2021-09-18T08:30:57.8965723+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:30:57.8967322+05:30 80000797-0002-f100-b63f-84710c7967bb [INF] Request finished in 18.3145ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:30:57.8975267+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:30:57.9017316+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:30:57.9019870+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:30:57.9023244+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.9752ms (afa2e885)
2021-09-18T08:30:57.9024149+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:30:57.9025824+05:30 8000044b-0003-f900-b63f-84710c7967bb [INF] Request finished in 24.0935ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:30:58.5183424+05:30 80000175-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:30:58.5184587+05:30 80000175-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:58.5188518+05:30 80000175-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.6313ms 204  (791a596a)
2021-09-18T08:30:58.5285065+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:30:58.5286221+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:30:58.5290061+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:30:58.5294703+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:30:58.5400585+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:30:58.5543035+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:30:58.5600484+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:30:58.5714711+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:30:58.5728445+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 43.0677ms (afa2e885)
2021-09-18T08:30:58.5729884+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:30:58.5811619+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("14"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:30:58.5857861+05:30 8000063d-0000-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283323016742460"", Request ID ""8000063d-0000-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:30:58.5863399+05:30 8000063d-0000-f800-b63f-84710c7967bb [INF] Request finished in 57.8029ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:30:58.6009110+05:30 8000063d-0000-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T08:31:19.2405129+05:30 8000063f-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:31:19.2409095+05:30 8000063f-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2412732+05:30 8000063f-0000-f800-b63f-84710c7967bb [INF] Request finished in 0.8146ms 204  (791a596a)
2021-09-18T08:31:19.2413022+05:30 80000079-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:31:19.2413784+05:30 80000079-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2416067+05:30 80000079-0000-f700-b63f-84710c7967bb [INF] Request finished in 0.3139ms 204  (791a596a)
2021-09-18T08:31:19.2433547+05:30 8000007b-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:31:19.2435088+05:30 8000007b-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2438058+05:30 8000007b-0000-f700-b63f-84710c7967bb [INF] Request finished in 0.5659ms 204  (791a596a)
2021-09-18T08:31:19.2498676+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:31:19.2499713+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2500145+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:31:19.2501015+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2504824+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:31:19.2505732+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.2506094+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:31:19.2506238+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:31:19.2509305+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:31:19.2512160+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:31:19.2513637+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:31:19.2514793+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:31:19.2548503+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:31:19.2553080+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:31:19.2558076+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:31:19.2564050+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:31:19.2566747+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:31:19.2573188+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:31:19.2575525+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:31:19.2585413+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.8385ms (afa2e885)
2021-09-18T08:31:19.2586195+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 7.233ms (afa2e885)
2021-09-18T08:31:19.2586319+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:31:19.2587092+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:31:19.2591385+05:30 80000520-0004-fc00-b63f-84710c7967bb [INF] Request finished in 8.9159ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:31:19.2588873+05:30 80000177-0006-fc00-b63f-84710c7967bb [INF] Request finished in 9.1135ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:31:19.2690962+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:31:19.2733334+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:31:19.2739146+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:31:19.2748710+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 23.3158ms (afa2e885)
2021-09-18T08:31:19.2749879+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:31:19.2752471+05:30 80000296-0005-fc00-b63f-84710c7967bb [INF] Request finished in 24.8168ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:31:19.7890422+05:30 80000799-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:31:19.7891683+05:30 80000799-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.7894884+05:30 80000799-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.4788ms 204  (791a596a)
2021-09-18T08:31:19.7978997+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:31:19.7980207+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:31:19.7984785+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:31:19.7990733+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:31:19.8067838+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:31:19.8182117+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:31:19.8227979+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:31:19.8341458+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:31:19.8343890+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:31:19.8354827+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 36.1383ms (afa2e885)
2021-09-18T08:31:19.8355936+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:31:19.8405952+05:30 80000508-0007-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:31:34.8593390+05:30 80000508-0007-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628917309080839"", Request ID ""80000508-0007-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
ClientConnectionId:e9a9ec65-1f4e-4d70-8142-99c0a4d8556f
Error Number:-2,State:0,Class:11
2021-09-18T08:31:34.8595178+05:30 80000508-0007-fe00-b63f-84710c7967bb [INF] Request finished in 15061.7378ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:33:58.8205871+05:30 800004a2-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:33:58.8205871+05:30 80000152-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:33:58.8206710+05:30 8000007d-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:33:58.8206907+05:30 800004a2-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8206929+05:30 80000152-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8207369+05:30 8000007d-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8209731+05:30 8000007d-0000-f700-b63f-84710c7967bb [INF] Request finished in 0.3535ms 204  (791a596a)
2021-09-18T08:33:58.8209704+05:30 80000152-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.3937ms 204  (791a596a)
2021-09-18T08:33:58.8209460+05:30 800004a2-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.4498ms 204  (791a596a)
2021-09-18T08:33:58.8293957+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:33:58.8295055+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8298123+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:33:58.8298867+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8302516+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:33:58.8303050+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:33:58.8305884+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:33:58.8305895+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:33:58.8310503+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:33:58.8311928+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:58.8331440+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:33:58.8382200+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:33:58.8407355+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:33:58.8425069+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:33:58.8434337+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:33:58.8458534+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:33:58.8470599+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"null"'. (8a1b66c8)
2021-09-18T08:33:58.8543331+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:33:58.8544651+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.0267ms (afa2e885)
2021-09-18T08:33:58.8544529+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:33:58.8545519+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:33:58.8552232+05:30 8000050a-0007-fe00-b63f-84710c7967bb [INF] Request finished in 24.1805ms 204  (791a596a)
2021-09-18T08:33:58.8553531+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:33:58.8562630+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 25.5683ms (afa2e885)
2021-09-18T08:33:58.8563515+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:33:58.8566059+05:30 80000298-0005-fc00-b63f-84710c7967bb [INF] Request finished in 27.2771ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:33:58.8615687+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:33:58.8619097+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:33:58.8626066+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 31.8994ms (afa2e885)
2021-09-18T08:33:58.8627008+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:33:58.8628184+05:30 80001663-0006-fd00-b63f-84710c7967bb [INF] Request finished in 33.0593ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:33:59.4580712+05:30 8000079b-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:33:59.4581836+05:30 8000079b-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:59.4584764+05:30 8000079b-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.4491ms 204  (791a596a)
2021-09-18T08:33:59.4675316+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:33:59.4676521+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:33:59.4678642+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:33:59.4682759+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:33:59.4771686+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:33:59.4885936+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:33:59.4943980+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:33:59.5056264+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:33:59.5068251+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 38.2535ms (afa2e885)
2021-09-18T08:33:59.5069864+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:33:59.5114112+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:33:59.5158003+05:30 8000007f-0000-f700-b63f-84710c7967bb [ERR] Connection ID ""17798225728978813054"", Request ID ""8000007f-0000-f700-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:33:59.5164604+05:30 8000007f-0000-f700-b63f-84710c7967bb [INF] Request finished in 48.798ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:33:59.5341679+05:30 8000007f-0000-f700-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T08:34:12.0865405+05:30 8000029a-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:34:12.0866433+05:30 8000029a-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.0870031+05:30 8000029a-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.5321ms 204  (791a596a)
2021-09-18T08:34:12.0916030+05:30 80000081-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:34:12.0915889+05:30 8000079d-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:34:12.0917141+05:30 8000079d-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.0917167+05:30 80000081-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.0919397+05:30 8000079d-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.4054ms 204  (791a596a)
2021-09-18T08:34:12.0919339+05:30 80000081-0000-f700-b63f-84710c7967bb [INF] Request finished in 0.3588ms 204  (791a596a)
2021-09-18T08:34:12.0959784+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:34:12.0961348+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.0964827+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:34:12.0967184+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:34:12.1007073+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:34:12.1008284+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:34:12.1008448+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.1009131+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.1010842+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:34:12.1010824+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:34:12.1012307+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:34:12.1012340+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:34:12.1042574+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T08:34:12.1055332+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:34:12.1064588+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:34:12.1070840+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:34:12.1079950+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 10.1598ms (afa2e885)
2021-09-18T08:34:12.1080826+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:34:12.1082759+05:30 800004a4-0004-ff00-b63f-84710c7967bb [INF] Request finished in 12.3362ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:34:12.1140226+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:34:12.1175871+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:34:12.1188072+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:34:12.1197333+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 18.3564ms (afa2e885)
2021-09-18T08:34:12.1198211+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:34:12.1200695+05:30 8000043e-0001-fa00-b63f-84710c7967bb [INF] Request finished in 19.4448ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:34:12.1243317+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:34:12.1289698+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:34:12.1297267+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:34:12.1309143+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 29.4758ms (afa2e885)
2021-09-18T08:34:12.1310025+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:34:12.1312981+05:30 80000154-0001-fd00-b63f-84710c7967bb [INF] Request finished in 30.5479ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:34:12.7744204+05:30 8000079f-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:34:12.7745485+05:30 8000079f-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.7748782+05:30 8000079f-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.5096ms 204  (791a596a)
2021-09-18T08:34:12.7847208+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:34:12.7848778+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:34:12.7850524+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:34:12.7852780+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:34:12.7956617+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:34:12.8065359+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:34:12.8154263+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:34:12.8252620+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:34:12.8260497+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 40.6157ms (afa2e885)
2021-09-18T08:34:12.8261721+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:34:12.8315613+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:34:12.8344900+05:30 8000029c-0005-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513720643289755"", Request ID ""8000029c-0005-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:34:12.8347330+05:30 8000029c-0005-fc00-b63f-84710c7967bb [INF] Request finished in 50.0364ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:34:12.8429402+05:30 8000029c-0005-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T08:35:07.7260386+05:30 8000029e-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:35:07.7263327+05:30 80001665-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:35:07.7264030+05:30 80001665-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7266136+05:30 80001665-0006-fd00-b63f-84710c7967bb [INF] Request finished in 0.2868ms 204  (791a596a)
2021-09-18T08:35:07.7270231+05:30 8000029e-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7282813+05:30 8000029e-0005-fc00-b63f-84710c7967bb [INF] Request finished in 1.2362ms 204  (791a596a)
2021-09-18T08:35:07.7315142+05:30 80001667-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T08:35:07.7318835+05:30 80001667-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7328676+05:30 80001667-0006-fd00-b63f-84710c7967bb [INF] Request finished in 1.4518ms 204  (791a596a)
2021-09-18T08:35:07.7398029+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T08:35:07.7401419+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7404597+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T08:35:07.7406097+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:35:07.7449197+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T08:35:07.7450093+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7454194+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T08:35:07.7455639+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:35:07.7459275+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:35:07.7575713+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:35:07.7595084+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T08:35:07.7598023+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T08:35:07.7689203+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T08:35:07.7731222+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 27.4336ms (afa2e885)
2021-09-18T08:35:07.7731222+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 32.4338ms (afa2e885)
2021-09-18T08:35:07.7731846+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:35:07.7731852+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:35:07.7732905+05:30 800007a1-0002-f100-b63f-84710c7967bb [INF] Request finished in 33.6986ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:35:07.7732896+05:30 8000044d-0003-f900-b63f-84710c7967bb [INF] Request finished in 28.4481ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:35:07.7739011+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T08:35:07.7739850+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:07.7740845+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T08:35:07.7742351+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:35:07.7793065+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:35:07.7857823+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:35:07.7908955+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T08:35:07.7912554+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T08:35:07.7917571+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.454ms (afa2e885)
2021-09-18T08:35:07.7918247+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:35:07.7919506+05:30 800004a6-0004-ff00-b63f-84710c7967bb [INF] Request finished in 18.3972ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T08:35:08.3596456+05:30 8000050c-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T08:35:08.3598433+05:30 8000050c-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:08.3602755+05:30 8000050c-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.8009ms 204  (791a596a)
2021-09-18T08:35:08.3714473+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T08:35:08.3715887+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T08:35:08.3717207+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T08:35:08.3718901+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T08:35:08.3783666+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T08:35:08.3866031+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T08:35:08.3913874+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T08:35:08.4023144+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T08:35:08.4031647+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 31.0898ms (afa2e885)
2021-09-18T08:35:08.4032963+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T08:35:08.4033358+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T08:35:08.4128620+05:30 800004a8-0004-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686498462106791"", Request ID ""800004a8-0004-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T08:35:08.4131124+05:30 800004a8-0004-ff00-b63f-84710c7967bb [INF] Request finished in 41.6693ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T08:35:08.4175639+05:30 800004a8-0004-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:37:02.8775699+05:30 800004aa-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:37:02.8775574+05:30 80000145-0004-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:37:02.8776752+05:30 800004aa-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.8776793+05:30 80000145-0004-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.8778859+05:30 80000145-0004-fd00-b63f-84710c7967bb [INF] Request finished in 0.5205ms 204  (791a596a)
2021-09-18T10:37:02.8778861+05:30 800004aa-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.352ms 204  (791a596a)
2021-09-18T10:37:02.8796962+05:30 80003348-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:37:02.8800628+05:30 80003348-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.8805155+05:30 80003348-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.7197ms 204  (791a596a)
2021-09-18T10:37:02.8880208+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:37:02.8880208+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:37:02.8890307+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.8890309+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.8891887+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:37:02.8893399+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:37:02.8893584+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:37:02.8894386+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:37:02.9083942+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:37:02.9084516+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:02.9086823+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:37:02.9089831+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:37:02.9090778+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:37:02.9104185+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:37:02.9468430+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("18"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:37:02.9518356+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:37:02.9639488+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:37:03.0280726+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("13"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:37:03.0292722+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:37:03.0307227+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 121.5483ms (afa2e885)
2021-09-18T10:37:03.0307935+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:37:03.0309292+05:30 80001669-0006-fd00-b63f-84710c7967bb [INF] Request finished in 122.6238ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:37:03.0414383+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:37:03.0418428+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:37:03.0439706+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 154.4941ms (afa2e885)
2021-09-18T10:37:03.0440634+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:37:03.0444600+05:30 8000001e-0006-fe00-b63f-84710c7967bb [INF] Request finished in 157.799ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:37:03.1000924+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:37:03.1005463+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:37:03.1047279+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 212.1748ms (afa2e885)
2021-09-18T10:37:03.1048095+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:37:03.1049988+05:30 80000179-0006-fc00-b63f-84710c7967bb [INF] Request finished in 218.402ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:37:03.4597010+05:30 8000334a-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:37:03.4597867+05:30 8000334a-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:03.4599673+05:30 8000334a-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.33ms 204  (791a596a)
2021-09-18T10:37:03.4637895+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:37:03.4638919+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:37:03.4639966+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:37:03.4641290+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:37:03.4678969+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:37:03.4729101+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:37:03.4772576+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:37:03.4807973+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:37:03.4810393+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.8628ms (afa2e885)
2021-09-18T10:37:03.4810782+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:37:03.4837242+05:30 80000037-0003-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628900129210422"", Request ID ""80000037-0003-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:37:03.4838227+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Request finished in 20.0771ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:37:03.4864449+05:30 80000037-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:37:03.4924512+05:30 80000037-0003-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:39:07.4524439+05:30 8000015b-0007-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:39:07.4526441+05:30 8000015b-0007-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4528131+05:30 8000015b-0007-fd00-b63f-84710c7967bb [INF] Request finished in 0.4366ms 204  (791a596a)
2021-09-18T10:39:07.4534641+05:30 800002a2-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:39:07.4536285+05:30 800002a2-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4538202+05:30 800002a2-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.3709ms 204  (791a596a)
2021-09-18T10:39:07.4539544+05:30 800002b2-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:39:07.4540083+05:30 800002b2-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4541356+05:30 800002b2-0007-ff00-b63f-84710c7967bb [INF] Request finished in 0.1929ms 204  (791a596a)
2021-09-18T10:39:07.4598461+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:39:07.4600061+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4609180+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:39:07.4610596+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:39:07.4659158+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:39:07.4679317+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4679662+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:39:07.4680342+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:07.4681895+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:39:07.4682195+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:39:07.4683314+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:39:07.4683451+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:39:07.4816524+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:39:07.4816515+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:39:07.4823678+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:39:07.4895917+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:39:07.4904595+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:39:07.4905223+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:39:07.4912402+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 22.8228ms (afa2e885)
2021-09-18T10:39:07.4913377+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:39:07.4915177+05:30 80000440-0001-fa00-b63f-84710c7967bb [INF] Request finished in 24.3023ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:39:07.4967770+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:39:07.4970362+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:39:07.4974792+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 36.3465ms (afa2e885)
2021-09-18T10:39:07.4975254+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:39:07.4976002+05:30 80000158-0001-fd00-b63f-84710c7967bb [INF] Request finished in 37.8046ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:39:07.5038988+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:39:07.5042858+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:39:07.5047793+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 36.3464ms (afa2e885)
2021-09-18T10:39:07.5048740+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:39:07.5050053+05:30 800002b4-0007-ff00-b63f-84710c7967bb [INF] Request finished in 39.1238ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:39:08.1318420+05:30 8000015a-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:39:08.1320037+05:30 8000015a-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:08.1323572+05:30 8000015a-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.6381ms 204  (791a596a)
2021-09-18T10:39:08.1426455+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:39:08.1427787+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:39:08.1429490+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:39:08.1431537+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:39:08.1533577+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:39:08.1668523+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:39:08.1725398+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:39:08.1836476+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:39:08.1844185+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 41.1142ms (afa2e885)
2021-09-18T10:39:08.1845631+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:39:08.1898430+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:39:08.1932539+05:30 800004ac-0004-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686498462106795"", Request ID ""800004ac-0004-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:39:08.1936688+05:30 800004ac-0004-ff00-b63f-84710c7967bb [INF] Request finished in 50.8838ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:39:08.2011298+05:30 800004ac-0004-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:47:37.2946329+05:30 8000017b-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:47:37.2949101+05:30 8000017b-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3010416+05:30 8000017b-0006-fc00-b63f-84710c7967bb [INF] Request finished in 9.0124ms 204  (791a596a)
2021-09-18T10:47:37.3037582+05:30 80000134-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:47:37.3038993+05:30 80000134-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3043237+05:30 80000134-0002-ed00-b63f-84710c7967bb [INF] Request finished in 2.7061ms 204  (791a596a)
2021-09-18T10:47:37.3192402+05:30 800007a5-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:47:37.3194779+05:30 800007a5-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3221245+05:30 800007a5-0002-f100-b63f-84710c7967bb [INF] Request finished in 2.9075ms 204  (791a596a)
2021-09-18T10:47:37.3221372+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:47:37.3221232+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:47:37.3222184+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3222174+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3224542+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:37.3226562+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:37.3227549+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:37.3228435+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:37.3381743+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:47:37.3384148+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.3400404+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:37.3402569+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:37.3467692+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:47:37.3574181+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:37.3578545+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:47:37.3584464+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 35.4768ms (afa2e885)
2021-09-18T10:47:37.3585323+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:37.3585099+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:37.3586498+05:30 80000089-0000-f700-b63f-84710c7967bb [INF] Request finished in 36.5627ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:37.3672455+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:47:37.3696434+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:47:37.3706089+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:47:37.3713335+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 30.9644ms (afa2e885)
2021-09-18T10:47:37.3714441+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:37.3716181+05:30 8000334e-0004-fb00-b63f-84710c7967bb [INF] Request finished in 33.5103ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:37.3782093+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:47:37.3841502+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:47:37.3845609+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:47:37.3850717+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 62.2307ms (afa2e885)
2021-09-18T10:47:37.3851331+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:37.3852393+05:30 80000641-0000-f800-b63f-84710c7967bb [INF] Request finished in 65.3833ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:37.9806555+05:30 80003350-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:47:37.9808040+05:30 80003350-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.9811485+05:30 80003350-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.5983ms 204  (791a596a)
2021-09-18T10:47:37.9912772+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:47:37.9914296+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:37.9916508+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:37.9919171+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:38.0019980+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:47:38.0155542+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:47:38.0247530+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:38.0390047+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:47:38.0401464+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 48.0426ms (afa2e885)
2021-09-18T10:47:38.0403297+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:38.0490502+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("14"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:47:38.0531158+05:30 8000017d-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256764"", Request ID ""8000017d-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:47:38.0533721+05:30 8000017d-0006-fc00-b63f-84710c7967bb [INF] Request finished in 62.1467ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:38.0790999+05:30 8000017d-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:47:44.6011560+05:30 800007a7-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:47:44.6012855+05:30 800007a7-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6016719+05:30 800007a7-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.4333ms 204  (791a596a)
2021-09-18T10:47:44.6019143+05:30 80000453-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:47:44.6020448+05:30 80000453-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6022505+05:30 80000453-0003-f900-b63f-84710c7967bb [INF] Request finished in 0.3799ms 204  (791a596a)
2021-09-18T10:47:44.6022438+05:30 80000039-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:47:44.6023194+05:30 80000039-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6025116+05:30 80000039-0003-fe00-b63f-84710c7967bb [INF] Request finished in 0.2741ms 204  (791a596a)
2021-09-18T10:47:44.6125619+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:47:44.6126597+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6127890+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:44.6129369+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:44.6136747+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:47:44.6137711+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6138178+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:47:44.6138828+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:44.6139829+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:44.6140667+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:44.6141127+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:44.6141892+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:44.6148665+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:47:44.6152705+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:44.6155079+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:47:44.6155528+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:47:44.6159856+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 1.7438ms (afa2e885)
2021-09-18T10:47:44.6160537+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:44.6161715+05:30 800002a4-0005-fc00-b63f-84710c7967bb [INF] Request finished in 2.4981ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:44.6168448+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:47:44.6170523+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:44.6187156+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:47:44.6193691+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:47:44.6200481+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 5.7689ms (afa2e885)
2021-09-18T10:47:44.6201238+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:44.6202538+05:30 8000015c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 6.4578ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:44.6213108+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:47:44.6216355+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:47:44.6223212+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 9.2699ms (afa2e885)
2021-09-18T10:47:44.6224046+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:44.6225202+05:30 800007a9-0002-f100-b63f-84710c7967bb [INF] Request finished in 10.0444ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:45.2474296+05:30 80000643-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:47:45.2475512+05:30 80000643-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:45.2478406+05:30 80000643-0000-f800-b63f-84710c7967bb [INF] Request finished in 0.5367ms 204  (791a596a)
2021-09-18T10:47:45.2566944+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:47:45.2568465+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:47:45.2570314+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:47:45.2572559+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:47:45.2629623+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:47:45.2713853+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:47:45.2743662+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:47:45.2833242+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:47:45.2834142+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:47:45.2842145+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 26.8225ms (afa2e885)
2021-09-18T10:47:45.2843394+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:47:45.2928209+05:30 800007ab-0002-f100-b63f-84710c7967bb [ERR] Connection ID ""17365880173341181866"", Request ID ""800007ab-0002-f100-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:47:45.2930390+05:30 800007ab-0002-f100-b63f-84710c7967bb [INF] Request finished in 36.4101ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:47:45.2950931+05:30 800007ab-0002-f100-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:49:33.2401713+05:30 80000512-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:49:33.2407154+05:30 80000512-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2411265+05:30 80000512-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.971ms 204  (791a596a)
2021-09-18T10:49:33.2419624+05:30 8000017f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:49:33.2420563+05:30 8000017f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2422903+05:30 8000017f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.344ms 204  (791a596a)
2021-09-18T10:49:33.2479290+05:30 8000003b-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:49:33.2480648+05:30 8000003b-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2486398+05:30 8000003b-0003-fe00-b63f-84710c7967bb [INF] Request finished in 0.7414ms 204  (791a596a)
2021-09-18T10:49:33.2530929+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:49:33.2531797+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2540809+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:49:33.2541626+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2542426+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:49:33.2544460+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:49:33.2545785+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:49:33.2551392+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:49:33.2601322+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:49:33.2601325+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:49:33.2650909+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:49:33.2723801+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:49:33.2723917+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 17.8583ms (afa2e885)
2021-09-18T10:49:33.2724642+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:49:33.2725662+05:30 80003352-0004-fb00-b63f-84710c7967bb [INF] Request finished in 19.5104ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:49:33.2729582+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:49:33.2772843+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 21.8879ms (afa2e885)
2021-09-18T10:49:33.2773658+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:49:33.2773644+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:49:33.2774505+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.2774814+05:30 800004ae-0004-ff00-b63f-84710c7967bb [INF] Request finished in 23.4214ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:49:33.2776676+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:49:33.2780246+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:49:33.2885962+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:49:33.2955382+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:49:33.3002774+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:49:33.3005417+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:49:33.3010333+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 22.9003ms (afa2e885)
2021-09-18T10:49:33.3011226+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:49:33.3012637+05:30 80000645-0000-f800-b63f-84710c7967bb [INF] Request finished in 24.0166ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:49:33.9050050+05:30 8000003d-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:49:33.9052153+05:30 8000003d-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.9056146+05:30 8000003d-0003-fe00-b63f-84710c7967bb [INF] Request finished in 0.726ms 204  (791a596a)
2021-09-18T10:49:33.9177949+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:49:33.9179865+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:49:33.9182239+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:49:33.9184723+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:49:33.9277837+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:49:33.9391066+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:49:33.9455137+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:49:33.9550992+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:49:33.9558939+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 37.2539ms (afa2e885)
2021-09-18T10:49:33.9560557+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:49:33.9611215+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:49:33.9640112+05:30 800007ad-0002-f100-b63f-84710c7967bb [ERR] Connection ID ""17365880173341181868"", Request ID ""800007ad-0002-f100-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:49:33.9646611+05:30 800007ad-0002-f100-b63f-84710c7967bb [INF] Request finished in 46.7218ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:49:33.9708284+05:30 800007ad-0002-f100-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:50:00.0536527+05:30 800002a6-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:50:00.0537109+05:30 800002a6-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0538454+05:30 800002a6-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.2187ms 204  (791a596a)
2021-09-18T10:50:00.0573524+05:30 800004b0-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:50:00.0574445+05:30 800004b0-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0576130+05:30 800004b0-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.2916ms 204  (791a596a)
2021-09-18T10:50:00.0582417+05:30 80000442-0001-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:50:00.0583129+05:30 80000442-0001-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0584801+05:30 80000442-0001-fa00-b63f-84710c7967bb [INF] Request finished in 0.2626ms 204  (791a596a)
2021-09-18T10:50:00.0591945+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:50:00.0592688+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0594467+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:00.0595656+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:00.0632931+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:00.0635419+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:50:00.0636235+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:50:00.0636261+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:50:00.0636701+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0636691+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.0638359+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:00.0638362+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:00.0638574+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.2482ms (afa2e885)
2021-09-18T10:50:00.0638886+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:00.0639072+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:00.0639077+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:00.0639438+05:30 800004b2-0004-ff00-b63f-84710c7967bb [INF] Request finished in 4.7826ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:00.0651468+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:50:00.0652098+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:00.0663991+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:50:00.0664381+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:50:00.0669162+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:50:00.0672881+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 3.3245ms (afa2e885)
2021-09-18T10:50:00.0673261+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:00.0674068+05:30 800007af-0002-f100-b63f-84710c7967bb [INF] Request finished in 3.7894ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:00.0696210+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:50:00.0720591+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:50:00.0723383+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:50:00.0729531+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 8.9721ms (afa2e885)
2021-09-18T10:50:00.0730034+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:00.0731600+05:30 80000136-0002-ed00-b63f-84710c7967bb [INF] Request finished in 9.5359ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:00.7100362+05:30 80000647-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:50:00.7100814+05:30 80000647-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.7101851+05:30 80000647-0000-f800-b63f-84710c7967bb [INF] Request finished in 0.1679ms 204  (791a596a)
2021-09-18T10:50:00.7133774+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:50:00.7134197+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:00.7134686+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:00.7135238+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:00.7149176+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:50:00.7173322+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:50:00.7194993+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:00.7222428+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:50:00.7222782+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:50:00.7224299+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 8.8704ms (afa2e885)
2021-09-18T10:50:00.7224664+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:00.7246442+05:30 800002a8-0005-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513720643289767"", Request ID ""800002a8-0005-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:50:00.7247077+05:30 800002a8-0005-fc00-b63f-84710c7967bb [INF] Request finished in 11.3517ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:00.7253481+05:30 800002a8-0005-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:50:42.1804108+05:30 800004b4-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:50:42.1805509+05:30 800004b4-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1807713+05:30 800004b4-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.4062ms 204  (791a596a)
2021-09-18T10:50:42.1840677+05:30 8000003f-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:50:42.1841386+05:30 8000003f-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1842986+05:30 8000003f-0003-fe00-b63f-84710c7967bb [INF] Request finished in 0.2683ms 204  (791a596a)
2021-09-18T10:50:42.1852472+05:30 800004b6-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:50:42.1853214+05:30 800004b6-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1858424+05:30 800004b6-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.5993ms 204  (791a596a)
2021-09-18T10:50:42.1903318+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:50:42.1904099+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1905250+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:42.1906842+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:42.1920526+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:50:42.1921183+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1921203+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:50:42.1921483+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:42.1921935+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:42.1922023+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:42.1922706+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:42.1922698+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:42.1935716+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:50:42.1935882+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:50:42.1945528+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:42.1946987+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:42.1948173+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:50:42.1956740+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.9051ms (afa2e885)
2021-09-18T10:50:42.1960249+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:42.1961432+05:30 80000649-0000-f800-b63f-84710c7967bb [INF] Request finished in 5.8204ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:42.2018605+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:50:42.2026690+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:50:42.2072218+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 14.8103ms (afa2e885)
2021-09-18T10:50:42.2082499+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:42.2083789+05:30 80000455-0003-f900-b63f-84710c7967bb [INF] Request finished in 16.3258ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:42.2126748+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:50:42.2238363+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:50:42.2278022+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:50:42.2280157+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:50:42.2283703+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 36.0452ms (afa2e885)
2021-09-18T10:50:42.2284228+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:42.2285299+05:30 80000041-0003-fe00-b63f-84710c7967bb [INF] Request finished in 36.4946ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:43.1107540+05:30 80000138-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:50:43.1114169+05:30 80000138-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:43.1131639+05:30 80000138-0002-ed00-b63f-84710c7967bb [INF] Request finished in 2.5214ms 204  (791a596a)
2021-09-18T10:50:43.1223395+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:50:43.1225112+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:50:43.1227240+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:50:43.1229421+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:50:43.1304778+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:50:43.1408119+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:50:43.1469089+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:50:43.1574590+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:50:43.1581511+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 35.0607ms (afa2e885)
2021-09-18T10:50:43.1582879+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:50:43.1629491+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:50:43.1664558+05:30 80000043-0003-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628900129210434"", Request ID ""80000043-0003-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:50:43.1669292+05:30 80000043-0003-fe00-b63f-84710c7967bb [INF] Request finished in 44.6255ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:50:43.1728566+05:30 80000043-0003-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T10:51:18.8672217+05:30 800004b8-0004-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:51:18.8674362+05:30 800004b8-0004-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8677063+05:30 800004b8-0004-ff00-b63f-84710c7967bb [INF] Request finished in 0.5664ms 204  (791a596a)
2021-09-18T10:51:18.8688906+05:30 80000181-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:51:18.8689999+05:30 80000181-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8693154+05:30 80000181-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.4898ms 204  (791a596a)
2021-09-18T10:51:18.8705454+05:30 800002aa-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:51:18.8706333+05:30 800002aa-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8710104+05:30 800002aa-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.4661ms 204  (791a596a)
2021-09-18T10:51:18.8757903+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:51:18.8758778+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8760098+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:18.8761630+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:18.8771897+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:51:18.8772803+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8773895+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:18.8775629+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:18.8778236+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:18.8780738+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:51:18.8786029+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.2851ms (afa2e885)
2021-09-18T10:51:18.8785837+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:51:18.8786936+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:18.8787327+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:18.8788062+05:30 80000183-0006-fc00-b63f-84710c7967bb [INF] Request finished in 3.0348ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:18.8793722+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:51:18.8793769+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:18.8795237+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:18.8813913+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:18.8814569+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:51:18.8828641+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:51:18.8833619+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:51:18.8838826+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 4.2292ms (afa2e885)
2021-09-18T10:51:18.8839701+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:18.8840683+05:30 80000160-0001-fd00-b63f-84710c7967bb [INF] Request finished in 5.5005ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:18.8846927+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:51:18.8850256+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:51:18.8854501+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 7.7244ms (afa2e885)
2021-09-18T10:51:18.8855212+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:18.8856198+05:30 80000514-0007-fe00-b63f-84710c7967bb [INF] Request finished in 8.3812ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:19.5019382+05:30 80000516-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:51:19.5021948+05:30 80000516-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:19.5029284+05:30 80000516-0007-fe00-b63f-84710c7967bb [INF] Request finished in 1.0334ms 204  (791a596a)
2021-09-18T10:51:19.5127402+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:51:19.5129261+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:19.5131620+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:19.5134355+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:19.5186054+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:51:19.5285773+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:51:19.5322402+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:19.5546898+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:51:19.5555103+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 41.4839ms (afa2e885)
2021-09-18T10:51:19.5556522+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:19.5558221+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("17"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:51:19.5660457+05:30 8000064b-0000-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283323016742474"", Request ID ""8000064b-0000-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:51:19.5663339+05:30 8000064b-0000-f800-b63f-84710c7967bb [INF] Request finished in 53.0837ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:19.5718865+05:30 8000064b-0000-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:51:36.1766465+05:30 80000185-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:51:36.1769098+05:30 80000185-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1773174+05:30 80000185-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.727ms 204  (791a596a)
2021-09-18T10:51:36.1775696+05:30 80003354-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:51:36.1777529+05:30 80003354-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1790337+05:30 80003354-0004-fb00-b63f-84710c7967bb [INF] Request finished in 1.4212ms 204  (791a596a)
2021-09-18T10:51:36.1836594+05:30 80000518-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:51:36.1838768+05:30 80000518-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1848786+05:30 80000518-0007-fe00-b63f-84710c7967bb [INF] Request finished in 1.3601ms 204  (791a596a)
2021-09-18T10:51:36.1891819+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:51:36.1892931+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1896166+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:36.1898742+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:36.1916507+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:51:36.1919650+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1921337+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:36.1922959+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:36.1927994+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:51:36.1928813+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.1929921+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:36.1931719+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:36.1935919+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:51:36.1944032+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:51:36.2003341+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:51:36.2010336+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:36.2024745+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:36.2032145+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:51:36.2042482+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 14.2499ms (afa2e885)
2021-09-18T10:51:36.2043055+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:36.2044573+05:30 80003356-0004-fb00-b63f-84710c7967bb [INF] Request finished in 15.2698ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:36.2091266+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:51:36.2092360+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:51:36.2095376+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:51:36.2099157+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 17.484ms (afa2e885)
2021-09-18T10:51:36.2099810+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:36.2100759+05:30 8000013a-0002-ed00-b63f-84710c7967bb [INF] Request finished in 18.6371ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:36.2129596+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:51:36.2132389+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:51:36.2135900+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 20.2645ms (afa2e885)
2021-09-18T10:51:36.2136452+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:36.2137419+05:30 800007b1-0002-f100-b63f-84710c7967bb [INF] Request finished in 20.9179ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:36.7911043+05:30 800002ac-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:51:36.7911677+05:30 800002ac-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.7913108+05:30 800002ac-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.2376ms 204  (791a596a)
2021-09-18T10:51:36.8064607+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:51:36.8066725+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:51:36.8070438+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:51:36.8078424+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:51:36.8138835+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:51:36.8201732+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:51:36.8239381+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:51:36.8279427+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:51:36.8283165+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.3401ms (afa2e885)
2021-09-18T10:51:36.8283806+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:51:36.8322813+05:30 8000051a-0007-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628917309080857"", Request ID ""8000051a-0007-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:51:36.8323690+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Request finished in 25.8547ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:51:36.8335954+05:30 8000051a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:51:36.8388050+05:30 8000051a-0007-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T10:52:17.9866102+05:30 800007b3-0002-f100-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:52:17.9867305+05:30 800007b3-0002-f100-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:17.9869500+05:30 800007b3-0002-f100-b63f-84710c7967bb [INF] Request finished in 0.4562ms 204  (791a596a)
2021-09-18T10:52:17.9881387+05:30 8000013c-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:52:17.9882175+05:30 8000013c-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:17.9887364+05:30 8000013c-0002-ed00-b63f-84710c7967bb [INF] Request finished in 0.6089ms 204  (791a596a)
2021-09-18T10:52:17.9889106+05:30 80002212-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:52:17.9890169+05:30 80002212-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:17.9892046+05:30 80002212-0002-f600-b63f-84710c7967bb [INF] Request finished in 0.3056ms 204  (791a596a)
2021-09-18T10:52:18.0026757+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:52:18.0029244+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:18.0031435+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:52:18.0032211+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:52:18.0033483+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:52:18.0034162+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:18.0037504+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:52:18.0041314+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:52:18.0055004+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:52:18.0056183+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:18.0057313+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:52:18.0057200+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:52:18.0058608+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:52:18.0066689+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:52:18.0068779+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:52:18.0074189+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.7596ms (afa2e885)
2021-09-18T10:52:18.0074729+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:52:18.0075167+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:52:18.0075583+05:30 80000162-0001-fd00-b63f-84710c7967bb [INF] Request finished in 5.2333ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:52:18.0080922+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:52:18.0115305+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:52:18.0263270+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 22.0555ms (afa2e885)
2021-09-18T10:52:18.0264071+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:52:18.0264965+05:30 80002214-0002-f600-b63f-84710c7967bb [INF] Request finished in 23.4002ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:52:18.0273109+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:52:18.0300362+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:52:18.0336765+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:52:18.0339233+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:52:18.0343387+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 28.3943ms (afa2e885)
2021-09-18T10:52:18.0344287+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:52:18.0346475+05:30 8000013e-0002-ed00-b63f-84710c7967bb [INF] Request finished in 29.8173ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:52:21.6142331+05:30 800002ae-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:52:21.6144378+05:30 800002ae-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:21.6181839+05:30 800002ae-0005-fc00-b63f-84710c7967bb [INF] Request finished in 3.7922ms 204  (791a596a)
2021-09-18T10:52:21.6367765+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:52:21.6368951+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:52:21.6370411+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:52:21.6372435+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:52:21.6406624+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:52:21.6492471+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:52:21.6526851+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:52:21.6601562+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:52:21.6602730+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:52:21.6676059+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 30.193ms (afa2e885)
2021-09-18T10:52:21.6676804+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:52:21.6735340+05:30 80000045-0003-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-18T10:52:36.6900787+05:30 80000045-0003-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628900129210436"", Request ID ""80000045-0003-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
ClientConnectionId:1c5b1cea-4145-48fa-9750-a42f3e7bf8fe
Error Number:-2,State:0,Class:11
2021-09-18T10:52:36.6904812+05:30 80000045-0003-fe00-b63f-84710c7967bb [INF] Request finished in 15051.9398ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:55:51.6881243+05:30 8000008b-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:55:51.6890019+05:30 80000287-0000-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:55:51.6891742+05:30 8000008b-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.6894733+05:30 80000287-0000-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.6898790+05:30 8000008b-0000-f700-b63f-84710c7967bb [INF] Request finished in 2.03ms 204  (791a596a)
2021-09-18T10:55:51.6913682+05:30 80000287-0000-fc00-b63f-84710c7967bb [INF] Request finished in 2.4926ms 204  (791a596a)
2021-09-18T10:55:51.6939015+05:30 80001df7-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:55:51.6942423+05:30 80001df7-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.6963431+05:30 80001df7-0000-fb00-b63f-84710c7967bb [INF] Request finished in 2.5726ms 204  (791a596a)
2021-09-18T10:55:51.7029097+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:55:51.7043998+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.7046930+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:55:51.7049470+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:55:51.7098553+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:55:51.7098616+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:55:51.7100817+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.7099414+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:51.7114384+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:55:51.7116711+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:55:51.7116701+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:55:51.7120132+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:55:51.7219634+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:55:51.7235882+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:55:51.7282994+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:55:51.7284257+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 23.385ms (afa2e885)
2021-09-18T10:55:51.7285056+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:55:51.7286333+05:30 80000140-0002-ed00-b63f-84710c7967bb [INF] Request finished in 25.9738ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:55:51.7286416+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:55:51.7300612+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:55:51.7379154+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:55:51.7397819+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:55:51.7402333+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:55:51.7407641+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 28.6466ms (afa2e885)
2021-09-18T10:55:51.7408429+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:55:51.7409809+05:30 80000047-0003-fe00-b63f-84710c7967bb [INF] Request finished in 31.1701ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:55:51.7426859+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:55:51.7430012+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:55:51.7435239+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 31.711ms (afa2e885)
2021-09-18T10:55:51.7436205+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:55:51.7437293+05:30 8000052e-0004-fc00-b63f-84710c7967bb [INF] Request finished in 33.9014ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:55:52.3331253+05:30 80000189-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:55:52.3332523+05:30 80000189-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:52.3335823+05:30 80000189-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.5374ms 204  (791a596a)
2021-09-18T10:55:52.3425092+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:55:52.3426783+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:55:52.3428805+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:55:52.3431772+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:55:52.3509271+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:55:52.3623225+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:55:52.3685485+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:55:52.3777946+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:55:52.3784266+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 35.1045ms (afa2e885)
2021-09-18T10:55:52.3785277+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:55:52.3827635+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:55:52.3870828+05:30 80000530-0004-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513716348323119"", Request ID ""80000530-0004-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:55:52.3874859+05:30 80000530-0004-fc00-b63f-84710c7967bb [INF] Request finished in 45.0081ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:55:52.3924635+05:30 80000530-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:56:47.5398811+05:30 80000022-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:56:47.5402342+05:30 80000022-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5405164+05:30 80000022-0006-fe00-b63f-84710c7967bb [INF] Request finished in 0.7219ms 204  (791a596a)
2021-09-18T10:56:47.5409712+05:30 8000018b-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:56:47.5410884+05:30 8000018b-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5413133+05:30 8000018b-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.4298ms 204  (791a596a)
2021-09-18T10:56:47.5416111+05:30 800002b0-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:56:47.5417493+05:30 800002b0-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5419869+05:30 800002b0-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.4205ms 204  (791a596a)
2021-09-18T10:56:47.5511333+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:56:47.5512459+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5513463+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:56:47.5513862+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:56:47.5514367+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5515346+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:56:47.5515746+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:56:47.5519271+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:56:47.5519884+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:47.5519749+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:56:47.5520893+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:56:47.5522119+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:56:47.5531610+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:56:47.5563406+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:56:47.5564302+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:56:47.5566556+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:56:47.5572287+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.5618ms (afa2e885)
2021-09-18T10:56:47.5573217+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:56:47.5574284+05:30 8000018d-0006-fc00-b63f-84710c7967bb [INF] Request finished in 6.3661ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:56:47.5658219+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:56:47.5683324+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:56:47.5708757+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:56:47.5712266+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:56:47.5717261+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 19.6391ms (afa2e885)
2021-09-18T10:56:47.5718326+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:56:47.5719523+05:30 80000024-0006-fe00-b63f-84710c7967bb [INF] Request finished in 20.6572ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:56:47.5751819+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:56:47.5756522+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:56:47.5762668+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 23.9669ms (afa2e885)
2021-09-18T10:56:47.5763669+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:56:47.5765047+05:30 80000142-0002-ed00-b63f-84710c7967bb [INF] Request finished in 24.8213ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:56:48.1457268+05:30 80000532-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:56:48.1458631+05:30 80000532-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:48.1463952+05:30 80000532-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.6362ms 204  (791a596a)
2021-09-18T10:56:48.1557258+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:56:48.1558790+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:56:48.1560556+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:56:48.1562898+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:56:48.1643490+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:56:48.1751052+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:56:48.1814787+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:56:48.1905873+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:56:48.1913100+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 34.8578ms (afa2e885)
2021-09-18T10:56:48.1914454+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:56:48.1963921+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:56:48.1987456+05:30 80000026-0006-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628913014112293"", Request ID ""80000026-0006-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:56:48.1989657+05:30 80000026-0006-fe00-b63f-84710c7967bb [INF] Request finished in 43.2855ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:56:48.2056726+05:30 80000026-0006-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T10:58:28.9722961+05:30 80000166-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:58:28.9724052+05:30 80000166-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9726715+05:30 80000166-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.4062ms 204  (791a596a)
2021-09-18T10:58:28.9735914+05:30 800002b2-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:58:28.9736959+05:30 800002b2-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9741933+05:30 800002b2-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.5481ms 204  (791a596a)
2021-09-18T10:58:28.9753954+05:30 8000051c-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T10:58:28.9756131+05:30 8000051c-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9760362+05:30 8000051c-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.8689ms 204  (791a596a)
2021-09-18T10:58:28.9896827+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T10:58:28.9897252+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T10:58:28.9900319+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9902083+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9926342+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T10:58:28.9929485+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T10:58:28.9929927+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T10:58:28.9930228+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:28.9930250+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:58:28.9931885+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T10:58:28.9931917+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:58:28.9933138+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:58:29.0033815+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T10:58:29.0116201+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:58:29.0116836+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:58:29.0119089+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T10:58:29.0201194+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 26.7921ms (afa2e885)
2021-09-18T10:58:29.0202380+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:58:29.0204336+05:30 80000028-0006-fe00-b63f-84710c7967bb [INF] Request finished in 30.8683ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:58:29.0229869+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:58:29.0426298+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("23"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T10:58:29.0433773+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T10:58:29.0469889+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 53.2354ms (afa2e885)
2021-09-18T10:58:29.0473653+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:58:29.0478544+05:30 8000018f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 54.9393ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:58:29.0850495+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("22"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:58:29.0978955+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T10:58:29.0982134+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T10:58:29.0986857+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 105.5569ms (afa2e885)
2021-09-18T10:58:29.0987630+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:58:29.0988627+05:30 80000168-0001-fd00-b63f-84710c7967bb [INF] Request finished in 109.2801ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T10:58:29.6240549+05:30 800002b4-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T10:58:29.6241919+05:30 800002b4-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:29.6245127+05:30 800002b4-0005-fc00-b63f-84710c7967bb [INF] Request finished in 0.5805ms 204  (791a596a)
2021-09-18T10:58:29.6332641+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T10:58:29.6334207+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T10:58:29.6336282+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T10:58:29.6338751+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T10:58:29.6420447+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T10:58:29.6534595+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T10:58:29.6605343+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T10:58:29.6712030+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T10:58:29.6719942+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 37.9363ms (afa2e885)
2021-09-18T10:58:29.6721405+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T10:58:29.6778666+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T10:58:29.6802997+05:30 80000191-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256784"", Request ID ""80000191-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T10:58:29.6804905+05:30 80000191-0006-fc00-b63f-84710c7967bb [INF] Request finished in 47.2706ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T10:58:29.6994471+05:30 80000191-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T12:47:19.6542683+05:30 8000016a-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:47:19.6543451+05:30 8000016a-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6545065+05:30 8000016a-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.2628ms 204  (791a596a)
2021-09-18T12:47:19.6549898+05:30 8000002a-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:47:19.6550418+05:30 80000193-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T12:47:19.6550690+05:30 8000002a-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6550715+05:30 80000193-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6553623+05:30 80000193-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.5629ms 204  (791a596a)
2021-09-18T12:47:19.6554965+05:30 8000002a-0006-fe00-b63f-84710c7967bb [INF] Request finished in 0.7074ms 204  (791a596a)
2021-09-18T12:47:19.6644026+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:47:19.6644122+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:47:19.6644557+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6644563+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6655457+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T12:47:19.6648714+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T12:47:19.6656325+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T12:47:19.6656817+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:19.6657158+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:47:19.6657373+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T12:47:19.6657339+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:47:19.6658008+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:47:19.6764631+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T12:47:19.7018330+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:47:19.7071032+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:47:19.7104268+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:47:19.7107106+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T12:47:19.7114421+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 45.6293ms (afa2e885)
2021-09-18T12:47:19.7115139+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:47:19.7116182+05:30 80003358-0004-fb00-b63f-84710c7967bb [INF] Request finished in 47.2537ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:47:19.7159583+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T12:47:19.7163339+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T12:47:19.7223831+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 56.5758ms (afa2e885)
2021-09-18T12:47:19.7224916+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:47:19.7226321+05:30 8000004b-0003-fe00-b63f-84710c7967bb [INF] Request finished in 58.1996ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:47:19.7312576+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:47:19.7344512+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:47:19.7347436+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T12:47:19.7352115+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 69.3505ms (afa2e885)
2021-09-18T12:47:19.7352734+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:47:19.7353797+05:30 80000534-0004-fc00-b63f-84710c7967bb [INF] Request finished in 70.5037ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:47:20.3268730+05:30 8000002c-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T12:47:20.3271336+05:30 8000002c-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:20.3275874+05:30 8000002c-0006-fe00-b63f-84710c7967bb [INF] Request finished in 0.7926ms 204  (791a596a)
2021-09-18T12:47:20.3365982+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T12:47:20.3367436+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:47:20.3369187+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T12:47:20.3371887+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:47:20.3454308+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T12:47:20.3563799+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:47:20.3633292+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:47:20.3731059+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T12:47:20.3738427+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 36.4908ms (afa2e885)
2021-09-18T12:47:20.3739630+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:47:20.3784544+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T12:47:20.3817438+05:30 8000064e-0000-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283323016742477"", Request ID ""8000064e-0000-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T12:47:20.3821460+05:30 8000064e-0000-f800-b63f-84710c7967bb [INF] Request finished in 45.5743ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T12:47:20.3875402+05:30 8000064e-0000-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T12:48:09.8318420+05:30 8000016c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:48:09.8317731+05:30 8000004d-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:48:09.8320866+05:30 8000016c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8320865+05:30 8000004d-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8325052+05:30 8000016c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.7854ms 204  (791a596a)
2021-09-18T12:48:09.8325312+05:30 8000004d-0003-fe00-b63f-84710c7967bb [INF] Request finished in 1.4428ms 204  (791a596a)
2021-09-18T12:48:09.8406544+05:30 8000004f-0003-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T12:48:09.8407492+05:30 8000004f-0003-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8412637+05:30 8000004f-0003-fe00-b63f-84710c7967bb [INF] Request finished in 0.4099ms 204  (791a596a)
2021-09-18T12:48:09.8412953+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:48:09.8413100+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:48:09.8413444+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8413532+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8415255+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:09.8415221+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:09.8416206+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:09.8416172+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:09.8426817+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:48:09.8426817+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:48:09.8428892+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T12:48:09.8432477+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 1.5718ms (afa2e885)
2021-09-18T12:48:09.8432860+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:09.8433979+05:30 80000457-0003-f900-b63f-84710c7967bb [INF] Request finished in 2.1096ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:09.8463397+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T12:48:09.8502242+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T12:48:09.8502268+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T12:48:09.8503010+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:09.8504832+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:09.8505210+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 8.8456ms (afa2e885)
2021-09-18T12:48:09.8505555+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:09.8505691+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:09.8506630+05:30 800002b6-0005-fc00-b63f-84710c7967bb [INF] Request finished in 9.3795ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:09.8518977+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:48:09.8531823+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:48:09.8557698+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:48:09.8560207+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T12:48:09.8564013+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.783ms (afa2e885)
2021-09-18T12:48:09.8564420+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:09.8566077+05:30 80000650-0000-f800-b63f-84710c7967bb [INF] Request finished in 6.3656ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:10.5048662+05:30 80000652-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T12:48:10.5050490+05:30 80000652-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:10.5053844+05:30 80000652-0000-f800-b63f-84710c7967bb [INF] Request finished in 0.5749ms 204  (791a596a)
2021-09-18T12:48:10.5158251+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T12:48:10.5160355+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:10.5162606+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:10.5164874+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:10.5210588+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T12:48:10.5304800+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:48:10.5347125+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:48:10.5444336+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T12:48:10.5444159+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T12:48:10.5450813+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 28.459ms (afa2e885)
2021-09-18T12:48:10.5452268+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:10.5562882+05:30 80000654-0000-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283323016742483"", Request ID ""80000654-0000-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T12:48:10.5564950+05:30 80000654-0000-f800-b63f-84710c7967bb [INF] Request finished in 40.7306ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:10.5598139+05:30 80000654-0000-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T12:48:59.6055471+05:30 80000656-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:48:59.6060485+05:30 80000656-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6066419+05:30 80000656-0000-f800-b63f-84710c7967bb [INF] Request finished in 1.2819ms 204  (791a596a)
2021-09-18T12:48:59.6083670+05:30 80000459-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:48:59.6085688+05:30 80000459-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6089869+05:30 80000459-0003-f900-b63f-84710c7967bb [INF] Request finished in 0.6625ms 204  (791a596a)
2021-09-18T12:48:59.6139326+05:30 80000536-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T12:48:59.6141410+05:30 80000536-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6143239+05:30 80000536-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.4305ms 204  (791a596a)
2021-09-18T12:48:59.6200690+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:48:59.6201366+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6237794+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:59.6239419+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:59.6245324+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:48:59.6245398+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T12:48:59.6246165+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6246170+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:48:59.6247518+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:59.6247381+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T12:48:59.6250617+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:59.6250865+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:48:59.6350051+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T12:48:59.6355735+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T12:48:59.6438271+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:48:59.6439380+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:48:59.6441808+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T12:48:59.6446406+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 20.4301ms (afa2e885)
2021-09-18T12:48:59.6447341+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:59.6451704+05:30 800002b8-0005-fc00-b63f-84710c7967bb [INF] Request finished in 25.1179ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:59.6529637+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T12:48:59.6529784+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:48:59.6535611+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T12:48:59.6539980+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 28.8517ms (afa2e885)
2021-09-18T12:48:59.6540705+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:59.6542458+05:30 8000016e-0001-fd00-b63f-84710c7967bb [INF] Request finished in 29.9616ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:48:59.6611962+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:48:59.6655572+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:48:59.6658548+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T12:48:59.6662935+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 41.0937ms (afa2e885)
2021-09-18T12:48:59.6663664+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:48:59.6665108+05:30 8000045b-0003-f900-b63f-84710c7967bb [INF] Request finished in 42.0487ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:49:00.2415167+05:30 80000658-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T12:49:00.2416532+05:30 80000658-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:49:00.2419742+05:30 80000658-0000-f800-b63f-84710c7967bb [INF] Request finished in 0.5461ms 204  (791a596a)
2021-09-18T12:49:00.2532132+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T12:49:00.2533825+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:49:00.2535586+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T12:49:00.2538904+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:49:00.2625795+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T12:49:00.2743644+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:49:00.2801861+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:49:00.2915417+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T12:49:00.2923192+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 38.2438ms (afa2e885)
2021-09-18T12:49:00.2924512+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:49:00.3005120+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("13"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T12:49:00.3010528+05:30 80000538-0004-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513716348323127"", Request ID ""80000538-0004-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T12:49:00.3012481+05:30 80000538-0004-fc00-b63f-84710c7967bb [INF] Request finished in 48.1068ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T12:49:00.3105250+05:30 80000538-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T12:54:30.9171613+05:30 8000053a-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:54:30.9173126+05:30 8000053a-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9177676+05:30 8000053a-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.9192ms 204  (791a596a)
2021-09-18T12:54:30.9194280+05:30 80002218-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:54:30.9195450+05:30 80002218-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9198407+05:30 80000170-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T12:54:30.9199069+05:30 80002218-0002-f600-b63f-84710c7967bb [INF] Request finished in 0.7772ms 204  (791a596a)
2021-09-18T12:54:30.9199124+05:30 80000170-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9201440+05:30 80000170-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.3267ms 204  (791a596a)
2021-09-18T12:54:30.9325383+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:54:30.9327250+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9346077+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T12:54:30.9346131+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:30.9346577+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9345655+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:54:30.9347800+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:30.9347929+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:30.9348424+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:30.9349635+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:30.9351253+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:30.9352134+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:30.9410751+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T12:54:30.9510067+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:30.9512635+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T12:54:30.9517934+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.8399ms (afa2e885)
2021-09-18T12:54:30.9518813+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:30.9519988+05:30 8000053c-0004-fc00-b63f-84710c7967bb [INF] Request finished in 19.4836ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:30.9550830+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:54:30.9597788+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:30.9651941+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:54:30.9656501+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T12:54:30.9663204+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T12:54:30.9668189+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 31.5185ms (afa2e885)
2021-09-18T12:54:30.9669101+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:30.9670296+05:30 8000335a-0004-fb00-b63f-84710c7967bb [INF] Request finished in 32.4992ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:30.9694991+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:54:30.9697249+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T12:54:30.9700920+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 34.894ms (afa2e885)
2021-09-18T12:54:30.9701397+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:30.9702802+05:30 80000195-0006-fc00-b63f-84710c7967bb [INF] Request finished in 35.7254ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:31.5339217+05:30 8000221a-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T12:54:31.5340778+05:30 8000221a-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:31.5344591+05:30 8000221a-0002-f600-b63f-84710c7967bb [INF] Request finished in 0.6338ms 204  (791a596a)
2021-09-18T12:54:31.5475449+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T12:54:31.5477287+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:31.5479383+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:31.5482039+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:31.5585968+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T12:54:31.5707222+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:54:31.5758771+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:31.5844074+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T12:54:31.5850410+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 36.6977ms (afa2e885)
2021-09-18T12:54:31.5853034+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:31.5902075+05:30 8000221c-0002-f600-b63f-84710c7967bb [ERR] Connection ID ""17726168143530828315"", Request ID ""8000221c-0002-f600-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T12:54:31.5903450+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Request finished in 42.9579ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:31.5910700+05:30 8000221c-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T12:54:31.5985855+05:30 8000221c-0002-f600-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-18T12:54:58.5303130+05:30 80000520-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:54:58.5303830+05:30 80000520-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5306261+05:30 80000520-0007-fe00-b63f-84710c7967bb [INF] Request finished in 0.2863ms 204  (791a596a)
2021-09-18T12:54:58.5313874+05:30 8000045d-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:54:58.5316763+05:30 8000045d-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5318820+05:30 8000045d-0003-f900-b63f-84710c7967bb [INF] Request finished in 0.5139ms 204  (791a596a)
2021-09-18T12:54:58.5322120+05:30 8000335c-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-18T12:54:58.5323338+05:30 8000335c-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5325227+05:30 8000335c-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.3192ms 204  (791a596a)
2021-09-18T12:54:58.5370265+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-18T12:54:58.5371261+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5375071+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:58.5376380+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:58.5380635+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-18T12:54:58.5380584+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getAllUserPermissions   (ca22a1cb)
2021-09-18T12:54:58.5381098+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5381101+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:58.5381762+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:58.5381876+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:58.5382551+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllUserPermissions\", controller = \"User\"}". Executing controller action with signature "System.Collections.Generic.IEnumerable`1[IoT.DataLayer.Models.UserPermission] GetAllUserPermissions(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:58.5382594+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:58.5391835+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-18T12:54:58.5417690+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:58.5419802+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-18T12:54:58.5422873+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.5997ms (afa2e885)
2021-09-18T12:54:58.5423307+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:58.5424148+05:30 80000522-0007-fe00-b63f-84710c7967bb [INF] Request finished in 5.607ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:58.5431329+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:54:58.5457327+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:58.5468531+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:54:58.5503757+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey], [u0].[UserId], [u0].[APIKey], [u0].[AuthProvidor], [u0].[CreatedDate], [u0].[Email], [u0].[FirstName], [u0].[Language], [u0].[LastLogin], [u0].[Lastname], [u0].[ModifiedDate], [u0].[Temperature], [u0].[Timezone], [u0].[UserKey]
FROM [UserPermission] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserId] = [u0].[UserId]
ORDER BY [u0].[FirstName]" (0723d8ff)
2021-09-18T12:54:58.5508239+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.UserPermission, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-18T12:54:58.5512890+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)" in 12.97ms (afa2e885)
2021-09-18T12:54:58.5513558+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetAllUserPermissions (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:58.5514704+05:30 8000015d-0007-fd00-b63f-84710c7967bb [INF] Request finished in 13.415ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:58.5524962+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-18T12:54:58.5527408+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-18T12:54:58.5531389+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 14.8157ms (afa2e885)
2021-09-18T12:54:58.5531870+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:58.5532917+05:30 800002b6-0007-ff00-b63f-84710c7967bb [INF] Request finished in 15.2362ms 200 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:59.1701829+05:30 8000335e-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-18T12:54:59.1702253+05:30 8000335e-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:59.1703148+05:30 8000335e-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.168ms 204  (791a596a)
2021-09-18T12:54:59.1733200+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 107 (ca22a1cb)
2021-09-18T12:54:59.1733672+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-18T12:54:59.1734230+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-18T12:54:59.1734905+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-18T12:54:59.1769752+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-18T12:54:59.1851430+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-18T12:54:59.1906899+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-18T12:54:59.1966132+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.SerializableError"'. (8a1b66c8)
2021-09-18T12:54:59.1970538+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.4833ms (afa2e885)
2021-09-18T12:54:59.1971344+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-18T12:54:59.2006735+05:30 8000221e-0002-f600-b63f-84710c7967bb [ERR] Connection ID ""17726168143530828317"", Request ID ""8000221e-0002-f600-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-18T12:54:59.2007306+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-18T12:54:59.2007689+05:30 8000221e-0002-f600-b63f-84710c7967bb [INF] Request finished in 27.4563ms 400 application/json; charset=utf-8 (791a596a)
2021-09-18T12:54:59.2055131+05:30 8000221e-0002-f600-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
