2021-09-22T18:19:45.8104758+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-22T18:19:45.9920355+05:30 80000023-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-22T18:19:46.0735588+05:30 80000023-0006-ff00-b63f-84710c7967bb [INF] Request finished in 82.4087ms 404  (791a596a)
2021-09-22T18:20:11.9403774+05:30 8000007b-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T18:20:11.9403413+05:30 80000002-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:11.9637911+05:30 80000002-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:11.9637911+05:30 8000007b-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:11.9713596+05:30 8000007b-0004-fb00-b63f-84710c7967bb [INF] Request finished in 33.1603ms 204  (791a596a)
2021-09-22T18:20:11.9713597+05:30 80000002-0005-fd00-b63f-84710c7967bb [INF] Request finished in 32.8996ms 204  (791a596a)
2021-09-22T18:20:11.9877593+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:11.9887737+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:11.9915532+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T18:20:11.9918058+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:12.0056301+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:12.0056301+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:12.2137305+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:12.2137198+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:14.4030322+05:30 80000016-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/dashboard/getDashboardData   (ca22a1cb)
2021-09-22T18:20:14.4031924+05:30 80000016-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:14.4039006+05:30 80000016-0004-fa00-b63f-84710c7967bb [INF] Request finished in 0.7402ms 204  (791a596a)
2021-09-22T18:20:14.4092097+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/dashboard/getDashboardData   (ca22a1cb)
2021-09-22T18:20:14.4093072+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:14.4131319+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DashboardController.GetDashboardData (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:14.4162426+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDashboardData\", controller = \"Dashboard\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData(System.String)" on controller "IoT.WebAPI.Controllers.DashboardController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:14.5001784+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T18:20:14.5001984+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T18:20:14.5001810+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T18:20:15.6960765+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("59"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[ConnectionCount], [d].[DeviceDesc], [d].[DeviceName], [d].[DeviceKey], [d].[DeviceId], [d].[LastConnected], [r].[RoomName], [d0].[DeviceTypeName], [d].[RoomId], [r].[RoomKey]
FROM [Devices] AS [d]
INNER JOIN [Rooms] AS [r] ON [d].[RoomId] = [r].[RoomId]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
WHERE [d].[UserKey] = @__userKey_0
ORDER BY [d].[DeviceName]" (0723d8ff)
2021-09-22T18:20:15.6960765+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("62"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:15.6960765+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("61"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:15.7574054+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [r].[RoomId], [r].[CreatedDate], [r].[ModifiedDate], [r].[RoomDesc], [r].[RoomKey], [r].[RoomName], [r].[UserKey]
FROM [Rooms] AS [r]
WHERE [r].[UserKey] = @__userKey_0
ORDER BY [r].[RoomName]" (0723d8ff)
2021-09-22T18:20:15.8227776+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T18:20:15.8227776+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.DashboardModel"'. (8a1b66c8)
2021-09-22T18:20:15.9088270+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3674.8494ms (afa2e885)
2021-09-22T18:20:15.9088407+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DashboardController.GetDashboardData (IoT.WebAPI)" in 1473.667ms (afa2e885)
2021-09-22T18:20:15.9091011+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:15.9090807+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DashboardController.GetDashboardData (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:15.9337944+05:30 8000007d-0004-fb00-b63f-84710c7967bb [INF] Request finished in 3946.2087ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:15.9337436+05:30 80000004-0003-fb00-b63f-84710c7967bb [INF] Request finished in 1524.4827ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:16.0355735+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:16.0504846+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:16.0518675+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T18:20:16.0591484+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 3843.7941ms (afa2e885)
2021-09-22T18:20:16.0592439+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.0634999+05:30 80000061-0006-fe00-b63f-84710c7967bb [INF] Request finished in 4075.9341ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:16.1164064+05:30 8000007f-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T18:20:16.1164956+05:30 8000007f-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.1169890+05:30 8000007f-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.5907ms 204  (791a596a)
2021-09-22T18:20:16.1255787+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T18:20:16.1257010+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.1266643+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.1290164+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T18:20:16.1291301+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.1303368+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.1315937+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:16.1317449+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.1330460+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.1330460+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.1333949+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.1349945+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.1404200+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:16.1406085+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:16.1410016+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T18:20:16.1414706+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.9868ms (afa2e885)
2021-09-22T18:20:16.1415426+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.1416486+05:30 80000052-0000-f900-b63f-84710c7967bb [INF] Request finished in 10.1159ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:16.1470236+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:16.1485257+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:16.1501766+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T18:20:16.1506145+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15.4912ms (afa2e885)
2021-09-22T18:20:16.1506812+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.1507944+05:30 80000040-0000-fb00-b63f-84710c7967bb [INF] Request finished in 21.8641ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:16.1576431+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T18:20:16.1925244+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:16.2115755+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:16.3257481+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("26"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T18:20:16.3409380+05:30 80000006-0003-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T18:20:16.3413116+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T18:20:16.3470974+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 216.2968ms (afa2e885)
2021-09-22T18:20:16.3472541+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.4853491+05:30 80000006-0003-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T18:20:16.4867133+05:30 80000006-0003-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456118015426565"", Request ID ""80000006-0003-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T18:20:16.4868873+05:30 80000006-0003-fb00-b63f-84710c7967bb [INF] Request finished in 361.5507ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T18:20:16.7305449+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T18:20:16.7319047+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.7348308+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.7361692+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.7483176+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T18:20:16.7583911+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:16.7615783+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:16.7699280+05:30 80000042-0000-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T18:20:16.7706313+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T18:20:16.7709578+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T18:20:16.7720422+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 35.4675ms (afa2e885)
2021-09-22T18:20:16.7721834+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.7776210+05:30 80000042-0000-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456105130524737"", Request ID ""80000042-0000-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T18:20:16.7780119+05:30 80000042-0000-fb00-b63f-84710c7967bb [INF] Request finished in 48.4472ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T18:20:16.7797432+05:30 80000042-0000-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T18:20:16.9328060+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T18:20:16.9328044+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:16.9334863+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.9334808+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:16.9344962+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.9344962+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:16.9358426+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.9358424+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:16.9422036+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:16.9462945+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:16.9510012+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T18:20:16.9520792+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T18:20:16.9550794+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 18.9089ms (afa2e885)
2021-09-22T18:20:16.9552811+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:16.9557028+05:30 80000081-0004-fb00-b63f-84710c7967bb [INF] Request finished in 23.0101ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:17.0320623+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T18:20:17.0356452+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:17.0361813+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T18:20:17.0369118+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 100.8315ms (afa2e885)
2021-09-22T18:20:17.0370850+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:17.0373336+05:30 80000018-0004-fa00-b63f-84710c7967bb [INF] Request finished in 104.6783ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:17.2145872+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T18:20:17.2147502+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:17.2150393+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:17.2153259+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:17.2204385+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T18:20:17.2330502+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T18:20:17.2365984+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:17.2444418+05:30 80000004-0005-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T18:20:17.2445135+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T18:20:17.2446228+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T18:20:17.2451089+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 29.6635ms (afa2e885)
2021-09-22T18:20:17.2451971+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:17.2491549+05:30 80000004-0005-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T18:20:17.4385286+05:30 80000008-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:17.4386951+05:30 80000008-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:17.4388497+05:30 8000001a-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T18:20:17.4390193+05:30 8000001a-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:17.4392574+05:30 80000008-0003-fb00-b63f-84710c7967bb [INF] Request finished in 0.7923ms 204  (791a596a)
2021-09-22T18:20:17.4393061+05:30 8000001a-0004-fa00-b63f-84710c7967bb [INF] Request finished in 0.4969ms 204  (791a596a)
2021-09-22T18:20:17.4486103+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T18:20:17.4486058+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:17.4487501+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:17.4488087+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:17.4489696+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:17.4489776+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:17.4491617+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:17.4491531+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:17.4502384+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T18:20:17.4515480+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:17.4520068+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T18:20:17.4526658+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.3761ms (afa2e885)
2021-09-22T18:20:17.4527936+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:17.4529737+05:30 8000001a-0006-fc00-b63f-84710c7967bb [INF] Request finished in 4.4331ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:17.4594350+05:30 80000004-0005-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571314681217027"", Request ID ""80000004-0005-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T18:20:17.4596511+05:30 80000004-0005-fd00-b63f-84710c7967bb [INF] Request finished in 245.1137ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T18:20:21.3468829+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T18:20:21.3486708+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:21.3477535+05:30 8000000e-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T18:20:21.3492529+05:30 8000000e-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:21.3510596+05:30 8000000e-0002-f800-b63f-84710c7967bb [INF] Request finished in 3.7949ms 204  (791a596a)
2021-09-22T18:20:21.3511189+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:21.3520627+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:21.3577462+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T18:20:21.3577463+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T18:20:21.3585630+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T18:20:21.3608975+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T18:20:21.3617475+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T18:20:21.3642383+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.4447ms (afa2e885)
2021-09-22T18:20:21.3647085+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:21.3653274+05:30 8000000a-0003-fb00-b63f-84710c7967bb [INF] Request finished in 18.8232ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:21.3688493+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T18:20:21.3897916+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T18:20:21.3910477+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T18:20:21.4049206+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 35.865ms (afa2e885)
2021-09-22T18:20:21.4050152+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T18:20:21.4052294+05:30 8000001c-0004-fa00-b63f-84710c7967bb [INF] Request finished in 47.7193ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T18:20:47.4743785+05:30 80000063-0006-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,022"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T18:20:47.4808255+05:30 80000063-0006-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:3d87a23b-1aeb-4814-ab10-69223f8399a1
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
ClientConnectionId:3d87a23b-1aeb-4814-ab10-69223f8399a1
Error Number:-2,State:0,Class:11
2021-09-22T19:16:13.1558226+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 3355711.743ms (afa2e885)
2021-09-22T19:16:13.1579028+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:16:13.2049063+05:30 80000063-0006-fe00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 63
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 22
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:3d87a23b-1aeb-4814-ab10-69223f8399a1
Error Number:-2,State:0,Class:11
2021-09-22T19:16:13.2238038+05:30 80000063-0006-fe00-b63f-84710c7967bb [INF] Request finished in 3355780.5438ms 500 text/plain (791a596a)
2021-09-22T19:30:18.0343137+05:30 80000048-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:18.0343137+05:30 80000054-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T19:30:18.0358098+05:30 80000054-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:18.0358098+05:30 80000048-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:18.0444797+05:30 80000048-0000-fb00-b63f-84710c7967bb [INF] Request finished in 13.8439ms 204  (791a596a)
2021-09-22T19:30:18.0453156+05:30 80000054-0000-f900-b63f-84710c7967bb [INF] Request finished in 14.7374ms 204  (791a596a)
2021-09-22T19:30:18.0525781+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:18.0526221+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T19:30:18.0530652+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:18.0531633+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:18.0544860+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:18.0552819+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:18.0590374+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:18.0597432+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:18.0730242+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:18.0745283+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:18.0759747+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 20.3649ms (afa2e885)
2021-09-22T19:30:18.0761007+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:18.0761477+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T19:30:18.0763943+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:30:18.0765332+05:30 80000002-0003-fa00-b63f-84710c7967bb [INF] Request finished in 24.2314ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:18.0769593+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 17.0703ms (afa2e885)
2021-09-22T19:30:18.0772412+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:18.0774625+05:30 8000002a-0001-ff00-b63f-84710c7967bb [INF] Request finished in 25.0753ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:23.7784799+05:30 8000002c-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:30:23.7784799+05:30 8000002f-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:23.7788440+05:30 8000002c-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7788458+05:30 8000002f-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7789999+05:30 80000006-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:30:23.7790560+05:30 80000006-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7795665+05:30 8000002c-0001-ff00-b63f-84710c7967bb [INF] Request finished in 4.6992ms 204  (791a596a)
2021-09-22T19:30:23.7795662+05:30 80000006-0005-fd00-b63f-84710c7967bb [INF] Request finished in 0.7136ms 204  (791a596a)
2021-09-22T19:30:23.7795665+05:30 8000002f-0005-fe00-b63f-84710c7967bb [INF] Request finished in 4.6993ms 204  (791a596a)
2021-09-22T19:30:23.7840667+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:23.7841469+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7841447+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:30:23.7841824+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7843581+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:23.7844267+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:23.7846381+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:23.7846392+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:23.7850376+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:23.7850457+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:23.7854325+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:23.7895130+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllDeviceCapability\", controller = \"Admin\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetAllDeviceCapability(System.String)" on controller "IoT.WebAPI.Controllers.AdminController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:23.7898970+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:23.7908462+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:23.7915123+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:23.7916624+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.4746ms (afa2e885)
2021-09-22T19:30:23.7917136+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:23.7919355+05:30 80000008-0005-fd00-b63f-84710c7967bb [INF] Request finished in 7.5686ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:23.7958771+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:30:23.7984810+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:23.8015166+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:23.8018021+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:23.8022668+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.1393ms (afa2e885)
2021-09-22T19:30:23.8023198+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:23.8024972+05:30 80000031-0005-fe00-b63f-84710c7967bb [INF] Request finished in 18.5404ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:23.8069330+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [UserPermission] AS [u]
WHERE ([u].[UserKey] = @__userKey_0) AND ([u].[IsAdmin] = CAST(1 AS bit))" (0723d8ff)
2021-09-22T19:30:23.8368595+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeciveActionId], [d].[CreatedDate], [d].[DeciveActionName], [d].[DeviceActionNameBackEnd], [d].[DeviceActionValue], [d].[DeviceTypeId], [d].[ModifiedDate], [d0].[DeviceTypeId], [d0].[CreatedDate], [d0].[DeviceTypeName], [d0].[ModifiedDate]
FROM [DeviceActions] AS [d]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
ORDER BY [d].[DeciveActionName]" (0723d8ff)
2021-09-22T19:30:23.8765832+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.DeviceAction, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:30:23.8804824+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)" in 90.881ms (afa2e885)
2021-09-22T19:30:23.8805429+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:23.8806595+05:30 80000043-0002-fb00-b63f-84710c7967bb [INF] Request finished in 96.5158ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.3857420+05:30 80000045-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T19:30:24.3861797+05:30 80000045-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.3877699+05:30 80000045-0002-fb00-b63f-84710c7967bb [INF] Request finished in 1.756ms 204  (791a596a)
2021-09-22T19:30:24.3925356+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:24.3926935+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.3932350+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.3939418+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.3994814+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:24.4061873+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.4112705+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.4148926+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:24.4150754+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.4152848+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.4154097+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.4157362+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:24.4157998+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.4160041+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.4161077+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.4165713+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.4176984+05:30 80000033-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:24.4180520+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:24.4189043+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 24.7819ms (afa2e885)
2021-09-22T19:30:24.4189902+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.4227231+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.4233468+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:24.4244994+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.4244877+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.4247951+05:30 80000033-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145010"", Request ID ""80000033-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:30:24.4247853+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:24.4247913+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:24.4249429+05:30 80000033-0005-fe00-b63f-84710c7967bb [INF] Request finished in 32.4176ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:24.4257279+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 9.5511ms (afa2e885)
2021-09-22T19:30:24.4257223+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.2499ms (afa2e885)
2021-09-22T19:30:24.4257708+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.4257739+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.4259599+05:30 80000022-0004-fa00-b63f-84710c7967bb [INF] Request finished in 11.1523ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.4260021+05:30 80000056-0000-f900-b63f-84710c7967bb [INF] Request finished in 10.2427ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.4281605+05:30 80000033-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:30:24.6842384+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:24.6844607+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.6850033+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.6854982+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.6894604+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:24.6896094+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:24.6896183+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.6897878+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.6902013+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.6902303+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.6907774+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.6907239+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.6948663+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:24.6949628+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.6954806+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:30:24.6966623+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:24.6983150+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.3172ms (afa2e885)
2021-09-22T19:30:24.6986272+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.6987986+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.6992226+05:30 80000027-0006-ff00-b63f-84710c7967bb [INF] Request finished in 9.76ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.7063320+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.7090094+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.7097597+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.7108257+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:24.7120768+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 20.9848ms (afa2e885)
2021-09-22T19:30:24.7121676+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.7125373+05:30 80000047-0002-fb00-b63f-84710c7967bb [INF] Request finished in 23.0814ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.7132087+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.7384906+05:30 80000065-0006-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:24.7385608+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:24.7386823+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:24.7422909+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 56.6739ms (afa2e885)
2021-09-22T19:30:24.7423449+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.7425038+05:30 80000065-0006-fe00-b63f-84710c7967bb [INF] Request finished in 58.3864ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:24.8724439+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:24.8726325+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.8728729+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.8732457+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.8764596+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:24.8818164+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.8859907+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.8917898+05:30 80000058-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:24.8919125+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:24.8920028+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:24.8922142+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 18.8896ms (afa2e885)
2021-09-22T19:30:24.8922629+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.8959872+05:30 80000058-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668887"", Request ID ""80000058-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:30:24.8960865+05:30 80000058-0000-f900-b63f-84710c7967bb [INF] Request finished in 23.679ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:24.8961506+05:30 80000058-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:30:24.9073475+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:24.9073476+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:24.9074145+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.9074170+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:24.9075205+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.9076397+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.9076604+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:24.9077568+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:24.9087735+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:24.9087739+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.9090637+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:24.9094541+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 1.6347ms (afa2e885)
2021-09-22T19:30:24.9095116+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.9096068+05:30 8000005a-0000-f900-b63f-84710c7967bb [INF] Request finished in 2.2766ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:24.9103927+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:24.9118332+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:24.9122227+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:24.9127170+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.0033ms (afa2e885)
2021-09-22T19:30:24.9127775+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:24.9128876+05:30 8000004a-0000-fb00-b63f-84710c7967bb [INF] Request finished in 5.554ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.1722731+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:25.1724099+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.1726596+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.1729385+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.1774456+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:25.1811172+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:25.1826772+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:25.1864163+05:30 8000004c-0000-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:25.1865597+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:25.1868060+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:25.1875990+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.5123ms (afa2e885)
2021-09-22T19:30:25.1876736+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.1879211+05:30 8000004c-0000-fb00-b63f-84710c7967bb [INF] Request finished in 15.6851ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:25.1925383+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:25.1925372+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:25.1926725+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.1926734+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.1928679+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.1928686+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.1931744+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.1931810+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.1945198+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.1945206+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:25.1947452+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:25.1953551+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.1046ms (afa2e885)
2021-09-22T19:30:25.1953993+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.1955552+05:30 80000024-0004-fa00-b63f-84710c7967bb [INF] Request finished in 3.0312ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.1959432+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:25.1977049+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.1979940+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:25.1984846+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.2361ms (afa2e885)
2021-09-22T19:30:25.1985354+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.1986305+05:30 80000049-0002-fb00-b63f-84710c7967bb [INF] Request finished in 6.1173ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.5115658+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:25.5118292+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.5128263+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.5132416+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.5133746+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:25.5133844+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:25.5135389+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.5136755+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.5138220+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.5141482+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.5142038+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.5144332+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.5171348+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:30:25.5179548+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.5182205+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:25.5189594+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:25.5196211+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:25.5208771+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.2799ms (afa2e885)
2021-09-22T19:30:25.5210479+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.5216991+05:30 80000067-0006-fe00-b63f-84710c7967bb [INF] Request finished in 8.0766ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.5224287+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:25.5253694+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:25.5280555+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.5287649+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:25.5302110+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15.8258ms (afa2e885)
2021-09-22T19:30:25.5303260+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.5305198+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:25.5306374+05:30 80000029-0006-ff00-b63f-84710c7967bb [INF] Request finished in 17.2266ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.5398866+05:30 8000004e-0000-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:25.5400816+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:25.5401989+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:25.5409752+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 27.4831ms (afa2e885)
2021-09-22T19:30:25.5410838+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.5466145+05:30 8000004e-0000-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:30:25.7933989+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:25.7942442+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.7960141+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.7966019+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.8021497+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:25.8024155+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.8027501+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.8031741+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.8034186+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:25.8036054+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:25.8041645+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:25.8047138+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:25.8076901+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.8079066+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:30:25.8115646+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:25.8132177+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:25.8144374+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:25.8156494+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 10.6993ms (afa2e885)
2021-09-22T19:30:25.8157651+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.8157968+05:30 8000004b-0002-fb00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("13"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:30:25.8165280+05:30 80000004-0003-fa00-b63f-84710c7967bb [INF] Request finished in 13.0746ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.8184471+05:30 8000004e-0000-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456105130524749"", Request ID ""8000004e-0000-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:30:25.8186073+05:30 8000004e-0000-fb00-b63f-84710c7967bb [INF] Request finished in 307.0618ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:25.8193550+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:25.8199164+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:25.8207021+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.412ms (afa2e885)
2021-09-22T19:30:25.8207860+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.8209379+05:30 8000002e-0001-ff00-b63f-84710c7967bb [INF] Request finished in 18.8431ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:25.8220551+05:30 8000004b-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:30:25.8975138+05:30 8000004b-0002-fb00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:30:25.8989536+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:30:25.9044641+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 107.7148ms (afa2e885)
2021-09-22T19:30:25.9045336+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:25.9046553+05:30 8000004b-0002-fb00-b63f-84710c7967bb [INF] Request finished in 111.7697ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:30:26.0565434+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:26.0567138+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.0569038+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.0571097+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.0597611+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:26.0638923+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:26.0645169+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:26.0645170+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:26.0646692+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.0646689+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.0648726+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.0649246+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.0651652+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.0652473+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.0668788+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:26.0668758+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:26.0673360+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:30:26.0682718+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.8916ms (afa2e885)
2021-09-22T19:30:26.0683394+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:26.0685930+05:30 80000026-0004-fa00-b63f-84710c7967bb [INF] Request finished in 4.082ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:26.0731993+05:30 8000004d-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:26.0734104+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:26.0737239+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:26.0738371+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:26.0738894+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.7244ms (afa2e885)
2021-09-22T19:30:26.0739351+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:26.0759689+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:26.0774732+05:30 8000004d-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459340"", Request ID ""8000004d-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:30:26.0775587+05:30 8000004d-0002-fb00-b63f-84710c7967bb [INF] Request finished in 21.0429ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:26.0778690+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:26.0781510+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:26.0783581+05:30 8000004d-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:30:26.0785082+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.2798ms (afa2e885)
2021-09-22T19:30:26.0785871+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:26.0787542+05:30 80000035-0005-fe00-b63f-84710c7967bb [INF] Request finished in 14.2609ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:26.2982279+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:30:26.2991376+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.2999239+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.3059095+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.3083029+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:30:26.3117981+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:26.3133676+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:30:26.3176981+05:30 80000028-0004-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:30:26.3179357+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:30:26.3179664+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:30:26.3188482+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.7914ms (afa2e885)
2021-09-22T19:30:26.3189145+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:26.3236121+05:30 80000028-0004-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:30:26.3887494+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:30:26.3887966+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:30:26.3888335+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.3888338+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:30:26.3890897+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.3891299+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:30:26.3893072+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.3893066+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:30:26.3907976+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:30:26.3917902+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:26.3962354+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:30:26.3976988+05:30 80000028-0004-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398528272465959"", Request ID ""80000028-0004-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:30:26.3978715+05:30 80000028-0004-fa00-b63f-84710c7967bb [INF] Request finished in 99.6074ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:30:26.3988959+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:30:26.3994688+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:30:26.4003895+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.9385ms (afa2e885)
2021-09-22T19:30:26.4004553+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:30:26.4008014+05:30 80000078-0004-fc00-b63f-84710c7967bb [INF] Request finished in 12.0658ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:30:56.4037624+05:30 80000037-0005-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,012"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T19:30:56.4075761+05:30 80000037-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 127
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 43
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11
2021-09-22T19:31:00.6184540+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 34228.9726ms (afa2e885)
2021-09-22T19:31:00.6190335+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:00.6249800+05:30 80000037-0005-fe00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 127
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 43
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11
2021-09-22T19:31:00.6386579+05:30 80000037-0005-fe00-b63f-84710c7967bb [INF] Request finished in 34249.7621ms 500 text/plain (791a596a)
2021-09-22T19:31:57.1967586+05:30 80000050-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:31:57.1968308+05:30 80000050-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.1972215+05:30 80000050-0000-fb00-b63f-84710c7967bb [INF] Request finished in 0.4738ms 204  (791a596a)
2021-09-22T19:31:57.1979126+05:30 8000005c-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:31:57.1979779+05:30 8000005c-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.1983986+05:30 8000005c-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.4997ms 204  (791a596a)
2021-09-22T19:31:57.1986266+05:30 80000030-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:57.1997737+05:30 80000030-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.2031804+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:31:57.2038352+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.2038555+05:30 80000030-0001-ff00-b63f-84710c7967bb [INF] Request finished in 5.5001ms 204  (791a596a)
2021-09-22T19:31:57.2101590+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:57.2101738+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:57.2102916+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.2109144+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.2110363+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.2110418+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.2111517+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.2136125+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.2185484+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:57.2185490+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:57.2189914+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:57.2198525+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.0829ms (afa2e885)
2021-09-22T19:31:57.2199373+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.2201878+05:30 8000002b-0006-ff00-b63f-84710c7967bb [INF] Request finished in 10.0365ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:57.2240017+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.2241176+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllDeviceCapability\", controller = \"Admin\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetAllDeviceCapability(System.String)" on controller "IoT.WebAPI.Controllers.AdminController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.2260247+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:57.2261875+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [UserPermission] AS [u]
WHERE ([u].[UserKey] = @__userKey_0) AND ([u].[IsAdmin] = CAST(1 AS bit))" (0723d8ff)
2021-09-22T19:31:57.2277956+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:57.2280014+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:57.2283789+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 14.6838ms (afa2e885)
2021-09-22T19:31:57.2284158+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.2285241+05:30 8000004f-0002-fb00-b63f-84710c7967bb [INF] Request finished in 18.3902ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:57.2294006+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeciveActionId], [d].[CreatedDate], [d].[DeciveActionName], [d].[DeviceActionNameBackEnd], [d].[DeviceActionValue], [d].[DeviceTypeId], [d].[ModifiedDate], [d0].[DeviceTypeId], [d0].[CreatedDate], [d0].[DeviceTypeName], [d0].[ModifiedDate]
FROM [DeviceActions] AS [d]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
ORDER BY [d].[DeciveActionName]" (0723d8ff)
2021-09-22T19:31:57.2299627+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.DeviceAction, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:31:57.2305104+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)" in 6.3311ms (afa2e885)
2021-09-22T19:31:57.2305646+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.2306623+05:30 80000039-0005-fe00-b63f-84710c7967bb [INF] Request finished in 27.6722ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:57.7237782+05:30 80000051-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T19:31:57.7238765+05:30 80000051-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.7244384+05:30 80000051-0002-fb00-b63f-84710c7967bb [INF] Request finished in 0.6399ms 204  (791a596a)
2021-09-22T19:31:57.7286001+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:57.7286565+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.7288916+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.7289894+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.7330670+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:57.7373998+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:57.7429946+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:57.7452237+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:57.7452237+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:57.7452720+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.7452720+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:57.7453409+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.7454209+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:57.7454151+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.7454728+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:57.7470374+05:30 80000053-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:57.7471555+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:57.7472524+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:57.7478409+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 18.7469ms (afa2e885)
2021-09-22T19:31:57.7479087+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.7480299+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:57.7507110+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:57.7514705+05:30 80000053-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459346"", Request ID ""80000053-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:57.7515956+05:30 80000053-0002-fb00-b63f-84710c7967bb [INF] Request finished in 23.0145ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:57.7520075+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:57.7524909+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:57.7532217+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.6076ms (afa2e885)
2021-09-22T19:31:57.7532832+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.7538032+05:30 80000069-0006-fe00-b63f-84710c7967bb [INF] Request finished in 8.5712ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:57.7548586+05:30 80000053-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:57.9217771+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("171"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:57.9246334+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:57.9250396+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:57.9257083+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 180.2077ms (afa2e885)
2021-09-22T19:31:57.9257595+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:57.9259031+05:30 8000002d-0006-ff00-b63f-84710c7967bb [INF] Request finished in 180.7057ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.0086516+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:58.0087188+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.0087993+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.0089103+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.0114264+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:58.0114263+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:58.0114889+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.0114924+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.0115810+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.0116642+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.0116686+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.0117082+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.0127114+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:58.0133951+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:58.0147647+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.0155928+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.0159404+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:58.0165431+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.7048ms (afa2e885)
2021-09-22T19:31:58.0166023+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.0167652+05:30 80000002-0003-f900-b63f-84710c7967bb [INF] Request finished in 5.3849ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.0206657+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.1354350+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("113"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.1354333+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("119"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.1412865+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.1423925+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:58.1433234+05:30 8000003b-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:58.1437352+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:58.1438683+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 132.061ms (afa2e885)
2021-09-22T19:31:58.1439490+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.1443103+05:30 80000006-0003-fa00-b63f-84710c7967bb [INF] Request finished in 132.8969ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.1445931+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 135.4052ms (afa2e885)
2021-09-22T19:31:58.1448138+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.1496177+05:30 8000003b-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145018"", Request ID ""8000003b-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:58.1498575+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Request finished in 141.1575ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:58.1505758+05:30 8000003b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:58.1583248+05:30 8000003b-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:58.2366624+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:58.2367411+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.2368561+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.2369787+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.2390887+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:58.2391929+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.2393071+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.2393007+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:58.2393833+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.2394099+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.2395322+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.2396959+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.2408052+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:58.2431838+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.2431728+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:58.2453032+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.2457326+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:58.2463367+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.5333ms (afa2e885)
2021-09-22T19:31:58.2463980+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.2465548+05:30 8000007a-0002-fa00-b63f-84710c7967bb [INF] Request finished in 7.2991ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.2495205+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.2500390+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.2548048+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.2548067+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.2552996+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:58.2559728+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 16.4442ms (afa2e885)
2021-09-22T19:31:58.2560385+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.2561978+05:30 80000055-0002-fb00-b63f-84710c7967bb [INF] Request finished in 17.1662ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.2598923+05:30 80000032-0001-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:58.2601381+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:58.2606674+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.5673ms (afa2e885)
2021-09-22T19:31:58.2607343+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.2630099+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:58.2649117+05:30 80000032-0001-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686485577203761"", Request ID ""80000032-0001-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:58.2651087+05:30 80000032-0001-ff00-b63f-84710c7967bb [INF] Request finished in 28.4193ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:58.2673393+05:30 80000032-0001-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:58.4542454+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:58.4542981+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.4543655+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.4544491+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.4572682+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:58.4621476+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.4639073+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:58.4639072+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:58.4639616+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.4640057+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.4640808+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.4640898+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.4641570+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.4641554+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.4650439+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:58.4661767+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.4662626+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.4664897+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.4665732+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:58.4671205+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.8453ms (afa2e885)
2021-09-22T19:31:58.4671676+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.4673304+05:30 8000007a-0004-fc00-b63f-84710c7967bb [INF] Request finished in 3.4323ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.4708464+05:30 80000057-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:58.4711133+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:58.4716785+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 17.1548ms (afa2e885)
2021-09-22T19:31:58.4717492+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.4736590+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.4754487+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:58.4755566+05:30 80000057-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459350"", Request ID ""80000057-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:58.4756393+05:30 80000057-0002-fb00-b63f-84710c7967bb [INF] Request finished in 21.4145ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:58.4806444+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.4811210+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:58.4813995+05:30 80000057-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:58.4816982+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.4774ms (afa2e885)
2021-09-22T19:31:58.4818103+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.4819663+05:30 8000005e-0000-f900-b63f-84710c7967bb [INF] Request finished in 18.081ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:58.7621655+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:58.7622223+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.7622882+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.7623671+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.7666278+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:58.7763441+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:58.7807840+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.7857168+05:30 8000002f-0006-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:58.7859670+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:58.7865070+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 24.0595ms (afa2e885)
2021-09-22T19:31:58.7865709+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.7890093+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:58.7906627+05:30 8000002f-0006-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686507052040238"", Request ID ""8000002f-0006-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:58.7908021+05:30 8000002f-0006-ff00-b63f-84710c7967bb [INF] Request finished in 28.6651ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:58.7945762+05:30 8000002f-0006-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:58.8796798+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:58.8798210+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.8799268+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.8800529+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.8799694+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:58.8802474+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:58.8804410+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:58.8808874+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:58.8822244+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:58.8840401+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:58.8850470+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:58.8853932+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:58.8858282+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.8619ms (afa2e885)
2021-09-22T19:31:58.8858839+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:58.8860231+05:30 80000031-0006-ff00-b63f-84710c7967bb [INF] Request finished in 6.0634ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.0383723+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("153"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.0438510+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.0443386+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:59.0450833+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 164.944ms (afa2e885)
2021-09-22T19:31:59.0451733+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.0453884+05:30 80000060-0000-f900-b63f-84710c7967bb [INF] Request finished in 165.7424ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.2077246+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:59.2078287+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.2079576+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.2081868+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.2107880+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:59.2107878+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:59.2108523+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.2108522+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.2110291+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.2111306+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.2111529+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.2112034+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.2121717+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:59.2130176+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:59.2142327+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.2145402+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:59.2150027+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.7845ms (afa2e885)
2021-09-22T19:31:59.2150557+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.2150947+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.2151761+05:30 8000007c-0002-fa00-b63f-84710c7967bb [INF] Request finished in 4.4102ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.2190994+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.2202422+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.2222536+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.2222537+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.2224930+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:59.2228512+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.5956ms (afa2e885)
2021-09-22T19:31:59.2228968+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.2229910+05:30 80000059-0002-fb00-b63f-84710c7967bb [INF] Request finished in 12.2283ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.2264365+05:30 80000034-0001-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:59.2265481+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:59.2268559+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 18.593ms (afa2e885)
2021-09-22T19:31:59.2269090+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.2284829+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:59.2291661+05:30 80000034-0001-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686485577203763"", Request ID ""80000034-0001-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:59.2292256+05:30 80000034-0001-ff00-b63f-84710c7967bb [INF] Request finished in 21.597ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:59.2318123+05:30 80000034-0001-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:59.4729375+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:59.4730007+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.4731031+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.4733094+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.4755479+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:59.4755476+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:59.4756152+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.4756163+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.4757025+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.4757384+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.4757848+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.4757787+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.4765016+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:59.4779085+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:59.4785679+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.4795864+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.4797823+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:59.4801919+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.3604ms (afa2e885)
2021-09-22T19:31:59.4802378+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.4803193+05:30 8000005b-0002-fb00-b63f-84710c7967bb [INF] Request finished in 4.8261ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.4825101+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.4832817+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.4857812+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.4857760+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.4859828+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:59.4863237+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.5012ms (afa2e885)
2021-09-22T19:31:59.4863647+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.4864290+05:30 8000002a-0004-fa00-b63f-84710c7967bb [INF] Request finished in 10.9345ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.4896194+05:30 8000007c-0004-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:59.4897489+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:59.4900415+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.6657ms (afa2e885)
2021-09-22T19:31:59.4901025+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.4918626+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:59.4926071+05:30 8000007c-0004-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513716348321915"", Request ID ""8000007c-0004-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:59.4927004+05:30 8000007c-0004-fc00-b63f-84710c7967bb [INF] Request finished in 19.7777ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:59.4950395+05:30 8000007c-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:59.7217532+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:59.7218128+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.7218934+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.7219748+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.7285574+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:59.7329472+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.7351116+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:59.7351925+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.7353602+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.7354497+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.7354620+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:59.7354992+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.7355543+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.7356244+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.7369492+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:59.7388077+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.7388916+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.7390672+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:59.7394618+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.9614ms (afa2e885)
2021-09-22T19:31:59.7395148+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.7395905+05:30 80000033-0006-ff00-b63f-84710c7967bb [INF] Request finished in 4.5266ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.7398923+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.7432722+05:30 80000062-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:59.7433859+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:59.7437295+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 21.6971ms (afa2e885)
2021-09-22T19:31:59.7437775+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.7447074+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.7457255+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:59.7465164+05:30 80000062-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668897"", Request ID ""80000062-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:59.7465899+05:30 80000062-0000-f900-b63f-84710c7967bb [INF] Request finished in 24.8607ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:59.7476936+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.7479966+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:59.7483786+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.4733ms (afa2e885)
2021-09-22T19:31:59.7484360+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.7485370+05:30 8000006b-0006-fe00-b63f-84710c7967bb [INF] Request finished in 13.0866ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.7496548+05:30 80000062-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:31:59.9680139+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:31:59.9680826+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.9681665+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.9682695+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.9750172+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:31:59.9794110+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.9823339+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:31:59.9823343+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:31:59.9824051+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.9824048+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:31:59.9825103+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.9825516+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:31:59.9826096+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.9826280+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:31:59.9836162+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:31:59.9844509+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.9851422+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.9863922+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:31:59.9865886+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:31:59.9869098+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.2213ms (afa2e885)
2021-09-22T19:31:59.9869515+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.9870525+05:30 80000064-0000-f900-b63f-84710c7967bb [INF] Request finished in 4.7588ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.9881998+05:30 8000003d-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:31:59.9883177+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:31:59.9886645+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.3291ms (afa2e885)
2021-09-22T19:31:59.9887163+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.9906281+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:31:59.9914067+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:31:59.9914203+05:30 8000003d-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145020"", Request ID ""8000003d-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:31:59.9914931+05:30 8000003d-0005-fe00-b63f-84710c7967bb [INF] Request finished in 23.5366ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:31:59.9940281+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:31:59.9943118+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:31:59.9949349+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.2419ms (afa2e885)
2021-09-22T19:31:59.9950027+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:31:59.9950922+05:30 80000052-0000-fb00-b63f-84710c7967bb [INF] Request finished in 12.7949ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:31:59.9961724+05:30 8000003d-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T19:32:00.2934405+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:00.2935245+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.2936302+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.2937888+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.3009813+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:00.3096621+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:00.3161725+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:00.3191749+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:00.3192660+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.3193893+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.3195425+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.3210960+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:00.3211891+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.3215379+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.3216801+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.3237057+05:30 80000008-0003-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:00.3237649+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.3238541+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:00.3239797+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:32:00.3243314+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 30.4245ms (afa2e885)
2021-09-22T19:32:00.3244081+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.3273498+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:00.3288022+05:30 80000008-0003-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398523977498631"", Request ID ""80000008-0003-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:32:00.3289197+05:30 80000008-0003-fa00-b63f-84710c7967bb [INF] Request finished in 35.5102ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:00.3294944+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:00.3299284+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:00.3305940+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 8.723ms (afa2e885)
2021-09-22T19:32:00.3306798+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.3308198+05:30 80000054-0000-fb00-b63f-84710c7967bb [INF] Request finished in 9.7571ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.3331111+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:00.3334869+05:30 80000008-0003-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T19:32:00.3384333+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.3387518+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:00.3391774+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 19.5401ms (afa2e885)
2021-09-22T19:32:00.3392373+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.3393310+05:30 8000005d-0002-fb00-b63f-84710c7967bb [INF] Request finished in 20.2274ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.5791646+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:00.5793248+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.5797901+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.5800670+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.5854764+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:00.5871384+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:00.5874036+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.5876744+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.5879013+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.5884099+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:00.5885330+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.5888249+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.5890471+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.5900325+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.5905551+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:32:00.5922691+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:00.5927083+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:00.5927456+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:00.5935838+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.358ms (afa2e885)
2021-09-22T19:32:00.5936958+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.5939165+05:30 80000056-0000-fb00-b63f-84710c7967bb [INF] Request finished in 5.5587ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.5970210+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:00.5974588+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.5980649+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:00.5985783+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.5412ms (afa2e885)
2021-09-22T19:32:00.5986562+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.5987547+05:30 80000036-0001-ff00-b63f-84710c7967bb [INF] Request finished in 11.6986ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.6000108+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:00.6058465+05:30 8000006d-0006-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:00.6059138+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:00.6060241+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:00.6064652+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 26.2867ms (afa2e885)
2021-09-22T19:32:00.6065317+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.6106083+05:30 8000006d-0006-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:32:00.8365604+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:00.8367924+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.8370301+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.8373093+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.8481227+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:00.8483378+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.8483276+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:00.8485399+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.8485088+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:00.8486208+05:30 80000035-0006-ff00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("10"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:32:00.8486832+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.8489362+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:00.8490515+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:00.8501571+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:32:00.8506327+05:30 8000006d-0006-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628913014112364"", Request ID ""8000006d-0006-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:32:00.8507423+05:30 8000006d-0006-fe00-b63f-84710c7967bb [INF] Request finished in 271.7434ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:00.8514457+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.8515406+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:00.8518239+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:00.8523173+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.1784ms (afa2e885)
2021-09-22T19:32:00.8523855+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.8525152+05:30 80000038-0001-ff00-b63f-84710c7967bb [INF] Request finished in 4.2971ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.8535976+05:30 80000035-0006-ff00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:32:00.8558384+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:00.9322087+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:00.9324318+05:30 80000035-0006-ff00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:32:00.9325469+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:00.9327695+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:32:00.9330982+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 84.2383ms (afa2e885)
2021-09-22T19:32:00.9331632+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.9335246+05:30 80000022-0007-ff00-b63f-84710c7967bb [INF] Request finished in 85.1923ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:00.9335910+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 96.1661ms (afa2e885)
2021-09-22T19:32:00.9343412+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:00.9344573+05:30 80000035-0006-ff00-b63f-84710c7967bb [INF] Request finished in 98.0159ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.1646627+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:01.1647069+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.1647668+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.1648240+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.1660469+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:01.1682376+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.1703615+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.1728330+05:30 8000005f-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:01.1729206+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:01.1729241+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:01.1731330+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 8.2734ms (afa2e885)
2021-09-22T19:32:01.1731874+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.1760617+05:30 8000005f-0002-fb00-b63f-84710c7967bb [INF] Request finished in 11.3561ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:01.2577157+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:01.2578097+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.2579304+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:01.2580178+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.2580511+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.2580933+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.2581685+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.2582605+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.2592355+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.2594704+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:01.2595574+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.2605794+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.3383ms (afa2e885)
2021-09-22T19:32:01.2606459+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.2607331+05:30 8000007e-0004-fc00-b63f-84710c7967bb [INF] Request finished in 3.1335ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.2627386+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.2644193+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.2647601+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:01.2652066+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 6.8751ms (afa2e885)
2021-09-22T19:32:01.2652751+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.2653663+05:30 8000002c-0004-fa00-b63f-84710c7967bb [INF] Request finished in 7.7261ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.5128528+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:01.5130855+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.5133521+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.5137095+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.5199022+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:01.5220013+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:01.5221418+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.5223227+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.5223229+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:01.5224174+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.5225523+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.5226066+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.5228186+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.5247404+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.5274679+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.5296147+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.5307094+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.5310493+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:01.5312057+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.5315897+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 8.8946ms (afa2e885)
2021-09-22T19:32:01.5316780+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.5317780+05:30 8000000a-0003-fa00-b63f-84710c7967bb [INF] Request finished in 9.8722ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.5341513+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.5344196+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:01.5348846+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.9553ms (afa2e885)
2021-09-22T19:32:01.5349787+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.5350851+05:30 80000037-0006-ff00-b63f-84710c7967bb [INF] Request finished in 12.7995ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.5383272+05:30 80000061-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:01.5384806+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:01.5385358+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:01.5389087+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.0629ms (afa2e885)
2021-09-22T19:32:01.5390101+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.5441214+05:30 80000061-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459360"", Request ID ""80000061-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:32:01.5442430+05:30 80000061-0002-fb00-b63f-84710c7967bb [INF] Request finished in 31.7079ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:01.5458292+05:30 80000061-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:32:01.8417441+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:01.8418011+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.8418689+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.8419392+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.8467707+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:01.8502308+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:01.8501297+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:01.8503625+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.8503790+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:01.8504547+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.8504968+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:01.8505344+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.8505560+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:01.8512474+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.8519272+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:32:01.8526114+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.8526529+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.8527750+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:01.8530580+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.4668ms (afa2e885)
2021-09-22T19:32:01.8530960+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.8531747+05:30 8000003f-0005-fe00-b63f-84710c7967bb [INF] Request finished in 3.1215ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.8535467+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:01.8544757+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:01.8545956+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:01.8547567+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:01.8550527+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 4.4524ms (afa2e885)
2021-09-22T19:32:01.8550983+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.8553037+05:30 8000003a-0001-ff00-b63f-84710c7967bb [INF] Request finished in 5.2718ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:01.8582348+05:30 80000058-0000-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:01.8582747+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:01.8583196+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:01.8585339+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.5423ms (afa2e885)
2021-09-22T19:32:01.8585691+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:01.8605141+05:30 80000058-0000-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:32:02.2057516+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:02.2059460+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.2061388+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.2064080+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.2225828+05:30 8000003c-0001-ff00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:32:02.2242645+05:30 8000003c-0001-ff00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
2021-09-22T19:32:02.2269113+05:30 80000058-0000-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456105130524759"", Request ID ""80000058-0000-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:32:02.2270786+05:30 80000058-0000-fb00-b63f-84710c7967bb [INF] Request finished in 386.1482ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:02.2273113+05:30 8000000c-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:02.2274618+05:30 80000004-0003-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:32:02.2275881+05:30 80000004-0003-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.2277675+05:30 8000000c-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.2279913+05:30 80000004-0003-f900-b63f-84710c7967bb [INF] Request finished in 0.5673ms 204  (791a596a)
2021-09-22T19:32:02.2280272+05:30 8000000c-0003-fa00-b63f-84710c7967bb [INF] Request finished in 0.744ms 204  (791a596a)
2021-09-22T19:32:02.2588263+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:02.2588503+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:02.2597440+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.2597336+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.2598833+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.2600356+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.2856120+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.2870578+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.2875066+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:02.2877753+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:32:02.2934182+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 33.2659ms (afa2e885)
2021-09-22T19:32:02.2935192+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:02.2936585+05:30 8000000e-0003-fa00-b63f-84710c7967bb [INF] Request finished in 34.8784ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:02.2943739+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:32:02.2945728+05:30 8000003c-0001-ff00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:32:02.2949343+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:32:02.2956080+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 89.0602ms (afa2e885)
2021-09-22T19:32:02.2956908+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:02.2957281+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:02.2958034+05:30 8000003c-0001-ff00-b63f-84710c7967bb [INF] Request finished in 90.1819ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:32:02.2990895+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:02.3041046+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:02.3044403+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:02.3050140+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.8315ms (afa2e885)
2021-09-22T19:32:02.3050908+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:02.3052429+05:30 80000066-0000-f900-b63f-84710c7967bb [INF] Request finished in 46.4234ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:02.6045833+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:32:02.6046275+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.6046921+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.6047663+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.6105593+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:32:02.6133170+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:02.6143834+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:32:02.6170005+05:30 8000002e-0004-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:32:02.6170334+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:32:02.6170980+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:32:02.6173613+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.5414ms (afa2e885)
2021-09-22T19:32:02.6173976+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:02.6199393+05:30 8000002e-0004-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:32:02.7646540+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:32:02.7647447+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.7647894+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:32:02.7648295+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:32:02.7648532+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.7649047+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:32:02.7649840+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.7649919+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:32:02.7661752+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:02.7677456+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:32:02.7686574+05:30 8000002e-0004-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398528272465965"", Request ID ""8000002e-0004-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:32:02.7687514+05:30 8000002e-0004-fa00-b63f-84710c7967bb [INF] Request finished in 164.1724ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:32:02.7704286+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:32:02.7706689+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:32:02.7710517+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.9863ms (afa2e885)
2021-09-22T19:32:02.7711134+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:02.7711894+05:30 80000010-0003-fa00-b63f-84710c7967bb [INF] Request finished in 6.6248ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:32:32.7997018+05:30 80000039-0006-ff00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,016"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T19:32:32.8040243+05:30 80000039-0006-ff00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 127
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11
2021-09-22T19:32:35.3005447+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 32460.4225ms (afa2e885)
2021-09-22T19:32:35.3007818+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:32:35.3028359+05:30 80000039-0006-ff00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 127
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 43
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:98554cfc-4e74-420e-bb0f-652c05974d6a
Error Number:-2,State:0,Class:11
2021-09-22T19:32:35.3053748+05:30 80000039-0006-ff00-b63f-84710c7967bb [INF] Request finished in 32465.4114ms 500 text/plain (791a596a)
2021-09-22T19:33:41.9476179+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-22T19:33:42.1124106+05:30 80000024-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-22T19:33:42.1732663+05:30 80000024-0007-ff00-b63f-84710c7967bb [INF] Request finished in 62.6576ms 404  (791a596a)
2021-09-22T19:33:46.7603564+05:30 80000002-0004-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:33:46.7607027+05:30 80000002-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:33:46.7603577+05:30 80000002-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:46.7715721+05:30 80000002-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.7715720+05:30 80000002-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.7715721+05:30 80000002-0004-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.7750852+05:30 80000002-0004-f900-b63f-84710c7967bb [INF] Request finished in 19.1ms 204  (791a596a)
2021-09-22T19:33:46.7750852+05:30 80000002-0004-f800-b63f-84710c7967bb [INF] Request finished in 19.0579ms 204  (791a596a)
2021-09-22T19:33:46.7750852+05:30 80000002-0004-f700-b63f-84710c7967bb [INF] Request finished in 15.3864ms 204  (791a596a)
2021-09-22T19:33:46.7804876+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:33:46.7804861+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:46.7810533+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.7810539+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.7899472+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:46.7901037+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:46.8045660+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:46.8045660+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:46.8045660+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:46.8762372+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:46.8762616+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllDeviceCapability\", controller = \"Admin\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetAllDeviceCapability(System.String)" on controller "IoT.WebAPI.Controllers.AdminController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:46.8762329+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:48.0613039+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:48.0612990+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:48.0612989+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:48.9400310+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("43"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [UserPermission] AS [u]
WHERE ([u].[UserKey] = @__userKey_0) AND ([u].[IsAdmin] = CAST(1 AS bit))" (0723d8ff)
2021-09-22T19:33:48.9400085+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("43"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:48.9400256+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("39"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.0039545+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:49.0196315+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceCapabilityId], [d].[CapabilityInterface], [d].[CapabilityType], [d].[CreatedDate], [d].[DeviceTypeId], [d].[Modifieddate], [d].[ProactivelyReported], [d].[Retrievable], [d].[SupportedProperty], [d].[Varsion], [d0].[DeviceTypeId], [d0].[CreatedDate], [d0].[DeviceTypeName], [d0].[ModifiedDate]
FROM [DeviceCapability] AS [d]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
ORDER BY [d].[CapabilityType]" (0723d8ff)
2021-09-22T19:33:49.0201433+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.DeviceCapability, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:33:49.0344961+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)" in 2150.3548ms (afa2e885)
2021-09-22T19:33:49.0345285+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2150.346ms (afa2e885)
2021-09-22T19:33:49.0346133+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.0346124+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.0423575+05:30 80000068-0000-f900-b63f-84710c7967bb [INF] Request finished in 2261.4745ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.0423575+05:30 8000001c-0006-fc00-b63f-84710c7967bb [INF] Request finished in 2261.4752ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.0870403+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.1134390+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.1166601+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:49.1285911+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 2251.4465ms (afa2e885)
2021-09-22T19:33:49.1288032+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.1384865+05:30 8000000d-0003-fb00-b63f-84710c7967bb [INF] Request finished in 2357.4798ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.1763916+05:30 80000026-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T19:33:49.1765130+05:30 80000026-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.1773438+05:30 80000026-0007-ff00-b63f-84710c7967bb [INF] Request finished in 1.0034ms 204  (791a596a)
2021-09-22T19:33:49.1803739+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:49.1805608+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.1809205+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:49.1810678+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.1831597+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:49.1832614+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.1854803+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.1875799+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.1877568+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.1877680+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.1880558+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.1895550+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.1964294+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.1964295+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.1970795+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:49.1975968+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.8514ms (afa2e885)
2021-09-22T19:33:49.1976940+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.1978817+05:30 8000003e-0001-ff00-b63f-84710c7967bb [INF] Request finished in 17.0381ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.2008758+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.2046211+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.2049508+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:49.2054182+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.2293ms (afa2e885)
2021-09-22T19:33:49.2055018+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.2056219+05:30 80000063-0002-fb00-b63f-84710c7967bb [INF] Request finished in 25.42ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.2180788+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:49.2497114+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.2576091+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.3175856+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:49.3240246+05:30 8000006a-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:49.3243201+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:49.3261603+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 138.4444ms (afa2e885)
2021-09-22T19:33:49.3262394+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.3820529+05:30 8000006a-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668905"", Request ID ""8000006a-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:33:49.3823097+05:30 8000006a-0000-f900-b63f-84710c7967bb [INF] Request finished in 199.0383ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:49.3823550+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:49.3827536+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.3830467+05:30 8000006a-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:33:49.3850728+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.3853962+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.3870206+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:49.3871597+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.3873628+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.3875052+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:49.3875140+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.3875661+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.3876565+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.3877627+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.3879290+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:49.3885491+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.3888050+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:49.3892861+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 1.6664ms (afa2e885)
2021-09-22T19:33:49.3893616+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.3894738+05:30 8000000f-0003-fb00-b63f-84710c7967bb [INF] Request finished in 2.5317ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.3942937+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.3956313+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.4016981+05:30 80000065-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:49.4018726+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:49.4025769+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.9712ms (afa2e885)
2021-09-22T19:33:49.4026642+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.4056430+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:49.4065864+05:30 80000065-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459364"", Request ID ""80000065-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:33:49.4067663+05:30 80000065-0002-fb00-b63f-84710c7967bb [INF] Request finished in 24.4496ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:49.4125976+05:30 80000065-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:33:49.4365876+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:49.4391198+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.4408518+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.4429685+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.4433769+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:49.4437975+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 55.9361ms (afa2e885)
2021-09-22T19:33:49.4438570+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.4439841+05:30 8000001e-0006-fc00-b63f-84710c7967bb [INF] Request finished in 56.4995ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.7006352+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:49.7020280+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.7028657+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.7040669+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.7139381+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:49.7303176+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.7345420+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.7439144+05:30 8000006c-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:49.7441730+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:49.7444398+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:49.7460261+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 41.4565ms (afa2e885)
2021-09-22T19:33:49.7462020+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.7472965+05:30 8000006c-0000-f900-b63f-84710c7967bb [INF] Request finished in 46.6173ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:49.7691842+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:49.7691852+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:49.7693863+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.7693885+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:49.7696596+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.7698647+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:49.7699073+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.7701005+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:49.7720239+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:49.7720239+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.7726024+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:49.7796775+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 9.3801ms (afa2e885)
2021-09-22T19:33:49.7798322+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.7800858+05:30 80000028-0007-ff00-b63f-84710c7967bb [INF] Request finished in 11.0913ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:49.7890600+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:49.7920699+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:49.7952750+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:49.7964883+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 26.4053ms (afa2e885)
2021-09-22T19:33:49.7966381+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:49.7968990+05:30 80000067-0002-fb00-b63f-84710c7967bb [INF] Request finished in 27.9194ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.0791848+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:50.0809594+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.0839026+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.0866959+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.1042760+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:50.1226658+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:50.1226758+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:50.1232639+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.1233027+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.1243180+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.1243208+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.1254984+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.1255046+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.1284148+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.1288693+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:50.1298346+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:50.1312885+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.1338265+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.9887ms (afa2e885)
2021-09-22T19:33:50.1338534+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.1340026+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.1345433+05:30 8000006e-0000-f900-b63f-84710c7967bb [INF] Request finished in 12.311ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.1350632+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.1379592+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.1379940+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.1384983+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:50.1392982+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.6295ms (afa2e885)
2021-09-22T19:33:50.1394497+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.1397851+05:30 80000040-0001-ff00-b63f-84710c7967bb [INF] Request finished in 17.6132ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.1500376+05:30 80000069-0002-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:50.1502940+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:50.1503646+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:50.1510702+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 62.8385ms (afa2e885)
2021-09-22T19:33:50.1511746+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.1817386+05:30 80000069-0002-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456113720459368"", Request ID ""80000069-0002-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:33:50.1820276+05:30 80000069-0002-fb00-b63f-84710c7967bb [INF] Request finished in 103.4037ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:50.1875919+05:30 80000069-0002-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:33:50.4525511+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:50.4530763+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.4540287+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.4551857+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.4613976+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:50.4717246+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.4752826+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:50.4752820+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:50.4758456+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.4759647+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.4767011+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.4769734+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.4773832+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.4777215+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.4824126+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.4836219+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:50.4846642+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.4874365+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.4888940+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:50.4915819+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 13.1104ms (afa2e885)
2021-09-22T19:33:50.4920315+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.4923797+05:30 80000004-0004-f700-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:50.4927475+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.4929917+05:30 80000004-0004-f800-b63f-84710c7967bb [INF] Request finished in 17.8197ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.4935857+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:50.4938730+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:50.4949029+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 39.2318ms (afa2e885)
2021-09-22T19:33:50.4952436+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.4978019+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.4985627+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:50.4995884+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.9902ms (afa2e885)
2021-09-22T19:33:50.4996682+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.4997461+05:30 80000004-0004-f700-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:33:50.5000062+05:30 80000020-0006-fc00-b63f-84710c7967bb [INF] Request finished in 25.0022ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.7173630+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:50.7185969+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.7201889+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.7214302+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.7238743+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:50.7240948+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.7243776+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.7255610+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.7259330+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:50.7261484+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.7281655+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.7285518+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.7312542+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.7330450+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:33:50.7351059+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.7352503+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.7356293+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:50.7362305+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.1133ms (afa2e885)
2021-09-22T19:33:50.7363276+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.7366973+05:30 80000002-0001-fd00-b63f-84710c7967bb [INF] Request finished in 10.7255ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.7412175+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.7417890+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:50.7424643+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 16.6995ms (afa2e885)
2021-09-22T19:33:50.7425664+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.7427174+05:30 80000002-0001-fe00-b63f-84710c7967bb [INF] Request finished in 19.0384ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.7445992+05:30 80000004-0004-f700-b63f-84710c7967bb [ERR] Connection ID ""17798225746158682115"", Request ID ""80000004-0004-f700-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:33:50.7447731+05:30 80000004-0004-f700-b63f-84710c7967bb [INF] Request finished in 292.4441ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:50.7517728+05:30 80000042-0001-ff00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("18"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:33:50.7558847+05:30 80000042-0001-ff00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T19:33:50.8823989+05:30 80000042-0001-ff00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:33:50.8831187+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:33:50.8886716+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 166.9494ms (afa2e885)
2021-09-22T19:33:50.8887464+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.8888490+05:30 80000042-0001-ff00-b63f-84710c7967bb [INF] Request finished in 171.8233ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.9842796+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:50.9843523+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.9844477+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.9845446+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.9866808+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:33:50.9880770+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:50.9880772+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:50.9881634+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.9881630+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:50.9882855+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.9883415+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:50.9883952+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.9884247+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:50.9892631+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:50.9892637+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.9894622+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:33:50.9897990+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 1.3437ms (afa2e885)
2021-09-22T19:33:50.9898533+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.9899334+05:30 80000070-0000-f900-b63f-84710c7967bb [INF] Request finished in 1.9026ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.9905487+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.9931236+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:33:50.9934290+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:33:50.9937243+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:33:50.9941365+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.6386ms (afa2e885)
2021-09-22T19:33:50.9941956+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:50.9943191+05:30 80000006-0004-f700-b63f-84710c7967bb [INF] Request finished in 6.2701ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:33:50.9949704+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:33:51.0003968+05:30 80000011-0003-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:33:51.0005233+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:33:51.0005513+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:33:51.0009754+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.3629ms (afa2e885)
2021-09-22T19:33:51.0010430+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:33:51.0023553+05:30 80000011-0003-fb00-b63f-84710c7967bb [INF] Request finished in 18.0326ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:33:51.3830502+05:30 80000041-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:33:51.3834642+05:30 80000041-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:51.3839575+05:30 80000041-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:51.3843303+05:30 80000041-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:51.3858030+05:30 80000008-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:33:51.3858037+05:30 80000013-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:33:51.3858770+05:30 80000008-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:51.3858783+05:30 80000013-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:33:51.3859783+05:30 80000013-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:51.3860822+05:30 80000008-0004-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:33:51.3860780+05:30 80000013-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:51.3861404+05:30 80000008-0004-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.UserPermission GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:33:51.3882906+05:30 80000008-0004-f700-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: A second operation was started on this context before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: A second operation was started on this context before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T19:33:51.4061081+05:30 80000013-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:09.5708065+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-22T19:42:09.6823257+05:30 80000072-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-22T19:42:09.7451324+05:30 80000072-0000-f900-b63f-84710c7967bb [INF] Request finished in 65.1729ms 404  (791a596a)
2021-09-22T19:42:19.7328051+05:30 8000002a-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:42:19.7327800+05:30 8000007e-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:19.7331852+05:30 8000006b-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:42:19.7555362+05:30 8000002a-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.7555362+05:30 8000006b-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.7555362+05:30 8000007e-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.7633600+05:30 8000006b-0002-fb00-b63f-84710c7967bb [INF] Request finished in 33.1634ms 204  (791a596a)
2021-09-22T19:42:19.7633601+05:30 8000007e-0002-fa00-b63f-84710c7967bb [INF] Request finished in 32.9169ms 204  (791a596a)
2021-09-22T19:42:19.7635849+05:30 8000002a-0007-ff00-b63f-84710c7967bb [INF] Request finished in 32.9256ms 204  (791a596a)
2021-09-22T19:42:19.7735053+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:42:19.7735087+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:19.7746322+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.7746321+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.7846724+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:19.7849700+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:19.8134500+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:19.8134500+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:19.8134501+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:19.9528214+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllDeviceCapability\", controller = \"Admin\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetAllDeviceCapability(System.String)" on controller "IoT.WebAPI.Controllers.AdminController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:19.9528393+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:19.9528577+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:21.5601367+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:21.5601367+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:21.5601473+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:22.9184383+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("90"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:22.9184269+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("104"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:22.9184995+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("104"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [UserPermission] AS [u]
WHERE ([u].[UserKey] = @__userKey_0) AND ([u].[IsAdmin] = CAST(1 AS bit))" (0723d8ff)
2021-09-22T19:42:23.0785246+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:23.1202701+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceCapabilityId], [d].[CapabilityInterface], [d].[CapabilityType], [d].[CreatedDate], [d].[DeviceTypeId], [d].[Modifieddate], [d].[ProactivelyReported], [d].[Retrievable], [d].[SupportedProperty], [d].[Varsion], [d0].[DeviceTypeId], [d0].[CreatedDate], [d0].[DeviceTypeName], [d0].[ModifiedDate]
FROM [DeviceCapability] AS [d]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
ORDER BY [d].[CapabilityType]" (0723d8ff)
2021-09-22T19:42:23.1214023+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.DeviceCapability, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:42:23.1504120+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3184.9443ms (afa2e885)
2021-09-22T19:42:23.1504120+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)" in 3183.2447ms (afa2e885)
2021-09-22T19:42:23.1506311+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.1516874+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.1712104+05:30 80000015-0003-fb00-b63f-84710c7967bb [INF] Request finished in 3397.7277ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.1712104+05:30 8000006d-0002-fb00-b63f-84710c7967bb [INF] Request finished in 3397.8954ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.2434963+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.2720995+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:23.2744751+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:42:23.2867697+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 3332.9807ms (afa2e885)
2021-09-22T19:42:23.2869559+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.2962309+05:30 80000080-0002-fa00-b63f-84710c7967bb [INF] Request finished in 3522.826ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.3231505+05:30 8000003c-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T19:42:23.3232459+05:30 8000003c-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.3234494+05:30 8000003c-0006-ff00-b63f-84710c7967bb [INF] Request finished in 0.3187ms 204  (791a596a)
2021-09-22T19:42:23.3270384+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:42:23.3271360+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.3317078+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.3364967+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.3388572+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:23.3389622+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.3390358+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:23.3391330+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.3428872+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.3428872+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.3444503+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.3484464+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.3548902+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:23.3574688+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:23.3594235+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:23.3602809+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.5915ms (afa2e885)
2021-09-22T19:42:23.3604484+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.3606914+05:30 80000017-0003-fb00-b63f-84710c7967bb [INF] Request finished in 21.8588ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.3605939+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.3651098+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:23.3656622+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:42:23.3662104+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.6012ms (afa2e885)
2021-09-22T19:42:23.3663167+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.3664884+05:30 8000001b-0003-fc00-b63f-84710c7967bb [INF] Request finished in 27.6412ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.3747492+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:42:23.4436361+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.4625652+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:23.5573811+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:42:23.5754871+05:30 80000082-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:42:23.5760188+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:42:23.5808455+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 244.1322ms (afa2e885)
2021-09-22T19:42:23.5809968+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.6069402+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:42:23.6094946+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.6096517+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:23.6096520+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:23.6097014+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.6097073+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.6098033+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.6165582+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.6165928+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.6167923+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.6186011+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.6195006+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.6194931+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:23.6222642+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:23.6233152+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:23.6357591+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 18.7324ms (afa2e885)
2021-09-22T19:42:23.6359918+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.6363391+05:30 8000006f-0002-fb00-b63f-84710c7967bb [INF] Request finished in 26.6696ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.6404873+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.6439129+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:23.6463888+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:42:23.6470811+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 30.3061ms (afa2e885)
2021-09-22T19:42:23.6472073+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.6473727+05:30 80000043-0005-fe00-b63f-84710c7967bb [INF] Request finished in 37.7096ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:23.6736005+05:30 80000082-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T19:42:23.6752833+05:30 80000082-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531457"", Request ID ""80000082-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:42:23.6756038+05:30 80000082-0002-fa00-b63f-84710c7967bb [INF] Request finished in 348.6257ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:42:23.6912352+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:23.6941193+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:42:23.7025431+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.7058966+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:23.7142133+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:42:23.7143680+05:30 8000003e-0006-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:42:23.7145912+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:42:23.7152607+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 95.6126ms (afa2e885)
2021-09-22T19:42:23.7154251+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.7223383+05:30 8000003e-0006-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686507052040253"", Request ID ""8000003e-0006-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:42:23.7225911+05:30 8000003e-0006-ff00-b63f-84710c7967bb [INF] Request finished in 115.629ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:42:23.7261419+05:30 8000003e-0006-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:42:23.8801900+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:42:23.8804046+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:23.8806833+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:23.8811263+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:23.8897789+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:42:23.9221136+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:23.9278134+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:23.9357879+05:30 8000000a-0004-f700-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:42:23.9361431+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:42:23.9367115+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:42:23.9382610+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 56.7918ms (afa2e885)
2021-09-22T19:42:23.9384160+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:23.9389296+05:30 8000000a-0004-f700-b63f-84710c7967bb [INF] Request finished in 58.7592ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:42:24.0868219+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:24.0868219+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:24.0871340+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.0871340+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.0875768+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.0875809+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.0880131+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.0880132+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.0900559+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:24.0904693+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:24.0925077+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:24.0935051+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:24.0935444+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.4369ms (afa2e885)
2021-09-22T19:42:24.0936567+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.0939488+05:30 80000084-0002-fa00-b63f-84710c7967bb [INF] Request finished in 7.2247ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:24.0973839+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:24.0977480+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:42:24.0983002+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.1666ms (afa2e885)
2021-09-22T19:42:24.0983856+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.0985245+05:30 8000002c-0007-ff00-b63f-84710c7967bb [INF] Request finished in 11.8639ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:24.4183098+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:42:24.4194129+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.4197648+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:24.4198842+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.4200397+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.4200467+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.4201624+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:24.4202217+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.4204624+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.4204597+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.4204914+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.4205984+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.4232502+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:24.4279344+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:42:24.4282640+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:24.4290205+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:24.4326155+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:24.4345123+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 13.6936ms (afa2e885)
2021-09-22T19:42:24.4346693+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.4347860+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:24.4351487+05:30 80000004-0001-fd00-b63f-84710c7967bb [INF] Request finished in 14.9564ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:24.4367746+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:42:24.4371891+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:24.4371984+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:42:24.4377725+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.1911ms (afa2e885)
2021-09-22T19:42:24.4378878+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.4381015+05:30 8000005a-0000-fb00-b63f-84710c7967bb [INF] Request finished in 18.3561ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:24.4391520+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:24.4431901+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:42:24.4432881+05:30 8000001d-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:42:24.4435155+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:42:24.4442247+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.6392ms (afa2e885)
2021-09-22T19:42:24.4443469+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.4481552+05:30 8000001d-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:42:24.6468324+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:42:24.6486465+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.6518672+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.6540096+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:42:24.6544947+05:30 80000009-0003-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:42:24.6564378+05:30 80000009-0003-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.6564353+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:42:24.6566552+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.6619742+05:30 80000009-0003-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.6622908+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:42:24.6659793+05:30 80000009-0003-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.6660250+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:42:24.6795906+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:42:24.6904355+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:24.6904361+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:42:24.6945087+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:42:24.6971218+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30.2234ms (afa2e885)
2021-09-22T19:42:24.6973785+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.6980176+05:30 80000019-0003-fb00-b63f-84710c7967bb [INF] Request finished in 45.752ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:42:24.6988214+05:30 8000001d-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354524"", Request ID ""8000001d-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:42:24.6990080+05:30 8000001d-0003-fc00-b63f-84710c7967bb [INF] Request finished in 281.0223ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:42:24.7029550+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:42:24.7075574+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:42:24.7131559+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:42:24.7131961+05:30 80000086-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:42:24.7134015+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:42:24.7139916+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 56.3942ms (afa2e885)
2021-09-22T19:42:24.7141079+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:42:24.7187034+05:30 80000086-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:42:39.7285746+05:30 80000086-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531461"", Request ID ""80000086-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
ClientConnectionId:dc7d8777-18c0-4871-8de3-126da0642a18
Error Number:-2,State:0,Class:11
2021-09-22T19:42:39.7289797+05:30 80000086-0002-fa00-b63f-84710c7967bb [INF] Request finished in 15083.2226ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:42:54.6965908+05:30 80000009-0003-fd00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,007"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T19:54:32.0725221+05:30  [INF] User profile is available. Using '"C:\Users\satishsonkar\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest. (7ac5e29c)
2021-09-22T19:54:32.1929218+05:30 80000045-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/   (ca22a1cb)
2021-09-22T19:54:32.2599846+05:30 80000045-0001-ff00-b63f-84710c7967bb [INF] Request finished in 75.1731ms 404  (791a596a)
2021-09-22T19:54:43.1589438+05:30 80000047-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:54:43.1594431+05:30 80000031-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:54:43.1621158+05:30 8000000c-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:43.1855154+05:30 80000031-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.1854881+05:30 8000000c-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.1854881+05:30 80000047-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.1930616+05:30 8000000c-0004-f700-b63f-84710c7967bb [INF] Request finished in 35.8792ms 204  (791a596a)
2021-09-22T19:54:43.1930616+05:30 80000031-0004-fa00-b63f-84710c7967bb [INF] Request finished in 35.8752ms 204  (791a596a)
2021-09-22T19:54:43.1930866+05:30 80000047-0001-ff00-b63f-84710c7967bb [INF] Request finished in 36.4929ms 204  (791a596a)
2021-09-22T19:54:43.2216411+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:43.2216418+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/admin/getAllDeviceCapability   (ca22a1cb)
2021-09-22T19:54:43.2224025+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.2224174+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.2251326+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:43.2253117+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:43.2467862+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:43.2467995+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:43.2467988+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:43.3782584+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:43.3782584+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:43.3782669+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetAllDeviceCapability\", controller = \"Admin\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetAllDeviceCapability(System.String)" on controller "IoT.WebAPI.Controllers.AdminController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:45.6267043+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:45.6267096+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:45.6267151+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:46.9819433+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("85"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:46.9819586+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("100"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [UserPermission] AS [u]
WHERE ([u].[UserKey] = @__userKey_0) AND ([u].[IsAdmin] = CAST(1 AS bit))" (0723d8ff)
2021-09-22T19:54:46.9819708+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("100"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:47.1677644+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:47.2003932+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("13"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceCapabilityId], [d].[CapabilityInterface], [d].[CapabilityType], [d].[CreatedDate], [d].[DeviceTypeId], [d].[Modifieddate], [d].[ProactivelyReported], [d].[Retrievable], [d].[SupportedProperty], [d].[Varsion], [d0].[DeviceTypeId], [d0].[CreatedDate], [d0].[DeviceTypeName], [d0].[ModifiedDate]
FROM [DeviceCapability] AS [d]
INNER JOIN [DeviceType] AS [d0] ON [d].[DeviceTypeId] = [d0].[DeviceTypeId]
ORDER BY [d].[CapabilityType]" (0723d8ff)
2021-09-22T19:54:47.2015120+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[IoT.DataLayer.Models.DeviceCapability, IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T19:54:47.2351739+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3847.0542ms (afa2e885)
2021-09-22T19:54:47.2351739+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)" in 3839.966ms (afa2e885)
2021-09-22T19:54:47.2353413+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.AdminController.GetAllDeviceCapability (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.2361565+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.2562531+05:30 8000000b-0003-fd00-b63f-84710c7967bb [INF] Request finished in 4034.8205ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:47.2562532+05:30 8000001b-0003-fb00-b63f-84710c7967bb [INF] Request finished in 4034.8115ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:47.3726314+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:47.4033367+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:47.4069345+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:47.4192482+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 4039.977ms (afa2e885)
2021-09-22T19:54:47.4194213+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.4254441+05:30 8000001f-0003-fc00-b63f-84710c7967bb [INF] Request finished in 4203.9948ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:47.4490718+05:30 80000049-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T19:54:47.4492488+05:30 80000049-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:47.4498295+05:30 80000049-0001-ff00-b63f-84710c7967bb [INF] Request finished in 0.7914ms 204  (791a596a)
2021-09-22T19:54:47.4522258+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:47.4523744+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:47.4526013+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:47.4526915+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:47.4549924+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:47.4551087+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:47.4556632+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:47.4588309+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:47.4593219+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:47.4593219+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:47.4616088+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:47.4647045+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:47.4702294+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:47.4735923+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:47.4742173+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:47.4749548+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 10.084ms (afa2e885)
2021-09-22T19:54:47.4750414+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:47.4751090+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.4753985+05:30 8000004b-0001-ff00-b63f-84710c7967bb [INF] Request finished in 22.8298ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:47.4785475+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:47.4790063+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:47.4794263+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.6896ms (afa2e885)
2021-09-22T19:54:47.4795066+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.4796225+05:30 80000033-0004-fa00-b63f-84710c7967bb [INF] Request finished in 27.6405ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:47.4882767+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:47.5589637+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:47.5749992+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:47.6861960+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:47.7036496+05:30 80000075-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:47.7041259+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:47.7087704+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 249.7385ms (afa2e885)
2021-09-22T19:54:47.7089405+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:47.8248685+05:30 80000075-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668916"", Request ID ""80000075-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:54:47.8250846+05:30 80000075-0000-f900-b63f-84710c7967bb [INF] Request finished in 370.1685ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:47.8260701+05:30 80000075-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:54:48.0054354+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:48.0055901+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.0069506+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.0074017+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.0096255+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:48.0149584+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.0177503+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.0220805+05:30 80000009-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:48.0221751+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:48.0222633+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:48.0227610+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 15.2122ms (afa2e885)
2021-09-22T19:54:48.0228484+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.0264169+05:30 80000009-0006-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571318976184328"", Request ID ""80000009-0006-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:54:48.0265962+05:30 80000009-0006-fd00-b63f-84710c7967bb [INF] Request finished in 21.2574ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:48.0311481+05:30 80000009-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:54:48.1565345+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:48.1566877+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.1569273+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.1569867+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:48.1570681+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.1571613+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.1572245+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.1573262+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.1596063+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.1669581+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.1696597+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.1718381+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:48.1723433+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15.0861ms (afa2e885)
2021-09-22T19:54:48.1724893+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.1726399+05:30 80000088-0002-fa00-b63f-84710c7967bb [INF] Request finished in 16.3804ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.2011700+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:48.2032500+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.2044442+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:48.2048852+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 47.4325ms (afa2e885)
2021-09-22T19:54:48.2050061+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.2053032+05:30 8000000a-0005-fd00-b63f-84710c7967bb [INF] Request finished in 48.2117ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.3733283+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:48.3742441+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.3749080+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.3755407+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.3759491+05:30 80000071-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:48.3759491+05:30 80000035-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T19:54:48.3760172+05:30 80000035-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.3760172+05:30 80000071-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.3765264+05:30 80000071-0002-fb00-b63f-84710c7967bb [INF] Request finished in 0.6318ms 204  (791a596a)
2021-09-22T19:54:48.3765264+05:30 80000035-0004-fa00-b63f-84710c7967bb [INF] Request finished in 0.6318ms 204  (791a596a)
2021-09-22T19:54:48.3824448+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:48.3824446+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:48.3825669+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.3825686+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.3828413+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.3829754+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.3830381+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.3831150+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.3848511+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:48.3850650+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:48.3850656+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.3914259+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.3945998+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.3947675+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:48.3964262+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 12.8781ms (afa2e885)
2021-09-22T19:54:48.3966016+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.3980567+05:30 80000004-0006-fb00-b63f-84710c7967bb [INF] Request finished in 15.6374ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.3994746+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.4001674+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:48.4010050+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.8432ms (afa2e885)
2021-09-22T19:54:48.4011197+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.4012744+05:30 8000000b-0006-fd00-b63f-84710c7967bb [INF] Request finished in 18.8345ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.4048881+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.4067880+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.4154043+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:48.4154521+05:30 8000008a-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:48.4156806+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:48.4165505+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 40.8267ms (afa2e885)
2021-09-22T19:54:48.4166577+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.4222050+05:30 8000008a-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T19:54:48.5763607+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:48.5766041+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.5768745+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.5770992+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.5815696+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:48.5815526+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:48.5816867+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.5816857+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.5818502+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.5818466+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.5820399+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.5820314+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.5832095+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:48.5863333+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.5888520+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.5888854+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:48.5900806+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.7841ms (afa2e885)
2021-09-22T19:54:48.5903921+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.5907457+05:30 8000000c-0005-fd00-b63f-84710c7967bb [INF] Request finished in 9.1722ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.5923362+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.5934412+05:30 8000008a-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531465"", Request ID ""8000008a-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:54:48.5936596+05:30 8000008a-0002-fa00-b63f-84710c7967bb [INF] Request finished in 220.893ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:48.5990704+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.5999069+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:48.6006525+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 18.4887ms (afa2e885)
2021-09-22T19:54:48.6007485+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.6009679+05:30 8000004d-0001-ff00-b63f-84710c7967bb [INF] Request finished in 19.4837ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.6052480+05:30 8000000d-0006-fd00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("22"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:54:48.6099228+05:30 8000000d-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T19:54:48.7243799+05:30 8000000d-0006-fd00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:54:48.7255496+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:54:48.7316103+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 154.3542ms (afa2e885)
2021-09-22T19:54:48.7317194+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.7319400+05:30 8000000d-0006-fd00-b63f-84710c7967bb [INF] Request finished in 155.6853ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.8655450+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:48.8656588+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.8659165+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.8660983+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.8694839+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:48.8694842+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:48.8696077+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.8697485+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:48.8697589+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:48.8697859+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.8698786+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:48.8700437+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.8700461+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:48.8734335+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.8739422+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:48.8744606+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.3338ms (afa2e885)
2021-09-22T19:54:48.8745524+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.8748876+05:30 80000037-0004-fa00-b63f-84710c7967bb [INF] Request finished in 5.3642ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.8778421+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.8789705+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.8806834+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:48.8806834+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:48.8823726+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:48.8828745+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:48.8834106+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.2528ms (afa2e885)
2021-09-22T19:54:48.8834965+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.8837062+05:30 8000000e-0005-fd00-b63f-84710c7967bb [INF] Request finished in 14.2541ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:48.8862519+05:30 8000008c-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:48.8865083+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:48.8873286+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 21.0688ms (afa2e885)
2021-09-22T19:54:48.8874395+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:48.8883369+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:48.8910717+05:30 8000008c-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531467"", Request ID ""8000008c-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:54:48.8912035+05:30 8000008c-0002-fa00-b63f-84710c7967bb [INF] Request finished in 25.7164ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:48.8930251+05:30 8000008c-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:54:49.0853215+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:49.0858138+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.0869021+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.0877902+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.0953872+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:49.1087511+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:49.1087511+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:49.1091919+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.1091919+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.1097277+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.1097275+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.1103026+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.1103019+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.1123936+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:49.1135566+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:49.1152421+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.1152422+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:49.1166742+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:49.1172784+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:49.1176629+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:49.1183066+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.7015ms (afa2e885)
2021-09-22T19:54:49.1184316+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.1187648+05:30 80000002-0005-fc00-b63f-84710c7967bb [INF] Request finished in 10.4075ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.1192558+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.1196290+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:49.1201023+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 9.2696ms (afa2e885)
2021-09-22T19:54:49.1201689+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.1203259+05:30 80000010-0005-fd00-b63f-84710c7967bb [INF] Request finished in 12.0845ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.1246353+05:30 80000021-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:49.1246382+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:49.1247997+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:49.1253188+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 37.3224ms (afa2e885)
2021-09-22T19:54:49.1253868+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.1302345+05:30 80000021-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T19:54:49.2954641+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:49.2956103+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.2957843+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.2959999+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.3024716+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:49.3023334+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:49.3027585+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.3027576+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.3030779+05:30 8000002e-0007-ff00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:54:49.3032222+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.3035637+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.3037911+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.3040212+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.3053747+05:30 8000002e-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
2021-09-22T19:54:49.3402038+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T19:54:49.3421561+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("34"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:49.3789326+05:30 80000021-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354528"", Request ID ""80000021-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T19:54:49.3795264+05:30 80000021-0003-fc00-b63f-84710c7967bb [INF] Request finished in 294.1718ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:49.3822422+05:30 8000002e-0007-ff00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:54:49.3830668+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:54:49.3830732+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.3832422+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:49.3838828+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 87.7614ms (afa2e885)
2021-09-22T19:54:49.3839466+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 80.2608ms (afa2e885)
2021-09-22T19:54:49.3839821+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.3840657+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.3841618+05:30 8000002e-0007-ff00-b63f-84710c7967bb [INF] Request finished in 88.7662ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.3844132+05:30 8000008e-0002-fa00-b63f-84710c7967bb [INF] Request finished in 82.0789ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.3869737+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:49.3920014+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.3926550+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:49.3933706+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 89.193ms (afa2e885)
2021-09-22T19:54:49.3934741+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.3937762+05:30 80000077-0000-f900-b63f-84710c7967bb [INF] Request finished in 92.2929ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.6840650+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:49.6849976+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.6872701+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.6937942+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.7011244+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:49.7066836+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:49.7096610+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:49.7145224+05:30 80000012-0005-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:49.7146620+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:49.7151833+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:49.7165273+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 22.1242ms (afa2e885)
2021-09-22T19:54:49.7166561+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.7170154+05:30 80000012-0005-fd00-b63f-84710c7967bb [INF] Request finished in 33.1718ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:49.8317462+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:49.8317462+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:49.8319986+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.8319986+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:49.8323950+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.8323952+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:49.8329236+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.8329629+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:49.8358318+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.8362390+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:49.8384116+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:49.8391321+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:49.8392269+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.2032ms (afa2e885)
2021-09-22T19:54:49.8393633+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.8395710+05:30 80000004-0005-fc00-b63f-84710c7967bb [INF] Request finished in 7.9433ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:49.8424203+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:49.8429581+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:49.8435292+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.4482ms (afa2e885)
2021-09-22T19:54:49.8436384+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:49.8437788+05:30 80000014-0005-fd00-b63f-84710c7967bb [INF] Request finished in 12.1624ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.0232821+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:50.0233712+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.0234822+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.0236659+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.0247762+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:50.0247762+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:50.0248523+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.0248602+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.0249561+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.0249604+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.0250685+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.0250776+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.0262164+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:50.0266016+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:50.0279469+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:50.0283644+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.2138ms (afa2e885)
2021-09-22T19:54:50.0284316+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.0285755+05:30 80000030-0007-ff00-b63f-84710c7967bb [INF] Request finished in 3.8312ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.0316001+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:50.0322868+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.0328175+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:50.0332407+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:50.0344288+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.0348911+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:50.0354126+05:30 8000000f-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:50.0354755+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.3357ms (afa2e885)
2021-09-22T19:54:50.0355198+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.0355198+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:50.0355420+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:50.0356805+05:30 80000002-0007-fe00-b63f-84710c7967bb [INF] Request finished in 10.8681ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.0358084+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.0254ms (afa2e885)
2021-09-22T19:54:50.0359007+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.0404722+05:30 8000000f-0006-fd00-b63f-84710c7967bb [INF] Request finished in 17.1998ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:50.3148971+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:50.3158240+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.3167810+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.3173008+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.3180862+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:50.3180861+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:50.3181793+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.3185114+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.3181709+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.3186547+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.3186514+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.3187680+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.3240122+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.3240059+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T19:54:50.3240055+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:50.3262530+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T19:54:50.3279507+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 9.0899ms (afa2e885)
2021-09-22T19:54:50.3281191+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.3284881+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:50.3285181+05:30 80000005-0001-fe00-b63f-84710c7967bb [INF] Request finished in 10.4245ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.3298324+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:50.3316001+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T19:54:50.3316467+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.3321362+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:50.3327373+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.8835ms (afa2e885)
2021-09-22T19:54:50.3328027+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.3329079+05:30 80000006-0001-fd00-b63f-84710c7967bb [INF] Request finished in 14.8499ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.3366291+05:30 8000004f-0001-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T19:54:50.3367927+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T19:54:50.3368731+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T19:54:50.3372527+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 19.8223ms (afa2e885)
2021-09-22T19:54:50.3373146+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.3382669+05:30 8000004f-0001-ff00-b63f-84710c7967bb [INF] Request finished in 24.1975ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T19:54:50.5845332+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T19:54:50.5857478+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.5863058+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.5869681+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T19:54:50.5869681+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T19:54:50.5870809+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.5870808+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T19:54:50.5871610+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.5872418+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.5874088+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.5874675+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T19:54:50.5876117+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T19:54:50.5948118+05:30 80000039-0004-fa00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: A second operation was started on this context before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()" (f5c7ac34)
System.InvalidOperationException: A second operation was started on this context before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2021-09-22T19:54:50.5957483+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.6972866+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("45"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T19:54:50.7638539+05:30 80000004-0007-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("170"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T19:54:50.7644849+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T19:54:50.7979754+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T19:54:50.8327941+05:30 80000004-0007-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T19:54:50.8331387+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 245.3826ms (afa2e885)
2021-09-22T19:54:50.8350484+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.8675704+05:30 80000079-0000-f900-b63f-84710c7967bb [INF] Request finished in 280.7304ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.9089307+05:30 80000004-0007-fe00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T19:54:50.9095067+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T19:54:50.9103218+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 322.9823ms (afa2e885)
2021-09-22T19:54:50.9103533+05:30 8000004f-0001-ff00-b63f-84710c7967bb [ERR] An error occurred using a transaction. (2ffd8ddb)
2021-09-22T19:54:50.9104089+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.9105474+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 322.7387ms (afa2e885)
2021-09-22T19:54:50.9106445+05:30 80000004-0007-fe00-b63f-84710c7967bb [INF] Request finished in 326.6733ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T19:54:50.9114518+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T19:54:50.9183583+05:30 8000004f-0001-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T19:54:50.9243444+05:30 80000039-0004-fa00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
System.InvalidOperationException: A second operation was started on this context before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-09-22T19:54:50.9460505+05:30 80000039-0004-fa00-b63f-84710c7967bb [INF] Request finished in 359.2813ms 500 text/plain (791a596a)
2021-09-22T20:24:43.8089161+05:30 80000008-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:24:43.8091396+05:30 80000008-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:43.8129352+05:30 80000053-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:24:43.8129352+05:30 80000008-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8137176+05:30 80000053-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8240789+05:30 80000008-0007-fe00-b63f-84710c7967bb [INF] Request finished in 11.3086ms 204  (791a596a)
2021-09-22T20:24:43.8244264+05:30 80000053-0001-ff00-b63f-84710c7967bb [INF] Request finished in 10.3292ms 204  (791a596a)
2021-09-22T20:24:43.8240729+05:30 80000008-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8269648+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:24:43.8344731+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8350221+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:24:43.8361101+05:30 80000008-0001-fd00-b63f-84710c7967bb [INF] Request finished in 31.9426ms 204  (791a596a)
2021-09-22T20:24:43.8361280+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8363340+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:43.8372488+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:43.8404587+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:43.8458127+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:43.8461571+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:43.8474522+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:43.8529647+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:43.8544271+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:43.8723448+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:43.8848476+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:43.8848478+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:43.8862366+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:24:43.8879070+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 34.4782ms (afa2e885)
2021-09-22T20:24:43.8880717+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:43.8885523+05:30 8000000a-0001-fd00-b63f-84710c7967bb [INF] Request finished in 42.6934ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:43.8897841+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:43.8902685+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:24:43.8909516+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 53.1698ms (afa2e885)
2021-09-22T20:24:43.8910469+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:43.8911910+05:30 8000000a-0007-fe00-b63f-84710c7967bb [INF] Request finished in 64.1891ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:43.9005532+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:24:43.9013774+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:24:43.9099988+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 55.1375ms (afa2e885)
2021-09-22T20:24:43.9101314+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:43.9103736+05:30 80000032-0007-ff00-b63f-84710c7967bb [INF] Request finished in 75.2983ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:44.4189437+05:30 80000016-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:24:44.4196742+05:30 80000016-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.4209121+05:30 80000016-0005-fd00-b63f-84710c7967bb [INF] Request finished in 2.2145ms 204  (791a596a)
2021-09-22T20:24:44.4233914+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:44.4233913+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:24:44.4234926+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.4234968+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.4241670+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.4246584+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.4249125+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.4250131+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.4283992+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:24:44.4286635+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.4288617+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.4290612+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.4395372+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:44.4396993+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:24:44.4415695+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:24:44.4443309+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 17.8848ms (afa2e885)
2021-09-22T20:24:44.4444764+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.4485660+05:30 8000000c-0007-fe00-b63f-84710c7967bb [INF] Request finished in 25.1506ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:44.4485689+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:44.4496087+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:44.4524332+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:44.4539190+05:30 80000023-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:24:44.4540672+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:24:44.4545840+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.3222ms (afa2e885)
2021-09-22T20:24:44.4546542+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.4552821+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:44.4558488+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:24:44.4569600+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 31.6742ms (afa2e885)
2021-09-22T20:24:44.4570313+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.4572213+05:30 80000034-0007-ff00-b63f-84710c7967bb [INF] Request finished in 33.709ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:44.4577831+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:24:44.4607179+05:30 80000023-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354530"", Request ID ""80000023-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:24:44.4608218+05:30 80000023-0003-fc00-b63f-84710c7967bb [INF] Request finished in 32.4184ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:24:44.4625708+05:30 80000023-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:24:44.8462394+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:24:44.8465308+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.8469635+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.8474414+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.8488612+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:24:44.8493944+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:44.8495636+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.8497992+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:44.8502767+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.8505401+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:44.8506824+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.8509892+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:44.8561413+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:24:44.8566787+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:24:44.8583319+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:44.8616183+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:44.8657749+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:24:44.8665498+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:44.8677068+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.4267ms (afa2e885)
2021-09-22T20:24:44.8677544+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:44.8678751+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.8687132+05:30 800000b9-0004-fb00-b63f-84710c7967bb [INF] Request finished in 19.3306ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:44.8727455+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:44.8730097+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:44.8738747+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:24:44.8752885+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 24.3023ms (afa2e885)
2021-09-22T20:24:44.8754079+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.8757667+05:30 80000006-0005-fc00-b63f-84710c7967bb [INF] Request finished in 26.8233ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:44.8793482+05:30 80000018-0005-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:24:44.8797677+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:24:44.8799505+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:24:44.8805883+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 32.8171ms (afa2e885)
2021-09-22T20:24:44.8806957+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:44.8858427+05:30 80000018-0005-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:24:45.1210821+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:24:45.1212880+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.1216811+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.1223827+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.1245592+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:45.1245591+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:24:45.1247109+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.1247810+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.1251605+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.1251604+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.1254698+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.1255032+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.1334331+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:45.1340026+05:30 800000bb-0004-fb00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:24:45.1347800+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:24:45.1349559+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:24:45.1352014+05:30 800000bb-0004-fb00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
2021-09-22T20:24:45.1366142+05:30 80000018-0005-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571314681217047"", Request ID ""80000018-0005-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:24:45.1368128+05:30 80000018-0005-fd00-b63f-84710c7967bb [INF] Request finished in 289.3925ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:24:45.1808930+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("25"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:45.1813517+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 55.5135ms (afa2e885)
2021-09-22T20:24:45.1817815+05:30 800000bb-0004-fb00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:24:45.1818252+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:45.1823424+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:24:45.1823736+05:30 80000083-0000-f900-b63f-84710c7967bb [INF] Request finished in 57.5247ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:45.1834742+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 60.6843ms (afa2e885)
2021-09-22T20:24:45.1835809+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:45.1838280+05:30 800000bb-0004-fb00-b63f-84710c7967bb [INF] Request finished in 62.5566ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:24:45.1938656+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:45.1969984+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:45.1978111+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:24:45.1994756+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 73.3872ms (afa2e885)
2021-09-22T20:24:45.1995751+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:45.1999815+05:30 8000005c-0000-fb00-b63f-84710c7967bb [INF] Request finished in 75.0883ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:24:45.4811295+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:24:45.4814169+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.4825708+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.4830752+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.4899498+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:24:45.4963502+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:45.5003191+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:24:45.5059794+05:30 8000001a-0005-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:24:45.5064263+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:24:45.5077698+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:24:45.5130194+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 29.4988ms (afa2e885)
2021-09-22T20:24:45.5130971+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:45.5198464+05:30 8000001a-0005-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:24:45.5258488+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:24:45.5258487+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:24:45.5260300+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.5265262+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.5265923+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:24:45.5270491+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.5279796+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:24:45.5286700+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:24:45.5329630+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:45.5348974+05:30 8000001a-0005-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571314681217049"", Request ID ""8000001a-0005-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:24:45.5350460+05:30 8000001a-0005-fd00-b63f-84710c7967bb [INF] Request finished in 53.7901ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:24:45.5355533+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:24:45.5399930+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:24:45.5417142+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:24:45.5433530+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 14.4593ms (afa2e885)
2021-09-22T20:24:45.5434399+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:24:45.5438377+05:30 80000073-0002-fb00-b63f-84710c7967bb [INF] Request finished in 17.8421ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:25:15.6240137+05:30 80000010-0002-f800-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,041"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:25:15.6402812+05:30 80000010-0002-f800-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:9db18f50-558a-4e63-8beb-84e22da71954
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
ClientConnectionId:9db18f50-558a-4e63-8beb-84e22da71954
Error Number:-2,State:0,Class:11
2021-09-22T20:25:15.8782168+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30298.3197ms (afa2e885)
2021-09-22T20:25:15.8784581+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:25:15.8814265+05:30 80000010-0002-f800-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:9db18f50-558a-4e63-8beb-84e22da71954
Error Number:-2,State:0,Class:11
2021-09-22T20:25:15.8850768+05:30 80000010-0002-f800-b63f-84710c7967bb [INF] Request finished in 30306.5566ms 500 text/plain (791a596a)
2021-09-22T20:27:38.2667692+05:30 8000003b-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:27:38.2667691+05:30 8000000c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:38.2670263+05:30 8000003b-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.2673110+05:30 8000000c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.2699712+05:30 8000003b-0004-fa00-b63f-84710c7967bb [INF] Request finished in 1.1047ms 204  (791a596a)
2021-09-22T20:27:38.2699713+05:30 8000000c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 1.1048ms 204  (791a596a)
2021-09-22T20:27:38.2770566+05:30 80000049-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:27:38.2786133+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:38.2787353+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.2789679+05:30 80000049-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.2792197+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.2793341+05:30 80000049-0005-fe00-b63f-84710c7967bb [INF] Request finished in 2.2993ms 204  (791a596a)
2021-09-22T20:27:38.3076544+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.3077811+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:38.3077661+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:27:38.3084754+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.3084757+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.3147600+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.3150787+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.3198487+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:38.3211404+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.3212379+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:38.3249269+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.3254340+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:38.3264492+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 18.6428ms (afa2e885)
2021-09-22T20:27:38.3265264+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.3266164+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:27:38.3268332+05:30 80000012-0002-f800-b63f-84710c7967bb [INF] Request finished in 48.2638ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:38.3306701+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:27:38.3309417+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:27:38.3313409+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 6.3346ms (afa2e885)
2021-09-22T20:27:38.3313968+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.3315071+05:30 80000025-0003-fc00-b63f-84710c7967bb [INF] Request finished in 23.7633ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:38.3316509+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:38.3355394+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:38.3359179+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:27:38.3363064+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.1576ms (afa2e885)
2021-09-22T20:27:38.3363539+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.3364356+05:30 80000085-0000-f900-b63f-84710c7967bb [INF] Request finished in 28.7219ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:38.8421032+05:30 8000003d-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:27:38.8423807+05:30 8000003d-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.8435923+05:30 8000003d-0004-fa00-b63f-84710c7967bb [INF] Request finished in 1.5484ms 204  (791a596a)
2021-09-22T20:27:38.8546285+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:27:38.8547044+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:38.8547280+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.8547765+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.8549356+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:38.8550106+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:38.8550621+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.8552037+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.8557296+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.8557381+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.8558289+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:38.8560559+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:38.8601236+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:38.8714970+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:27:38.8761362+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:38.8808161+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:38.8816421+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:27:38.8831506+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 26.5314ms (afa2e885)
2021-09-22T20:27:38.8833551+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.8837788+05:30 8000003f-0004-fa00-b63f-84710c7967bb [INF] Request finished in 29.0727ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:38.8872988+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:38.8935264+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:38.8948682+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:38.8956181+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:38.8959224+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 39.3839ms (afa2e885)
2021-09-22T20:27:38.8960440+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.8963300+05:30 80000006-0006-fb00-b63f-84710c7967bb [INF] Request finished in 41.4182ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:38.9025477+05:30 80000029-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:27:38.9027258+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:27:38.9032619+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 46.7656ms (afa2e885)
2021-09-22T20:27:38.9033247+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:38.9055752+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:27:38.9067899+05:30 80000029-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256424"", Request ID ""80000029-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:27:38.9068789+05:30 80000029-0006-fc00-b63f-84710c7967bb [INF] Request finished in 52.3485ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:27:38.9105355+05:30 80000029-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:27:39.2702745+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:27:39.2703995+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.2709341+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.2714217+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.2759468+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:39.2759473+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:39.2760505+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.2760513+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.2762791+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.2764454+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.2765220+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.2766155+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.2795580+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:27:39.2801191+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:39.2808830+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:27:39.2858224+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:39.2858909+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:39.2906894+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:39.2910373+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:39.2922038+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:27:39.2924333+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 15.5362ms (afa2e885)
2021-09-22T20:27:39.2927322+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.2928424+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:39.2935566+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 16.876ms (afa2e885)
2021-09-22T20:27:39.2936403+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.2938531+05:30 8000002b-0006-fc00-b63f-84710c7967bb [INF] Request finished in 17.9437ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:39.2939211+05:30 8000004b-0005-fe00-b63f-84710c7967bb [INF] Request finished in 18.0653ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:39.2972385+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:39.3044372+05:30 8000000e-0001-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:27:39.3045480+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:27:39.3047500+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:27:39.3061842+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 34.417ms (afa2e885)
2021-09-22T20:27:39.3062898+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.3116715+05:30 8000000e-0001-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StateChanging(InternalEntityEntry entry, EntityState newState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:27:39.6766624+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:27:39.6769107+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.6770699+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.6773150+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.6830916+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:39.6832013+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.6834262+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.6835701+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.6865680+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:39.6867213+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:39.6867424+05:30 80000087-0000-f900-b63f-84710c7967bb [ERR] Failed executing DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:27:39.6868743+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:39.6876238+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:39.6878583+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:39.6885349+05:30 80000087-0000-f900-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
2021-09-22T20:27:39.6917006+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:27:39.7469649+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("54"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:39.7753276+05:30 8000000e-0001-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571297501347853"", Request ID ""8000000e-0001-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:27:39.7754490+05:30 8000000e-0001-fd00-b63f-84710c7967bb [INF] Request finished in 505.274ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:27:39.7802562+05:30 80000087-0000-f900-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:27:39.7813580+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:39.7832039+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:27:39.7832231+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:39.7832216+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:27:39.7845260+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 100.737ms (afa2e885)
2021-09-22T20:27:39.7845456+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 106.7832ms (afa2e885)
2021-09-22T20:27:39.7846129+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.7846146+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.7849051+05:30 80000014-0002-f800-b63f-84710c7967bb [INF] Request finished in 101.9035ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:39.7857883+05:30 80000087-0000-f900-b63f-84710c7967bb [INF] Request finished in 109.1449ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:27:39.7880521+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:39.7895095+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 101.5178ms (afa2e885)
2021-09-22T20:27:39.7896325+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:39.7902262+05:30 8000004d-0005-fe00-b63f-84710c7967bb [INF] Request finished in 103.5506ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:40.0689033+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:27:40.0689645+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.0690365+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.0691270+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.0719110+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:27:40.0757192+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:40.0787473+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:40.0825224+05:30 80000016-0002-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:27:40.0827431+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:27:40.0827564+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:27:40.0834029+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.1844ms (afa2e885)
2021-09-22T20:27:40.0834651+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:40.0867595+05:30 80000016-0002-f800-b63f-84710c7967bb [INF] Request finished in 17.8186ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:27:40.0872879+05:30 80000016-0002-f800-b63f-84710c7967bb [ERR] An error occurred using a transaction. (2ffd8ddb)
2021-09-22T20:27:40.0992122+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:40.0993200+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.0996044+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.0997537+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.0998460+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:40.0998896+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.0999424+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.1000225+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.1022424+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:40.1032875+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:40.1039262+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:40.1045173+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.6781ms (afa2e885)
2021-09-22T20:27:40.1045805+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:40.1047635+05:30 80000041-0004-fa00-b63f-84710c7967bb [INF] Request finished in 5.6043ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:40.1056170+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:27:40.1097876+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:27:40.1102828+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:27:40.1108538+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.7348ms (afa2e885)
2021-09-22T20:27:40.1109143+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:40.1110470+05:30 80000018-0002-f800-b63f-84710c7967bb [INF] Request finished in 11.2502ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:27:40.3217869+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:27:40.3218792+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.3219544+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.3220469+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.3241652+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:27:40.3263765+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:40.3305402+05:30 8000004f-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:27:40.3306042+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:27:40.3307447+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:27:40.3312358+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 9.0886ms (afa2e885)
2021-09-22T20:27:40.3312887+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:40.3358416+05:30 8000004f-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:27:40.4363481+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:27:40.4364178+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.4365132+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.4366722+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.4372441+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:27:40.4373499+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:27:40.4378012+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:27:40.4381443+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:27:40.4410371+05:30 8000004f-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145038"", Request ID ""8000004f-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:27:40.4411330+05:30 8000004f-0005-fe00-b63f-84710c7967bb [INF] Request finished in 119.3879ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:27:40.4424806+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:27:40.4467636+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:27:40.4518320+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 13.4384ms (afa2e885)
2021-09-22T20:27:40.4535222+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:27:40.4539023+05:30 80000027-0003-fc00-b63f-84710c7967bb [INF] Request finished in 16.6607ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:28:10.4539571+05:30 80000089-0000-f900-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,016"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T20:28:10.4553922+05:30 80000089-0000-f900-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 24
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11
2021-09-22T20:28:18.4584990+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 38021.6695ms (afa2e885)
2021-09-22T20:28:18.4588682+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:28:18.4615912+05:30 80000089-0000-f900-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 64
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 23
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11
2021-09-22T20:28:18.4685510+05:30 80000089-0000-f900-b63f-84710c7967bb [INF] Request finished in 38032.2357ms 500 text/plain (791a596a)
2021-09-22T20:30:20.8171183+05:30 8000000e-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:30:20.8171935+05:30 8000000e-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8175239+05:30 8000000e-0004-f700-b63f-84710c7967bb [INF] Request finished in 0.4519ms 204  (791a596a)
2021-09-22T20:30:20.8178152+05:30 80000081-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:20.8178635+05:30 80000081-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8180655+05:30 80000081-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.2289ms 204  (791a596a)
2021-09-22T20:30:20.8190445+05:30 8000008b-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:30:20.8191307+05:30 8000008b-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8194395+05:30 8000008b-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.7303ms 204  (791a596a)
2021-09-22T20:30:20.8225118+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:30:20.8225753+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8227338+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:20.8228472+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:20.8241636+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:20.8248664+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8335710+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:20.8337875+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:20.8399535+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:20.8402419+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:20.8416564+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:20.8417781+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:20.8459448+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:30:20.8470118+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:30:20.8482724+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 25.3204ms (afa2e885)
2021-09-22T20:30:20.8484012+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:20.8487353+05:30 80000019-0006-fd00-b63f-84710c7967bb [INF] Request finished in 26.239ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:20.8493006+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:20.8531534+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:20.8544716+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:20.8547597+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:20.8552920+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 21.2673ms (afa2e885)
2021-09-22T20:30:20.8553851+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:20.8555851+05:30 80000029-0003-fc00-b63f-84710c7967bb [INF] Request finished in 31.6386ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:20.8617968+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:20.8646770+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:20.8652290+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:20.8657223+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 23.8803ms (afa2e885)
2021-09-22T20:30:20.8657951+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:20.8659263+05:30 8000008d-0000-f900-b63f-84710c7967bb [INF] Request finished in 30.6307ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.3370842+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:21.3370842+05:30 80000010-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:30:21.3371687+05:30 80000010-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.3371687+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.3373321+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:21.3373427+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.3373953+05:30 80000010-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.3481ms 204  (791a596a)
2021-09-22T20:30:21.3374798+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.3374664+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.3375899+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.3377000+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.3393584+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.3416553+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.3441462+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:21.3442463+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.3443668+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.3445646+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.3445643+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:21.3451890+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.3453023+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.7248ms (afa2e885)
2021-09-22T20:30:21.3454416+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.3457578+05:30 80000083-0004-fc00-b63f-84710c7967bb [INF] Request finished in 8.675ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.3482246+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.3486294+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:21.3491622+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.3594ms (afa2e885)
2021-09-22T20:30:21.3492258+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.3493108+05:30 80000051-0005-fe00-b63f-84710c7967bb [INF] Request finished in 12.0229ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.3544324+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:21.3601850+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.3632051+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.3694543+05:30 8000002b-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:21.3696577+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:21.3702115+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.5587ms (afa2e885)
2021-09-22T20:30:21.3702999+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.3735230+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:21.3742212+05:30 8000002b-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354538"", Request ID ""8000002b-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:21.3743237+05:30 8000002b-0003-fc00-b63f-84710c7967bb [INF] Request finished in 30.2183ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:21.3784977+05:30 8000002b-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:21.6332619+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:21.6333182+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.6334240+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.6335705+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.6369125+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:21.6369184+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:21.6369902+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.6370660+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.6370855+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:21.6371117+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.6371379+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.6372003+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.6372533+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.6379505+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:21.6383892+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.6408348+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.6430854+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.6442954+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:21.6443423+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.6449263+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.61ms (afa2e885)
2021-09-22T20:30:21.6450266+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.6451746+05:30 80000012-0001-fd00-b63f-84710c7967bb [INF] Request finished in 8.0591ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.6472627+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.6473348+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.6478199+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:21.6484179+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.2234ms (afa2e885)
2021-09-22T20:30:21.6484947+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.6487164+05:30 80000050-0000-fa00-b63f-84710c7967bb [INF] Request finished in 11.7883ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.6531754+05:30 8000008f-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:21.6532979+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:21.6536809+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.0465ms (afa2e885)
2021-09-22T20:30:21.6537192+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:21.6537387+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.6575820+05:30 8000008f-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668942"", Request ID ""8000008f-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:21.6577843+05:30 8000008f-0000-f900-b63f-84710c7967bb [INF] Request finished in 24.4479ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:21.6599195+05:30 8000008f-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:21.8843706+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:21.8844846+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.8845650+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.8848936+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.8872357+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:21.8886016+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:21.8886666+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.8887849+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.8888354+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:21.8888646+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.8889070+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:21.8889564+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:21.8890100+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:21.8904280+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:21.8921690+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.8930195+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.8935487+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:21.8940004+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.068ms (afa2e885)
2021-09-22T20:30:21.8940628+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.8941942+05:30 8000001b-0006-fd00-b63f-84710c7967bb [INF] Request finished in 5.6364ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:21.8949663+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:21.8995361+05:30 80000085-0004-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:21.8996692+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:21.8996860+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:21.9001746+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 15.2154ms (afa2e885)
2021-09-22T20:30:21.9002291+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.9014809+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.9031892+05:30 80000085-0004-fc00-b63f-84710c7967bb [INF] Request finished in 18.8262ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:21.9043705+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:21.9043754+05:30 80000085-0004-fc00-b63f-84710c7967bb [ERR] An error occurred using a transaction. (2ffd8ddb)
2021-09-22T20:30:21.9086343+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:21.9089575+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:21.9093406+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 20.2786ms (afa2e885)
2021-09-22T20:30:21.9093879+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:21.9094820+05:30 80000091-0000-f900-b63f-84710c7967bb [INF] Request finished in 20.6478ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.2332281+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:22.2333107+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.2333976+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.2335084+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.2412880+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:22.2427134+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:22.2426785+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:22.2428223+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.2429843+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.2431850+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.2440824+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.2442962+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.2444224+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.2451549+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:22.2464725+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:22.2492419+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:22.2496693+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:22.2505235+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:22.2510323+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.5129ms (afa2e885)
2021-09-22T20:30:22.2511497+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.2513492+05:30 80000036-0007-ff00-b63f-84710c7967bb [INF] Request finished in 8.6912ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.2531869+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:22.2546247+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:22.2546289+05:30 8000001d-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:22.2548364+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:22.2552622+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.8036ms (afa2e885)
2021-09-22T20:30:22.2553618+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.2554731+05:30 8000002d-0006-fc00-b63f-84710c7967bb [INF] Request finished in 12.7846ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.2559386+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 22.3459ms (afa2e885)
2021-09-22T20:30:22.2560063+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.2561272+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:22.2618622+05:30 8000001d-0006-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571318976184348"", Request ID ""8000001d-0006-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:22.2619940+05:30 8000001d-0006-fd00-b63f-84710c7967bb [INF] Request finished in 28.8037ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:22.2667915+05:30 8000001d-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:22.6347315+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:22.6347141+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:22.6347597+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:22.6348600+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.6348665+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.6348778+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.6350351+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.6350564+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.6351720+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.6352544+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.6352849+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.6353814+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.6379391+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:22.6395767+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:22.6401456+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:22.6447410+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:22.6478741+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:22.6616594+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:22.6636353+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:22.6655589+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 29.9856ms (afa2e885)
2021-09-22T20:30:22.6658757+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.6647382+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:22.6661738+05:30 8000001c-0005-fd00-b63f-84710c7967bb [INF] Request finished in 31.4459ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.6677524+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 32.0073ms (afa2e885)
2021-09-22T20:30:22.6679128+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.6682929+05:30 80000093-0000-f900-b63f-84710c7967bb [INF] Request finished in 33.6516ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.6709443+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:22.6739498+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:22.6804400+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:22.6808375+05:30 80000053-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:22.6810322+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:22.6816268+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 46.1996ms (afa2e885)
2021-09-22T20:30:22.6817027+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.6861627+05:30 80000053-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:22.9168088+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:22.9169152+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.9170203+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.9171722+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.9255801+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:22.9257297+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.9260650+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.9262025+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.9339271+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:22.9341713+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:22.9347786+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:22.9349439+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:22.9351205+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:22.9368659+05:30 80000053-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145042"", Request ID ""80000053-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:22.9369771+05:30 80000053-0005-fe00-b63f-84710c7967bb [INF] Request finished in 302.3219ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:22.9369840+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:22.9377336+05:30 8000001a-0002-f800-b63f-84710c7967bb [ERR] Failed executing DbCommand ("19"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:30:22.9381750+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.8874ms (afa2e885)
2021-09-22T20:30:22.9382780+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.9386047+05:30 80000095-0000-f900-b63f-84710c7967bb [INF] Request finished in 13.1987ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.9387405+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:22.9394570+05:30 8000001a-0002-f800-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:30:22.9702026+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("27"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:22.9913627+05:30 8000001a-0002-f800-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:30:22.9916509+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:30:22.9922392+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 74.9625ms (afa2e885)
2021-09-22T20:30:22.9923110+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:22.9924148+05:30 8000001a-0002-f800-b63f-84710c7967bb [INF] Request finished in 75.7264ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:30:22.9983441+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.0030544+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.0033113+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:23.0037690+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 68.7112ms (afa2e885)
2021-09-22T20:30:23.0038112+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.0039740+05:30 80000014-0001-fd00-b63f-84710c7967bb [INF] Request finished in 70.3502ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.2185104+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:23.2185849+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.2186697+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.2187653+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.2259918+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:23.2311092+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.2383018+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:23.2384982+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.2388986+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.2390005+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.2391249+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.2402643+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:23.2403911+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.2412812+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.2414224+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.2469190+05:30 80000016-0001-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:23.2470876+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:23.2477863+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 28.9448ms (afa2e885)
2021-09-22T20:30:23.2478515+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.2503134+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.2540870+05:30 80000016-0001-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571297501347861"", Request ID ""80000016-0001-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:23.2542313+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Request finished in 35.7804ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:23.2585055+05:30 80000016-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("13"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:23.2622456+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.2767759+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.2782448+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:23.2795872+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 40.2403ms (afa2e885)
2021-09-22T20:30:23.2798039+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.2803143+05:30 80000055-0001-ff00-b63f-84710c7967bb [INF] Request finished in 42.1238ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.2817798+05:30 80000016-0001-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:23.2832057+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.2838904+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:23.2846414+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 43.1198ms (afa2e885)
2021-09-22T20:30:23.2848815+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.2850473+05:30 80000007-0001-fe00-b63f-84710c7967bb [INF] Request finished in 44.8129ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.5108835+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:23.5109704+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.5110741+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.5111840+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.5151119+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:23.5194872+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.5238006+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.5289742+05:30 8000001c-0002-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:23.5291521+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:23.5298208+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 18.54ms (afa2e885)
2021-09-22T20:30:23.5298849+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.5337741+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:23.5343978+05:30 8000001c-0002-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283331606675483"", Request ID ""8000001c-0002-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:23.5344811+05:30 8000001c-0002-f800-b63f-84710c7967bb [INF] Request finished in 23.6551ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:23.5382494+05:30 8000001c-0002-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:23.5491337+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:23.5492938+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.5493943+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.5495064+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.5551980+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:23.5552854+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.5554423+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.5555446+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.5559786+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.5567107+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:23.5613282+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.5615789+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.5618045+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:23.5621226+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.5274ms (afa2e885)
2021-09-22T20:30:23.5621867+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.5623126+05:30 80000097-0000-f900-b63f-84710c7967bb [INF] Request finished in 7.2182ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.5646660+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.5649996+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:23.5654909+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15.9198ms (afa2e885)
2021-09-22T20:30:23.5655498+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.5656185+05:30 8000001e-0002-f800-b63f-84710c7967bb [INF] Request finished in 16.5673ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.7653971+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:23.7654823+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.7655557+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.7656678+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.7697319+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:23.7741744+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.7778975+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.7807693+05:30 8000002d-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:23.7808728+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:23.7811429+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 15.4205ms (afa2e885)
2021-09-22T20:30:23.7811824+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.7835577+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:23.7844736+05:30 8000002d-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354540"", Request ID ""8000002d-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:23.7845484+05:30 8000002d-0003-fc00-b63f-84710c7967bb [INF] Request finished in 19.1879ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:23.7868205+05:30 8000002d-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:23.7942870+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:23.7943758+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:23.7944092+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.7944047+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:23.7944826+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.7944831+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:23.7945785+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.7946227+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:23.7965136+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:23.7978283+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:23.7982963+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:23.7987141+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.087ms (afa2e885)
2021-09-22T20:30:23.7987867+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.7989260+05:30 8000002f-0003-fc00-b63f-84710c7967bb [INF] Request finished in 4.685ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:23.7999781+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.8042693+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:23.8063621+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:23.8066902+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:23.8070342+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.3135ms (afa2e885)
2021-09-22T20:30:23.8070861+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:23.8072101+05:30 80000009-0001-fe00-b63f-84710c7967bb [INF] Request finished in 12.8377ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.0973984+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:24.0975532+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.0976219+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.0977123+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.1022519+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:24.1109276+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.1148795+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:24.1149337+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:24.1149883+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.1151691+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.1151855+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.1152537+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.1152676+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.1153318+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.1176723+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:24.1192288+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.1198351+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.1300678+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.1361303+05:30 80000087-0004-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:24.1363108+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:24.1417261+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 43.7232ms (afa2e885)
2021-09-22T20:30:24.1419788+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.1431890+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:24.1459104+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.1465718+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:24.1670291+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 51.6019ms (afa2e885)
2021-09-22T20:30:24.1673268+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.1688587+05:30 80000010-0004-f700-b63f-84710c7967bb [INF] Request finished in 52.794ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.1838106+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.1845901+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:24.1860833+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 70.7496ms (afa2e885)
2021-09-22T20:30:24.1862118+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.1864350+05:30 80000006-0004-f800-b63f-84710c7967bb [INF] Request finished in 71.4795ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.1878500+05:30 80000087-0004-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513716348321926"", Request ID ""80000087-0004-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:24.1878848+05:30 80000087-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:24.1885004+05:30 80000087-0004-fc00-b63f-84710c7967bb [INF] Request finished in 90.6543ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:24.3968793+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:24.3969597+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.3970662+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.3972631+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.4018780+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:24.4088525+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.4092916+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:24.4094725+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:24.4095334+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.4095338+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.4096206+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.4096395+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.4097332+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.4098209+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.4109465+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:24.4141449+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.4151480+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.4177688+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.4184406+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:24.4256323+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.4257173+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 15.8251ms (afa2e885)
2021-09-22T20:30:24.4258276+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.4260433+05:30 80000055-0005-fe00-b63f-84710c7967bb [INF] Request finished in 16.7493ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.4324537+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.4335428+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:24.4344861+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 24.6659ms (afa2e885)
2021-09-22T20:30:24.4347146+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.4347928+05:30 80000038-0007-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:24.4348438+05:30 80000089-0004-fc00-b63f-84710c7967bb [INF] Request finished in 25.5891ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.4351715+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:24.4359539+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 38.6151ms (afa2e885)
2021-09-22T20:30:24.4360191+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.4399305+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:24.4401107+05:30 80000038-0007-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686511347007543"", Request ID ""80000038-0007-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:24.4402292+05:30 80000038-0007-ff00-b63f-84710c7967bb [INF] Request finished in 43.3805ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:24.4471680+05:30 80000038-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:24.6604934+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:24.6605586+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.6606319+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.6607713+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.6645312+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:24.6645989+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.6646097+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:24.6646824+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.6647242+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.6648028+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.6648785+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.6648754+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.6661814+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:24.6666587+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:24.6704433+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.6761805+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.6768389+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:24.6774148+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 12.4141ms (afa2e885)
2021-09-22T20:30:24.6775060+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.6777315+05:30 80000031-0003-fc00-b63f-84710c7967bb [INF] Request finished in 13.2253ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.6826619+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.6849992+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.6905103+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.6936878+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.6941335+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:24.6946971+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 29.7161ms (afa2e885)
2021-09-22T20:30:24.6947661+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.6948901+05:30 8000000b-0001-fe00-b63f-84710c7967bb [INF] Request finished in 30.3283ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.6968844+05:30 8000008b-0004-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:24.6970593+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:24.6975457+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 36.6973ms (afa2e885)
2021-09-22T20:30:24.6976173+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.7003797+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:24.7022509+05:30 8000008b-0004-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513716348321930"", Request ID ""8000008b-0004-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:24.7023946+05:30 8000008b-0004-fc00-b63f-84710c7967bb [INF] Request finished in 41.9242ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:24.7052675+05:30 8000008b-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:24.9271755+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:24.9272514+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.9273568+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.9274994+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.9321854+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:24.9386919+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.9387291+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:24.9387946+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.9388384+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:24.9388807+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:24.9389163+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.9389429+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:24.9390186+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.9390255+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:24.9397388+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:24.9427840+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.9429711+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.9443420+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:24.9460112+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.9394ms (afa2e885)
2021-09-22T20:30:24.9460123+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:24.9460855+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.9462190+05:30 80000020-0002-f800-b63f-84710c7967bb [INF] Request finished in 7.5236ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.9484409+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:24.9507406+05:30 8000000d-0001-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:24.9508500+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:24.9513364+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.7539ms (afa2e885)
2021-09-22T20:30:24.9514240+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.9542880+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:24.9546116+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:24.9548669+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:24.9552161+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 16.1424ms (afa2e885)
2021-09-22T20:30:24.9552610+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:24.9553205+05:30 80000098-0002-fa00-b63f-84710c7967bb [INF] Request finished in 16.4939ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:24.9559497+05:30 8000000d-0001-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628891539275788"", Request ID ""8000000d-0001-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:24.9560545+05:30 8000000d-0001-fe00-b63f-84710c7967bb [INF] Request finished in 28.9229ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:24.9589371+05:30 8000000d-0001-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:25.2534002+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:25.2534933+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.2538908+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.2540261+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.2567404+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:25.2567294+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:25.2568312+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.2568647+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.2569841+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.2569726+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.2570955+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.2571052+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.2582144+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:25.2585995+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:25.2625215+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.2634055+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:25.2639897+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.8019ms (afa2e885)
2021-09-22T20:30:25.2641046+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.2643522+05:30 8000009a-0002-fa00-b63f-84710c7967bb [INF] Request finished in 7.6419ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:25.2664426+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.2691744+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.2739220+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.2739378+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.2775163+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.2783981+05:30 8000000f-0001-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:25.2785476+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:25.2785711+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:25.2791379+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.0404ms (afa2e885)
2021-09-22T20:30:25.2791711+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.9841ms (afa2e885)
2021-09-22T20:30:25.2792132+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.2792584+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.2795774+05:30 8000001f-0006-fd00-b63f-84710c7967bb [INF] Request finished in 22.6897ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:25.2816911+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:25.2841308+05:30 8000000f-0001-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628891539275790"", Request ID ""8000000f-0001-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:25.2842497+05:30 8000000f-0001-fe00-b63f-84710c7967bb [INF] Request finished in 30.8584ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:25.2862188+05:30 8000000f-0001-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:25.5369395+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:25.5370184+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.5371108+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.5372685+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.5476410+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:25.5516598+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:25.5516983+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:25.5517352+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.5517347+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.5518144+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.5518143+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.5519337+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.5519266+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.5528317+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:25.5545507+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.5561918+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.5583593+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.5590273+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:25.5596378+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.584ms (afa2e885)
2021-09-22T20:30:25.5597557+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.5601086+05:30 80000021-0006-fd00-b63f-84710c7967bb [INF] Request finished in 8.3816ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:25.5601754+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.5620117+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.5661291+05:30 80000057-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:25.5662468+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.5662758+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:25.5667438+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 29.3965ms (afa2e885)
2021-09-22T20:30:25.5667628+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:25.5668140+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.5673912+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 15.3644ms (afa2e885)
2021-09-22T20:30:25.5674567+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.5675640+05:30 8000001e-0005-fd00-b63f-84710c7967bb [INF] Request finished in 15.9326ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:25.5697266+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:25.5715920+05:30 80000057-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145046"", Request ID ""80000057-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:25.5717818+05:30 80000057-0005-fe00-b63f-84710c7967bb [INF] Request finished in 34.8708ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:25.5753904+05:30 80000057-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:25.8232718+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:25.8235896+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.8237114+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.8238799+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.8282812+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:25.8339367+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.8386664+05:30 80000008-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:30:25.8386666+05:30 8000008d-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:25.8387558+05:30 80000008-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.8387564+05:30 8000008d-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.8389834+05:30 8000008d-0004-fc00-b63f-84710c7967bb [INF] Request finished in 0.3618ms 204  (791a596a)
2021-09-22T20:30:25.8389831+05:30 80000008-0004-f800-b63f-84710c7967bb [INF] Request finished in 0.3617ms 204  (791a596a)
2021-09-22T20:30:25.8390037+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.8434817+05:30 8000009c-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:25.8436521+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:25.8441693+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.2046ms (afa2e885)
2021-09-22T20:30:25.8442236+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.8463812+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:25.8462513+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:25.8465618+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.8465985+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:25.8466470+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.8466850+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:25.8467376+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.8467506+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:25.8467410+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:25.8475007+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:25.8476766+05:30 8000009c-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531483"", Request ID ""8000009c-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:25.8477538+05:30 8000009c-0002-fa00-b63f-84710c7967bb [INF] Request finished in 24.5242ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:25.8505466+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.8529665+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:25.8533082+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:25.8533327+05:30 8000009c-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:25.8540117+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.0823ms (afa2e885)
2021-09-22T20:30:25.8540881+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.8548074+05:30 80000023-0006-fd00-b63f-84710c7967bb [INF] Request finished in 8.551ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:25.8576888+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:25.8642071+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:25.8645682+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:25.8649939+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 18.1977ms (afa2e885)
2021-09-22T20:30:25.8650477+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:25.8652073+05:30 8000002f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 19.1529ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.0579496+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:26.0580326+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.0581251+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.0582637+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.0636249+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:26.0663584+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:26.0664327+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.0665097+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.0666209+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.0668037+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:26.0669000+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.0669894+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.0670830+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.0677276+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:26.0681314+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.0704246+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.0708039+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.0710976+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:26.0713774+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.2488ms (afa2e885)
2021-09-22T20:30:26.0714473+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.0715775+05:30 80000033-0003-fc00-b63f-84710c7967bb [INF] Request finished in 4.7881ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.0755114+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.0768557+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.0784287+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.0786800+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:26.0789868+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.3086ms (afa2e885)
2021-09-22T20:30:26.0790250+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.0790941+05:30 80000099-0000-f900-b63f-84710c7967bb [INF] Request finished in 12.7726ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.0801943+05:30 80000031-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:26.0803305+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:26.0806464+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 22.2809ms (afa2e885)
2021-09-22T20:30:26.0807014+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.0834425+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:26.0835978+05:30 80000031-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256432"", Request ID ""80000031-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:26.0836577+05:30 80000031-0006-fc00-b63f-84710c7967bb [INF] Request finished in 25.7903ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:26.0871025+05:30 80000031-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:26.3212973+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:26.3213532+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.3214313+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.3215201+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.3268217+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:26.3323863+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.3334353+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:26.3335683+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.3336462+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.3337333+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.3350501+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:26.3351882+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.3353345+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.3354761+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.3363651+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.3363650+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:26.3386592+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.3412660+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.3423347+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:26.3428628+05:30 8000009e-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:26.3431300+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:26.3434379+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.7374ms (afa2e885)
2021-09-22T20:30:26.3434639+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 21.9043ms (afa2e885)
2021-09-22T20:30:26.3434984+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.3436903+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.3455536+05:30 80000035-0003-fc00-b63f-84710c7967bb [INF] Request finished in 10.1536ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.3460957+05:30 8000009e-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531485"", Request ID ""8000009e-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:26.3461700+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Request finished in 24.8876ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:26.3462025+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.3468323+05:30 8000009e-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:26.3512284+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.3515076+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:26.3518631+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 18.0639ms (afa2e885)
2021-09-22T20:30:26.3519098+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.3519849+05:30 8000009b-0000-f900-b63f-84710c7967bb [INF] Request finished in 18.5862ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.3522796+05:30 8000009e-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:26.5913551+05:30 8000009d-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:30:26.5914524+05:30 8000009d-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.5917739+05:30 8000009d-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.4485ms 204  (791a596a)
2021-09-22T20:30:26.5961558+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:26.5962707+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.5964341+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.5965470+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.6004761+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:26.6005887+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.6005888+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:26.6006350+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.6006709+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.6007190+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.6007868+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.6008181+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.6015664+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:26.6055302+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.6064744+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:26.6069783+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.6077110+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:26.6085245+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.4964ms (afa2e885)
2021-09-22T20:30:26.6086491+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.6088428+05:30 8000008f-0004-fc00-b63f-84710c7967bb [INF] Request finished in 8.2601ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.6152066+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.6161686+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.6188843+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.6192950+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:26.6197291+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.6197963+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 18.9461ms (afa2e885)
2021-09-22T20:30:26.6198746+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.6199910+05:30 8000009f-0000-f900-b63f-84710c7967bb [INF] Request finished in 19.5252ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.6267145+05:30 8000000a-0004-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:26.6269301+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:26.6274795+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 30.8383ms (afa2e885)
2021-09-22T20:30:26.6275823+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.6309439+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:26.6326892+05:30 8000000a-0004-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283340196610057"", Request ID ""8000000a-0004-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:26.6330558+05:30 8000000a-0004-f800-b63f-84710c7967bb [INF] Request finished in 36.8237ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:26.6369091+05:30 8000000a-0004-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:26.8411796+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:26.8412815+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.8413935+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.8414993+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.8502811+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:26.8538325+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:26.8539176+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.8540358+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.8541296+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.8559649+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:26.8560423+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:26.8562396+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:26.8563634+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:26.8574381+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:26.8584550+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.8589689+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.8604557+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.8611958+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:26.8617258+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.2686ms (afa2e885)
2021-09-22T20:30:26.8617773+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.8619360+05:30 800000a1-0000-f900-b63f-84710c7967bb [INF] Request finished in 5.9886ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.8636118+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:26.8644212+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:26.8665585+05:30 80000011-0001-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:26.8667112+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:26.8670441+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:26.8670810+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.4994ms (afa2e885)
2021-09-22T20:30:26.8671617+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.8674895+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:26.8679418+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.7454ms (afa2e885)
2021-09-22T20:30:26.8680496+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:26.8682102+05:30 80000037-0003-fc00-b63f-84710c7967bb [INF] Request finished in 14.4326ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:26.8691235+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:26.8700686+05:30 80000011-0001-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628891539275792"", Request ID ""80000011-0001-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:26.8701942+05:30 80000011-0001-fe00-b63f-84710c7967bb [INF] Request finished in 29.0596ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:26.8727149+05:30 80000011-0001-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:27.0959113+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:27.0960522+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.0961947+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.0963714+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.1009949+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:27.1010847+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.1010971+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:27.1011604+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.1011836+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.1012751+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.1014092+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.1013529+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.1030553+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:27.1034617+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:27.1077980+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.1084411+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:27.1089949+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.5029ms (afa2e885)
2021-09-22T20:30:27.1091417+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.1093903+05:30 800000a0-0002-fa00-b63f-84710c7967bb [INF] Request finished in 8.2682ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:27.1102086+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.1145298+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.1172691+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.1181469+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.1207366+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.1211400+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:27.1216441+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 20.1169ms (afa2e885)
2021-09-22T20:30:27.1217387+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.1218672+05:30 80000039-0003-fc00-b63f-84710c7967bb [INF] Request finished in 20.9127ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:27.1241125+05:30 80000059-0005-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:27.1242407+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:27.1246015+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 28.1369ms (afa2e885)
2021-09-22T20:30:27.1246830+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.1266284+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:27.1290521+05:30 80000059-0005-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628908719145048"", Request ID ""80000059-0005-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:27.1291731+05:30 80000059-0005-fe00-b63f-84710c7967bb [INF] Request finished in 33.3047ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:27.1311166+05:30 80000059-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:27.5198217+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:27.5199338+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.5201620+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.5203851+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.5259042+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:27.5260057+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.5261382+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.5262840+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.5268261+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:27.5271120+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:27.5271809+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.5273063+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.5274818+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.5289378+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:27.5332532+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.5372397+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.5378066+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:27.5384582+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 10.8477ms (afa2e885)
2021-09-22T20:30:27.5386841+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.5389906+05:30 80000052-0000-fa00-b63f-84710c7967bb [INF] Request finished in 12.2723ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:27.5462271+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.5484845+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.5535095+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.5554613+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.5559034+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:27.5565167+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 30.0611ms (afa2e885)
2021-09-22T20:30:27.5566466+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.5568011+05:30 8000003b-0003-fc00-b63f-84710c7967bb [INF] Request finished in 30.9286ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:27.5605036+05:30 800000a3-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:27.5607107+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:27.5611424+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 40.6271ms (afa2e885)
2021-09-22T20:30:27.5612066+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.5653254+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:27.5653692+05:30 800000a3-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668962"", Request ID ""800000a3-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:27.5654764+05:30 800000a3-0000-f900-b63f-84710c7967bb [INF] Request finished in 45.7915ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:27.5703438+05:30 800000a3-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:27.8423964+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:27.8424774+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.8425639+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.8426873+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.8480154+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:27.8535204+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.8564328+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:27.8566212+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.8567234+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:27.8567647+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:27.8567545+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.8569363+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:27.8570990+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.8578479+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:27.8595113+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.8614729+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:27.8618867+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:27.8623774+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:27.8629128+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.7243ms (afa2e885)
2021-09-22T20:30:27.8633089+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.8635156+05:30 800000a2-0002-fa00-b63f-84710c7967bb [INF] Request finished in 6.7643ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:27.8653578+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.8674286+05:30 80000013-0001-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:27.8675685+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:27.8679818+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.2263ms (afa2e885)
2021-09-22T20:30:27.8680408+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.8724187+05:30 80000013-0001-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628891539275794"", Request ID ""80000013-0001-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:27.8725466+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Request finished in 30.1717ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:27.8766462+05:30 80000013-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:27.8778168+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:27.8818192+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:27.8821919+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:27.8822043+05:30 80000013-0001-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:27.8828259+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 23.9923ms (afa2e885)
2021-09-22T20:30:27.8829047+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:27.8830753+05:30 8000003a-0007-ff00-b63f-84710c7967bb [INF] Request finished in 26.6976ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.1480259+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:28.1482053+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.1484567+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.1487612+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.1561945+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:28.1564779+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:28.1565892+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:28.1568993+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.1570579+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.1572024+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.1573274+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.1574346+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.1575745+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.1599801+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.1625251+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:28.1625549+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:28.1630400+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.7532ms (afa2e885)
2021-09-22T20:30:28.1631648+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.1633119+05:30 800000a5-0000-f900-b63f-84710c7967bb [INF] Request finished in 6.8197ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.1644447+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.1663411+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.1664999+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.1696361+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.1698975+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.1702090+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:28.1706789+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.016ms (afa2e885)
2021-09-22T20:30:28.1707567+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.1708671+05:30 80000015-0001-fe00-b63f-84710c7967bb [INF] Request finished in 14.9815ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.1756697+05:30 800000a4-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:28.1757965+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:28.1761572+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 27.2714ms (afa2e885)
2021-09-22T20:30:28.1762392+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.1759077+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:28.1806277+05:30 800000a4-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531491"", Request ID ""800000a4-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:28.1807417+05:30 800000a4-0002-fa00-b63f-84710c7967bb [INF] Request finished in 32.8089ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:28.1840457+05:30 800000a4-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T20:30:28.4389853+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:28.4390915+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.4392465+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.4394771+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.4424921+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:28.4516688+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.4539633+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.4591056+05:30 8000003d-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:28.4592388+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:28.4595619+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.0069ms (afa2e885)
2021-09-22T20:30:28.4596285+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.4610012+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:28.4610837+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.4617803+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:28.4619376+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.4620907+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.4626773+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:28.4628029+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.4629337+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.4634095+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.4649704+05:30 8000003d-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354556"", Request ID ""8000003d-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:28.4654367+05:30 8000003d-0003-fc00-b63f-84710c7967bb [INF] Request finished in 26.3974ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:28.4664066+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.4677090+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:28.4681486+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.9062ms (afa2e885)
2021-09-22T20:30:28.4682781+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.4684589+05:30 8000001d-0003-fb00-b63f-84710c7967bb [INF] Request finished in 9.203ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.4698701+05:30 8000003d-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:28.4699079+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:28.4716117+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.4735006+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.4762833+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.4766666+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:28.4773299+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.2739ms (afa2e885)
2021-09-22T20:30:28.4774181+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.4775433+05:30 800000a6-0002-fa00-b63f-84710c7967bb [INF] Request finished in 14.9331ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.7547314+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:28.7548678+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.7550009+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.7551300+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.7557230+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:28.7557835+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.7560287+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.7561341+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.7561813+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:28.7562114+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:28.7562654+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:28.7565838+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:28.7571400+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:28.7581123+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:28.7582371+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.7590625+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.7602248+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:28.7606202+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.4088ms (afa2e885)
2021-09-22T20:30:28.7606755+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.7607067+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.7608031+05:30 8000003f-0003-fc00-b63f-84710c7967bb [INF] Request finished in 5.1113ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.7630560+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:28.7633496+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:28.7637695+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 7.0586ms (afa2e885)
2021-09-22T20:30:28.7638404+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.7639521+05:30 80000017-0001-fe00-b63f-84710c7967bb [INF] Request finished in 7.7653ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:28.7641041+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:28.7655702+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:28.7688790+05:30 8000001f-0003-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:28.7690097+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:28.7690183+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:28.7694007+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.1741ms (afa2e885)
2021-09-22T20:30:28.7694786+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:28.7720399+05:30 8000001f-0003-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:30:29.0377806+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:29.0378350+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.0378980+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.0380019+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.0410233+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:29.0410292+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:29.0412078+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.0412076+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.0415592+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.0416618+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.0418188+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.0418096+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.0423354+05:30 800000a8-0002-fa00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:30:29.0431701+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:30:29.0438351+05:30 800000a8-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T20:30:29.0444112+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:29.0461529+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:29.0467359+05:30 8000001f-0003-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456118015426590"", Request ID ""8000001f-0003-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:29.0468552+05:30 8000001f-0003-fb00-b63f-84710c7967bb [INF] Request finished in 292.1438ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:29.0474587+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:29.1069736+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:30:29.1075087+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:29.1080324+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:30:29.1087067+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 66.5353ms (afa2e885)
2021-09-22T20:30:29.1087792+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 66.7598ms (afa2e885)
2021-09-22T20:30:29.1088088+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:29.1088283+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:29.1088010+05:30 800000a8-0002-fa00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:30:29.1089173+05:30 80000022-0002-f800-b63f-84710c7967bb [INF] Request finished in 67.9198ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:29.1089469+05:30 80000041-0003-fc00-b63f-84710c7967bb [INF] Request finished in 67.9435ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:29.1092687+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:30:29.1097965+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 71.7131ms (afa2e885)
2021-09-22T20:30:29.1098591+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:29.1099591+05:30 800000a8-0002-fa00-b63f-84710c7967bb [INF] Request finished in 72.1864ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:30:29.2720248+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:30:29.2720675+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.2721212+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.2721806+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.2737402+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:30:29.2767524+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:30:29.2777216+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:29.2805213+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:30:29.2805142+05:30 800000aa-0002-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:30:29.2806218+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:30:29.2808504+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 8.6243ms (afa2e885)
2021-09-22T20:30:29.2808858+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:29.2834209+05:30 800000aa-0002-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2021-09-22T20:30:29.3819037+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:30:29.3819348+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:30:29.3819629+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.3819642+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:30:29.3820229+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.3820192+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:30:29.3820933+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.3820929+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:30:29.3840514+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:30:29.3849558+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:30:29.3855068+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.3644ms (afa2e885)
2021-09-22T20:30:29.3855670+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:30:29.3856555+05:30 800000a7-0000-f900-b63f-84710c7967bb [INF] Request finished in 3.7243ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:30:29.3864224+05:30 800000aa-0002-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398519682531497"", Request ID ""800000aa-0002-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:30:29.3865011+05:30 800000aa-0002-fa00-b63f-84710c7967bb [INF] Request finished in 114.5016ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:30:59.3924397+05:30 80000043-0003-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,010"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T20:30:59.3958747+05:30 80000043-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 24
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11
2021-09-22T20:31:03.1166898+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 33734.4984ms (afa2e885)
2021-09-22T20:31:03.1169880+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:31:03.1190981+05:30 80000043-0003-fc00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 64
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 23
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11
2021-09-22T20:31:03.1214582+05:30 80000043-0003-fc00-b63f-84710c7967bb [INF] Request finished in 33739.5715ms 500 text/plain (791a596a)
2021-09-22T20:32:11.2803441+05:30 80000045-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:32:11.2804216+05:30 80000045-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2806321+05:30 80000045-0003-fc00-b63f-84710c7967bb [INF] Request finished in 0.3152ms 204  (791a596a)
2021-09-22T20:32:11.2813206+05:30 80000021-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:32:11.2813141+05:30 8000003c-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:32:11.2813731+05:30 80000021-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2814020+05:30 8000003c-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2815488+05:30 80000021-0003-fb00-b63f-84710c7967bb [INF] Request finished in 0.2363ms 204  (791a596a)
2021-09-22T20:32:11.2816150+05:30 8000003c-0007-ff00-b63f-84710c7967bb [INF] Request finished in 0.4104ms 204  (791a596a)
2021-09-22T20:32:11.2857640+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:32:11.2858704+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2859782+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.2860891+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.2867096+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:32:11.2867780+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2868708+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.2870905+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.2874132+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:32:11.2875259+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.2876459+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.2877423+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.2882809+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:32:11.2894311+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:32:11.2896315+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:32:11.2901254+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 3.985ms (afa2e885)
2021-09-22T20:32:11.2901771+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.2902523+05:30 80000033-0006-fc00-b63f-84710c7967bb [INF] Request finished in 4.5219ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:11.2905221+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:11.2993811+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:32:11.3091651+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:11.3092327+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:32:11.3094305+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:32:11.3095239+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:32:11.3099650+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 22.7648ms (afa2e885)
2021-09-22T20:32:11.3099408+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 22.1449ms (afa2e885)
2021-09-22T20:32:11.3100719+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.3100965+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.3102012+05:30 800000a9-0000-f900-b63f-84710c7967bb [INF] Request finished in 22.8168ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:11.3102000+05:30 8000005b-0005-fe00-b63f-84710c7967bb [INF] Request finished in 23.5207ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:11.9165371+05:30 8000005d-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:32:11.9165362+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:32:11.9166414+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:32:11.9168222+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.9169134+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.9169946+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.9170485+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.9172907+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.9173394+05:30 8000005d-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.9181411+05:30 8000005d-0005-fe00-b63f-84710c7967bb [INF] Request finished in 1.2923ms 204  (791a596a)
2021-09-22T20:32:11.9181435+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.9203219+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:11.9297306+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:32:11.9301839+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:32:11.9310029+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:32:11.9310457+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:32:11.9311243+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:11.9314024+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:11.9315893+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 13.2948ms (afa2e885)
2021-09-22T20:32:11.9315917+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:11.9316776+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.9318546+05:30 80000035-0006-fc00-b63f-84710c7967bb [INF] Request finished in 15.3537ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:11.9330429+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:11.9335452+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:32:11.9341284+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 16.689ms (afa2e885)
2021-09-22T20:32:11.9342389+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.9343956+05:30 80000020-0005-fd00-b63f-84710c7967bb [INF] Request finished in 17.8421ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:11.9451836+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:32:11.9511885+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:32:11.9538012+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:32:11.9567600+05:30 800000ab-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:32:11.9568580+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:32:11.9571226+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 25.4561ms (afa2e885)
2021-09-22T20:32:11.9571781+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:11.9601217+05:30 800000ab-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668970"", Request ID ""800000ab-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:32:11.9602397+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Request finished in 29.5347ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:32:11.9609321+05:30 800000ab-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:32:11.9646893+05:30 800000ab-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:32:12.1350666+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:32:12.1351243+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:12.1352030+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:12.1352936+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:12.1377351+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:32:12.1427134+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:32:12.1442444+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:32:12.1478201+05:30 8000003e-0007-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:32:12.1478389+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:32:12.1479139+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:32:12.1481959+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.8385ms (afa2e885)
2021-09-22T20:32:12.1482515+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:12.1510663+05:30 8000003e-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:32:12.2773480+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:32:12.2773883+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:32:12.2774106+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:12.2774159+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:32:12.2774711+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:12.2774712+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:32:12.2775439+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:12.2775487+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:32:12.2780073+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:32:12.2792496+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:12.2810491+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:32:12.2815500+05:30 8000003e-0007-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686511347007549"", Request ID ""8000003e-0007-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:32:12.2816106+05:30 8000003e-0007-ff00-b63f-84710c7967bb [INF] Request finished in 146.5883ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:32:12.2823514+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:32:12.2825861+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:32:12.2828916+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.2915ms (afa2e885)
2021-09-22T20:32:12.2829370+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:12.2830560+05:30 800000ad-0000-f900-b63f-84710c7967bb [INF] Request finished in 5.7293ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:32:42.2970740+05:30 80000037-0006-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,019"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:32:42.3070235+05:30 80000037-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11
2021-09-22T20:32:42.5156967+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30237.997ms (afa2e885)
2021-09-22T20:32:42.5161208+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:32:42.5213969+05:30 80000037-0006-fc00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:fb77bed2-501d-4400-8611-5dfbd0cdab84
Error Number:-2,State:0,Class:11
2021-09-22T20:32:42.5286231+05:30 80000037-0006-fc00-b63f-84710c7967bb [INF] Request finished in 30251.1895ms 500 text/plain (791a596a)
2021-09-22T20:34:23.3194237+05:30 80000023-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:34:23.3196926+05:30 80000023-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3201816+05:30 80000023-0003-fb00-b63f-84710c7967bb [INF] Request finished in 0.9642ms 204  (791a596a)
2021-09-22T20:34:23.3210593+05:30 80000039-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:34:23.3211521+05:30 80000039-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3213580+05:30 80000039-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.3192ms 204  (791a596a)
2021-09-22T20:34:23.3214848+05:30 80000025-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:34:23.3215886+05:30 80000025-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3220097+05:30 80000025-0003-fb00-b63f-84710c7967bb [INF] Request finished in 0.3593ms 204  (791a596a)
2021-09-22T20:34:23.3270536+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:34:23.3271831+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3273328+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.3274862+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.3287896+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:34:23.3288777+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3289708+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.3290891+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.3294255+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:34:23.3294758+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.3297838+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.3307784+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.3350058+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:34:23.3358068+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:34:23.3407761+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:34:23.3407744+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:34:23.3409682+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 13.4164ms (afa2e885)
2021-09-22T20:34:23.3410115+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.3411272+05:30 80000027-0003-fb00-b63f-84710c7967bb [INF] Request finished in 14.1072ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:23.3463759+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:34:23.3473935+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:34:23.3476527+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.823ms (afa2e885)
2021-09-22T20:34:23.3476995+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.3477996+05:30 800000ac-0002-fa00-b63f-84710c7967bb [INF] Request finished in 18.4037ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:23.3501850+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:34:23.3532801+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:34:23.3535611+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:34:23.3538532+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 24.6862ms (afa2e885)
2021-09-22T20:34:23.3539028+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.3539785+05:30 80000047-0003-fc00-b63f-84710c7967bb [INF] Request finished in 25.251ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:23.9681652+05:30 800000c5-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:34:23.9683326+05:30 800000c5-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.9685497+05:30 800000c5-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.4552ms 204  (791a596a)
2021-09-22T20:34:23.9723777+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:34:23.9724831+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.9726029+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.9727889+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.9734236+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:34:23.9734348+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:34:23.9734856+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.9738821+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.9746001+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:23.9745904+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.9747360+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:34:23.9752841+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:23.9759962+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:23.9760238+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:34:23.9763887+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.5387ms (afa2e885)
2021-09-22T20:34:23.9764499+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.9765678+05:30 800000c7-0004-fb00-b63f-84710c7967bb [INF] Request finished in 4.2303ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:23.9773403+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:34:23.9786333+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:34:23.9799707+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:34:23.9809477+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:34:23.9811784+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:34:23.9815392+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.466ms (afa2e885)
2021-09-22T20:34:23.9815814+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.9816974+05:30 8000003b-0006-fc00-b63f-84710c7967bb [INF] Request finished in 8.3019ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:23.9848686+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:34:23.9868117+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:34:23.9890725+05:30 80000045-0004-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:34:23.9891849+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:34:23.9894042+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.6599ms (afa2e885)
2021-09-22T20:34:23.9894470+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:23.9912527+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:34:23.9914896+05:30 80000045-0004-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398528272465988"", Request ID ""80000045-0004-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:34:23.9915555+05:30 80000045-0004-fa00-b63f-84710c7967bb [INF] Request finished in 18.1219ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:34:23.9939554+05:30 80000045-0004-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:34:24.2096484+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:34:24.2097617+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:24.2098920+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:24.2100595+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:24.2124869+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:34:24.2171298+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:34:24.2187613+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:34:24.2229785+05:30 80000049-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:34:24.2231261+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:34:24.2231236+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:34:24.2235125+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 13.3626ms (afa2e885)
2021-09-22T20:34:24.2236106+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:24.2277439+05:30 80000049-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:34:24.6747213+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:34:24.6747982+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:24.6748872+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:24.6748977+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:34:24.6749421+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:34:24.6749824+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:24.6750370+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:34:24.6751052+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:34:24.6754724+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:34:24.6782464+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:34:24.6791058+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:34:24.6794406+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.282ms (afa2e885)
2021-09-22T20:34:24.6795184+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:24.6796512+05:30 80000054-0000-fa00-b63f-84710c7967bb [INF] Request finished in 4.7829ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:34:24.6799849+05:30 80000049-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354568"", Request ID ""80000049-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:34:24.6800679+05:30 80000049-0003-fc00-b63f-84710c7967bb [INF] Request finished in 470.4705ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:34:54.6855415+05:30 80000022-0005-fd00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,010"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T20:34:54.6874402+05:30 80000022-0005-fd00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 24
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11
2021-09-22T20:34:56.8982907+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 32223.0999ms (afa2e885)
2021-09-22T20:34:56.8986151+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:34:56.9006643+05:30 80000022-0005-fd00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 64
   at IoT.BusinessLayer.UserBL.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 23
   at IoT.WebAPI.Controllers.UserController.AddUser(User user) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 37
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:21bec15d-3b83-4882-9a67-edf8db20e98d
Error Number:-2,State:0,Class:11
2021-09-22T20:34:56.9026004+05:30 80000022-0005-fd00-b63f-84710c7967bb [INF] Request finished in 32227.8951ms 500 text/plain (791a596a)
2021-09-22T20:35:02.4411341+05:30 800000ae-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:35:02.4412380+05:30 800000ae-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4414735+05:30 800000ae-0002-fa00-b63f-84710c7967bb [INF] Request finished in 0.3524ms 204  (791a596a)
2021-09-22T20:35:02.4423481+05:30 80000047-0004-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:02.4424991+05:30 80000047-0004-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4427076+05:30 80000047-0004-fa00-b63f-84710c7967bb [INF] Request finished in 0.4181ms 204  (791a596a)
2021-09-22T20:35:02.4428018+05:30 800000c9-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:35:02.4428423+05:30 800000c9-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4429469+05:30 800000c9-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.1568ms 204  (791a596a)
2021-09-22T20:35:02.4466280+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:35:02.4467145+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4468753+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:02.4469819+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:02.4471195+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:02.4471578+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4472191+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:02.4474306+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:02.4478123+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:02.4478659+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:02.4479454+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:02.4480362+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:02.4484996+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:35:02.4496411+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:35:02.4498011+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:35:02.4500716+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:02.4501469+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 3.0768ms (afa2e885)
2021-09-22T20:35:02.4501935+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:02.4503299+05:30 800000b0-0002-fa00-b63f-84710c7967bb [INF] Request finished in 3.8061ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:02.4585160+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:02.4644614+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:02.4645708+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:02.4647205+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:02.4647317+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:02.4649996+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.5243ms (afa2e885)
2021-09-22T20:35:02.4649988+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 16.9162ms (afa2e885)
2021-09-22T20:35:02.4650490+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:02.4650815+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:02.4652250+05:30 80000024-0005-fd00-b63f-84710c7967bb [INF] Request finished in 18.1685ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:02.4663428+05:30 80000056-0000-fa00-b63f-84710c7967bb [INF] Request finished in 17.4727ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.1021412+05:30 800000cb-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:35:03.1022606+05:30 800000cb-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.1024424+05:30 800000cb-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.3754ms 204  (791a596a)
2021-09-22T20:35:03.1086523+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:03.1087268+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.1087969+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.1088954+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.1114931+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:03.1114932+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:03.1115495+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.1115846+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.1116327+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.1116853+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.1117371+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.1117634+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.1130032+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:35:03.1139992+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:03.1146712+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:03.1152968+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.482ms (afa2e885)
2021-09-22T20:35:03.1153533+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.1154599+05:30 8000000e-0007-fe00-b63f-84710c7967bb [INF] Request finished in 4.0203ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.1191915+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:03.1199091+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.1207272+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:03.1219274+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.1221714+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:03.1224940+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.7098ms (afa2e885)
2021-09-22T20:35:03.1225377+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.1226013+05:30 80000042-0007-ff00-b63f-84710c7967bb [INF] Request finished in 11.1638ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.1229415+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:03.1260068+05:30 8000003d-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:35:03.1261504+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:35:03.1263840+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 17.4273ms (afa2e885)
2021-09-22T20:35:03.1264224+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.1288939+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:35:03.1289462+05:30 8000003d-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256444"", Request ID ""8000003d-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:35:03.1290132+05:30 8000003d-0006-fc00-b63f-84710c7967bb [INF] Request finished in 20.3978ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:35:03.1314639+05:30 8000003d-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:35:03.4480849+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:03.4482152+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.4483138+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.4484385+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.4511132+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:03.4511069+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:35:03.4511933+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.4512189+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:03.4512651+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.4512956+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.4513296+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.4513834+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.4513957+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.4519479+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:35:03.4529065+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:03.4537433+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.4537863+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:03.4548457+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.3915ms (afa2e885)
2021-09-22T20:35:03.4550277+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.4554145+05:30 800000b2-0002-fa00-b63f-84710c7967bb [INF] Request finished in 4.3115ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.4557412+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:03.4568796+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:03.4585089+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.4585089+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:03.4587436+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:03.4590551+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 7.6037ms (afa2e885)
2021-09-22T20:35:03.4591016+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.4591939+05:30 8000004b-0003-fc00-b63f-84710c7967bb [INF] Request finished in 7.9968ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.4616132+05:30 80000044-0007-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:35:03.4617492+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:35:03.4618125+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:35:03.4619616+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 13.4625ms (afa2e885)
2021-09-22T20:35:03.4619954+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.4641657+05:30 80000044-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:35:03.7908647+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:03.7909413+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.7910237+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.7911974+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.7933266+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:03.7933498+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:03.7933921+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.7933924+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:03.7934581+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.7934601+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:03.7935408+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.7935510+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:03.7947214+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:35:03.7955873+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:03.7958146+05:30 80000058-0000-fa00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:35:03.7965898+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.7968192+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:03.7975494+05:30 80000058-0000-fa00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T20:35:03.7977343+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.9717ms (afa2e885)
2021-09-22T20:35:03.7990583+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.7990963+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:03.7991969+05:30 80000002-0000-f700-b63f-84710c7967bb [INF] Request finished in 5.884ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.8111783+05:30 80000044-0007-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686511347007555"", Request ID ""80000044-0007-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:35:03.8231191+05:30 80000044-0007-ff00-b63f-84710c7967bb [INF] Request finished in 363.3037ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:35:03.8237490+05:30 80000058-0000-fa00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:35:03.8239810+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:35:03.8239900+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:03.8242863+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 33.0328ms (afa2e885)
2021-09-22T20:35:03.8242793+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:03.8243180+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.8245200+05:30 80000058-0000-fa00-b63f-84710c7967bb [INF] Request finished in 33.5805ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:35:03.8247905+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 30.9763ms (afa2e885)
2021-09-22T20:35:03.8249165+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:03.8250474+05:30 80000002-0000-f800-b63f-84710c7967bb [INF] Request finished in 31.7052ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.1794353+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:04.1795245+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.1796253+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.1797685+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.1816003+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:35:04.1869660+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.1876535+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:04.1878313+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.1878728+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:04.1879679+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.1881245+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.1881352+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.1881832+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.1882595+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.1910508+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.1915738+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.1918350+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:04.1921593+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.9689ms (afa2e885)
2021-09-22T20:35:04.1923030+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.1924936+05:30 800000b4-0002-fa00-b63f-84710c7967bb [INF] Request finished in 4.8883ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.1955666+05:30 8000005a-0000-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:35:04.1956791+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:35:04.1960134+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 16.1714ms (afa2e885)
2021-09-22T20:35:04.1960539+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.1957816+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:35:04.1992018+05:30 8000005a-0000-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398511092596825"", Request ID ""8000005a-0000-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:35:04.1992809+05:30 8000005a-0000-fa00-b63f-84710c7967bb [INF] Request finished in 19.8981ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:35:04.2005439+05:30 8000005a-0000-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:35:04.2136800+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.2146907+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.2161529+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.2164261+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:04.2167457+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 28.4292ms (afa2e885)
2021-09-22T20:35:04.2167963+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.2169126+05:30 80000024-0002-f800-b63f-84710c7967bb [INF] Request finished in 29.056ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.5259076+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:04.5265827+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.5267043+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.5270208+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.5324767+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:35:04.5326098+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:04.5326717+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.5327453+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.5328428+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.5333992+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:04.5334571+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.5335503+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.5336628+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.5341254+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:35:04.5346051+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.5394957+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.5395041+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.5451359+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.5451375+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.5454458+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:04.5504646+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 17.3797ms (afa2e885)
2021-09-22T20:35:04.5515510+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.5525826+05:30 80000026-0005-fd00-b63f-84710c7967bb [INF] Request finished in 19.9736ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.5535134+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.5571673+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:35:04.5573513+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:04.5574418+05:30 8000001b-0001-fe00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:35:04.5576379+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:35:04.5576551+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 23.9382ms (afa2e885)
2021-09-22T20:35:04.5576952+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.5578914+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 30.8135ms (afa2e885)
2021-09-22T20:35:04.5579427+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.5579876+05:30 8000005f-0005-fe00-b63f-84710c7967bb [INF] Request finished in 24.6026ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.5622312+05:30 8000001b-0001-fe00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:35:04.7499044+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:04.7500184+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.7501908+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.7504392+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.7561601+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:04.7564877+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:04.7566638+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.7567490+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.7568218+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.7569851+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.7573605+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.7574279+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.7579297+05:30 8000003f-0006-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:35:04.7589566+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:35:04.7602687+05:30 8000003f-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T20:35:04.7623208+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.7867501+05:30 8000001b-0001-fe00-b63f-84710c7967bb [ERR] Connection ID ""18302628891539275802"", Request ID ""8000001b-0001-fe00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:35:04.7869233+05:30 8000001b-0001-fe00-b63f-84710c7967bb [INF] Request finished in 261.0407ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:35:04.8134266+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:35:04.8158440+05:30 8000003f-0006-fc00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:35:04.8161802+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:35:04.8225528+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 65.0416ms (afa2e885)
2021-09-22T20:35:04.8225687+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 72.0391ms (afa2e885)
2021-09-22T20:35:04.8226540+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.8226628+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.8227741+05:30 8000003f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 72.9242ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.8228213+05:30 80000026-0002-f800-b63f-84710c7967bb [INF] Request finished in 66.4379ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.8293059+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.8471007+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.8557138+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:04.8561455+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:04.8568761+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 99.3626ms (afa2e885)
2021-09-22T20:35:04.8569482+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.8570488+05:30 8000005c-0000-fa00-b63f-84710c7967bb [INF] Request finished in 101.1869ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:04.9860290+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:35:04.9860826+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:04.9861602+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:04.9862431+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:04.9876961+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:35:04.9905169+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:04.9918748+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:35:04.9943813+05:30 800000cd-0004-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:35:04.9944479+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:35:04.9944667+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:35:04.9946840+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 8.3924ms (afa2e885)
2021-09-22T20:35:04.9947242+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:04.9971103+05:30 800000cd-0004-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:35:05.0972398+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:35:05.0972371+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:35:05.0972820+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:05.0972823+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:35:05.0973383+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:05.0973445+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:35:05.0973995+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:05.0974015+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:35:05.0986829+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:05.1009467+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:35:05.1019077+05:30 800000cd-0004-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456122310394060"", Request ID ""800000cd-0004-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:35:05.1019916+05:30 800000cd-0004-fb00-b63f-84710c7967bb [INF] Request finished in 116.0031ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:35:05.1026267+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:35:05.1028737+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:35:05.1036058+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 6.1235ms (afa2e885)
2021-09-22T20:35:05.1036867+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:05.1037802+05:30 80000028-0002-f800-b63f-84710c7967bb [INF] Request finished in 6.5549ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:35:35.1108715+05:30 80000061-0005-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,013"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:35:35.1201380+05:30 80000061-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:35:35.2913279+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30193.8459ms (afa2e885)
2021-09-22T20:35:35.2915996+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:35:35.2963456+05:30 80000061-0005-fe00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:35:35.3018650+05:30 80000061-0005-fe00-b63f-84710c7967bb [INF] Request finished in 30204.5975ms 500 text/plain (791a596a)
2021-09-22T20:37:00.5446473+05:30 8000001d-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:00.5448852+05:30 8000001d-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5451047+05:30 8000001d-0001-fe00-b63f-84710c7967bb [INF] Request finished in 0.662ms 204  (791a596a)
2021-09-22T20:37:00.5458781+05:30 80000063-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:00.5468452+05:30 80000063-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5470805+05:30 80000063-0005-fe00-b63f-84710c7967bb [INF] Request finished in 1.265ms 204  (791a596a)
2021-09-22T20:37:00.5483406+05:30 800000d1-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:37:00.5484153+05:30 800000d1-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5486502+05:30 800000d1-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.3456ms 204  (791a596a)
2021-09-22T20:37:00.5593135+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:00.5614639+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:00.5615377+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5614238+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:00.5615966+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5616651+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:00.5616932+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:00.5595755+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:00.5617798+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:00.5617901+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:00.5617760+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:00.5618758+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:00.5661139+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:00.5736624+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:00.5779662+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("13"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:00.5788822+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:00.5792943+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 17.4411ms (afa2e885)
2021-09-22T20:37:00.5807086+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:37:00.5807614+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:00.5810037+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:37:00.5810182+05:30 80000065-0005-fe00-b63f-84710c7967bb [INF] Request finished in 21.3399ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:00.5852012+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 23.2518ms (afa2e885)
2021-09-22T20:37:00.5852666+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:00.5853636+05:30 800000b1-0000-f900-b63f-84710c7967bb [INF] Request finished in 26.1067ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:00.5940859+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:00.5967689+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:00.5970777+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:00.5974099+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 35.5743ms (afa2e885)
2021-09-22T20:37:00.5974597+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:00.5975290+05:30 80000041-0006-fc00-b63f-84710c7967bb [INF] Request finished in 37.9203ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:01.1255124+05:30 800000d3-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:37:01.1256208+05:30 800000d3-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.1259149+05:30 800000d3-0004-fb00-b63f-84710c7967bb [INF] Request finished in 0.4479ms 204  (791a596a)
2021-09-22T20:37:01.1302195+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:01.1302944+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.1303769+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.1304867+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.1337131+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:01.1337823+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.1338690+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.1339772+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.1345878+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:01.1383631+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:01.1390016+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:01.1390233+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:01.1390493+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.1392261+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.1392931+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.2453ms (afa2e885)
2021-09-22T20:37:01.1393206+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.1393340+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.1394709+05:30 8000001f-0001-fe00-b63f-84710c7967bb [INF] Request finished in 5.8106ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:01.1429799+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:01.1764640+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("34"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:01.2314292+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("88"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:01.2314935+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("54"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:01.2369099+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:01.2369047+05:30 8000004d-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:01.2370575+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:01.2374442+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:01.2374521+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 106.8768ms (afa2e885)
2021-09-22T20:37:01.2375250+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.2378301+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 98.4564ms (afa2e885)
2021-09-22T20:37:01.2378982+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.2381241+05:30 80000057-0001-ff00-b63f-84710c7967bb [INF] Request finished in 98.9985ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:01.2412877+05:30 8000004d-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354572"", Request ID ""8000004d-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:01.2413791+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Request finished in 111.1936ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:01.2417369+05:30 8000004d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:01.2467958+05:30 8000004d-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:01.3592782+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:01.3593468+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.3594160+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.3595521+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.3653251+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:01.3708143+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:01.3757844+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:01.3776924+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:01.3777746+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.3778654+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.3779876+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.3793803+05:30 80000043-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:01.3794529+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:01.3794890+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:01.3795100+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.3803961+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 20.7505ms (afa2e885)
2021-09-22T20:37:01.3804684+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.3807978+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.3816784+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.3824661+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:01.3826310+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:01.3845869+05:30 80000043-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256450"", Request ID ""80000043-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:01.3848310+05:30 80000043-0006-fc00-b63f-84710c7967bb [INF] Request finished in 25.476ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:01.3855827+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:01.3857690+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:01.3864230+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:01.3866842+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 8.646ms (afa2e885)
2021-09-22T20:37:01.3867382+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.3868247+05:30 80000025-0006-fd00-b63f-84710c7967bb [INF] Request finished in 9.1831ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:01.3880610+05:30 80000043-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:01.3918877+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:01.3949489+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:01.3952118+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:01.3955509+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.7722ms (afa2e885)
2021-09-22T20:37:01.3955975+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:01.3957069+05:30 80000059-0001-ff00-b63f-84710c7967bb [INF] Request finished in 16.2638ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:01.9811184+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:01.9812543+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:01.9813432+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:01.9814336+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:01.9854337+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:01.9951763+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.0007943+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.0053168+05:30 80000046-0007-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:02.0054401+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:02.0057808+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 24.2886ms (afa2e885)
2021-09-22T20:37:02.0058191+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.0097351+05:30 80000046-0007-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686511347007557"", Request ID ""80000046-0007-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:02.0098200+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Request finished in 28.7356ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:02.0102003+05:30 80000046-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:02.0151101+05:30 80000046-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:02.0469689+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:02.0470266+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.0470865+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.0471791+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.0476137+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:02.0476498+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.0477157+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.0477814+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.0481117+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:02.0547903+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.0584368+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.0588672+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:02.0597070+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 11.7876ms (afa2e885)
2021-09-22T20:37:02.0597892+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.0599016+05:30 80000029-0003-fb00-b63f-84710c7967bb [INF] Request finished in 12.306ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.0634832+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.0658487+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.0661493+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:02.0665069+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 19.2803ms (afa2e885)
2021-09-22T20:37:02.0665589+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.0666212+05:30 8000004f-0003-fc00-b63f-84710c7967bb [INF] Request finished in 19.686ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.5561630+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:02.5562593+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.5563871+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.5568987+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.5609450+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:02.5643292+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.5660531+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.5682024+05:30 8000002a-0002-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:02.5682855+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:02.5684434+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 11.4776ms (afa2e885)
2021-09-22T20:37:02.5684776+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.5702743+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:02.5704601+05:30 8000002a-0002-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283331606675497"", Request ID ""8000002a-0002-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:02.5705164+05:30 8000002a-0002-f800-b63f-84710c7967bb [INF] Request finished in 14.657ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:02.5735560+05:30 8000002a-0002-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:02.6103346+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:02.6103646+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:02.6104274+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.6104327+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.6105484+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.6106252+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.6107265+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.6107903+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.6115838+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:02.6128450+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.6157192+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.6165890+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.6171908+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:02.6180524+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.0876ms (afa2e885)
2021-09-22T20:37:02.6181392+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.6183061+05:30 80000048-0007-ff00-b63f-84710c7967bb [INF] Request finished in 7.949ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.6211176+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.6214610+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:02.6219337+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.1304ms (afa2e885)
2021-09-22T20:37:02.6219924+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.6220680+05:30 80000010-0007-fe00-b63f-84710c7967bb [INF] Request finished in 11.8232ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.7755788+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:02.7756498+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.7757266+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.7758490+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.7779161+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:02.7796474+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:02.7797920+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.7798750+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.7800017+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.7808629+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:02.7809204+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:02.7810344+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:02.7811524+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:02.7815142+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.7816124+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:02.7816269+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.7830821+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.7837759+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:02.7837663+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:02.7842046+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:02.7850166+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.6773ms (afa2e885)
2021-09-22T20:37:02.7850910+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.7852317+05:30 8000002b-0003-fb00-b63f-84710c7967bb [INF] Request finished in 4.4421ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.7857427+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:02.7860551+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:02.7864371+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 6.366ms (afa2e885)
2021-09-22T20:37:02.7864833+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.7873478+05:30 80000051-0003-fc00-b63f-84710c7967bb [INF] Request finished in 7.5011ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:02.7879013+05:30 80000027-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:02.7880110+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:02.7884412+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.4996ms (afa2e885)
2021-09-22T20:37:02.7884422+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:02.7885001+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:02.7925992+05:30 80000027-0006-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571318976184358"", Request ID ""80000027-0006-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:02.7928257+05:30 80000027-0006-fd00-b63f-84710c7967bb [INF] Request finished in 17.2621ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:02.7942371+05:30 80000027-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:03.1499100+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:03.1499619+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.1500255+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.1500975+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.1522326+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:03.1523021+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.1523715+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.1524761+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.1525188+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:03.1525938+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:03.1526351+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.1527025+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.1527886+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.1531758+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:03.1533891+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:03.1545531+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:03.1554614+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:03.1555544+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:03.1558940+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.055ms (afa2e885)
2021-09-22T20:37:03.1559882+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.1561017+05:30 8000002c-0002-f800-b63f-84710c7967bb [INF] Request finished in 3.5103ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:03.1572569+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:03.1572622+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:03.1574996+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:03.1578789+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.3298ms (afa2e885)
2021-09-22T20:37:03.1579222+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.1580028+05:30 8000005e-0000-fa00-b63f-84710c7967bb [INF] Request finished in 5.7926ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:03.1610852+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:03.1635777+05:30 800000b3-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:03.1636671+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:03.1636497+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:03.1639097+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 13.7632ms (afa2e885)
2021-09-22T20:37:03.1639497+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.1660477+05:30 800000b3-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:03.5523664+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:03.5524314+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.5525235+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.5526175+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.5542503+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:03.5542503+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:03.5543138+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.5543382+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:03.5543967+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.5544013+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:03.5544840+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.5544989+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:03.5548927+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:03.5554232+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:03.5575308+05:30 80000060-0000-fa00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:37:03.5576701+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:03.5575851+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:03.5589794+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:03.5601366+05:30 80000060-0000-fa00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2021-09-22T20:37:03.5636555+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 9.0897ms (afa2e885)
2021-09-22T20:37:03.5636651+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:03.5644535+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.5649677+05:30 8000002d-0003-fb00-b63f-84710c7967bb [INF] Request finished in 10.726ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:03.5650672+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:03.5772597+05:30 800000b3-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668978"", Request ID ""800000b3-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:03.5773158+05:30 800000b3-0000-f900-b63f-84710c7967bb [INF] Request finished in 427.425ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:03.5810715+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 26.5175ms (afa2e885)
2021-09-22T20:37:03.5811175+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.5811670+05:30 80000053-0003-fc00-b63f-84710c7967bb [INF] Request finished in 26.9485ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:03.5947719+05:30 80000060-0000-fa00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:03.5949978+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:37:03.5953718+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 42.6977ms (afa2e885)
2021-09-22T20:37:03.5954225+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:03.5955143+05:30 80000060-0000-fa00-b63f-84710c7967bb [INF] Request finished in 43.1747ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.0216161+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:04.0220506+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.0223275+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.0232095+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.0302894+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:04.0333575+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:04.0334916+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:04.0335788+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.0335908+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.0337184+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.0337176+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.0338860+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.0338878+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.0360482+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.0364213+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.0392181+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.0389374+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:04.0407450+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.0434022+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 9.4218ms (afa2e885)
2021-09-22T20:37:04.0435176+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.0437084+05:30 80000067-0005-fe00-b63f-84710c7967bb [INF] Request finished in 10.3897ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.0443031+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.0443884+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.0446532+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:04.0451532+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.1855ms (afa2e885)
2021-09-22T20:37:04.0452398+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.0453501+05:30 8000002e-0002-f800-b63f-84710c7967bb [INF] Request finished in 11.8872ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.0517060+05:30 80000062-0000-fa00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:04.0517477+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:04.0518853+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:04.0522718+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 28.8857ms (afa2e885)
2021-09-22T20:37:04.0523458+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.0570745+05:30 80000062-0000-fa00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:04.2888076+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:04.2889398+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.2896980+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.2900881+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.3008769+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:04.3012757+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.3017074+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:04.3019513+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.3020042+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.3023916+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.3026397+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.3027513+05:30 800000b5-0000-f900-b63f-84710c7967bb [ERR] Failed executing DbCommand ("11"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:37:04.3028501+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.3041797+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:04.3100726+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.3100919+05:30 80000062-0000-fa00-b63f-84710c7967bb [ERR] Connection ID ""18014398511092596833"", Request ID ""80000062-0000-fa00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:04.3103700+05:30 80000062-0000-fa00-b63f-84710c7967bb [INF] Request finished in 288.7962ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:04.3106801+05:30 800000b5-0000-f900-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:04.3113565+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:04.3479030+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 45.1206ms (afa2e885)
2021-09-22T20:37:04.3480083+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.3483079+05:30 80000030-0002-f800-b63f-84710c7967bb [INF] Request finished in 47.5217ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.3732035+05:30 800000b5-0000-f900-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:04.3735011+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:37:04.3740596+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 83.842ms (afa2e885)
2021-09-22T20:37:04.3741106+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.3741940+05:30 800000b5-0000-f900-b63f-84710c7967bb [INF] Request finished in 85.5005ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.3790212+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.3801107+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.3825598+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.3827769+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:04.3830475+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 79.8975ms (afa2e885)
2021-09-22T20:37:04.3830856+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.3831546+05:30 800000b6-0002-fa00-b63f-84710c7967bb [INF] Request finished in 82.4177ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.6993255+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:04.6994471+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.6996197+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.6997816+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.7019284+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:04.7024314+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:04.7024883+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.7025518+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:04.7025553+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.7025910+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.7026371+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.7026500+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.7027112+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.7050782+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.7054081+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:04.7065037+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.7104ms (afa2e885)
2021-09-22T20:37:04.7065772+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.7066803+05:30 800000d5-0004-fb00-b63f-84710c7967bb [INF] Request finished in 4.1303ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.7079247+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.7115484+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.7116070+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.7123900+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.7139066+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.7141510+05:30 80000029-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:04.7142617+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:04.7142969+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:04.7144867+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.6169ms (afa2e885)
2021-09-22T20:37:04.7145037+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.8334ms (afa2e885)
2021-09-22T20:37:04.7145305+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.7145305+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.7146772+05:30 80000069-0005-fe00-b63f-84710c7967bb [INF] Request finished in 12.1983ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.7167401+05:30 80000029-0006-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571318976184360"", Request ID ""80000029-0006-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:04.7168264+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Request finished in 17.5273ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:04.7184414+05:30 80000029-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:04.7219619+05:30 80000029-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:04.9218201+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:04.9218689+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.9219261+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.9219875+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.9242184+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:04.9244195+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:04.9244666+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.9245088+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:04.9245202+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.9245461+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:04.9245973+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:04.9246448+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.9246578+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:04.9251979+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:04.9294298+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.9302781+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.9313064+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:04.9315859+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.9316139+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 6.916ms (afa2e885)
2021-09-22T20:37:04.9316638+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.9317469+05:30 80000055-0003-fc00-b63f-84710c7967bb [INF] Request finished in 7.2453ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.9330686+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:04.9341200+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:04.9343476+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:04.9345878+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 9.8862ms (afa2e885)
2021-09-22T20:37:04.9346208+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.9346843+05:30 800000b8-0002-fa00-b63f-84710c7967bb [INF] Request finished in 10.2817ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:04.9662912+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:04.9707796+05:30 8000002b-0006-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:04.9708452+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:04.9709083+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:04.9712975+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 49.2291ms (afa2e885)
2021-09-22T20:37:04.9713913+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:04.9758762+05:30 8000002b-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:05.2733136+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:05.2733709+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.2734589+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.2735598+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.2763202+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:05.2763388+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:05.2763907+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.2763859+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.2765599+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.2766200+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.2766739+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.2767992+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.2776977+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:05.2866902+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("9"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:05.2866967+05:30 80000012-0007-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:37:05.2884305+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:05.2890095+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:05.2890184+05:30 80000012-0007-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
2021-09-22T20:37:05.2892857+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:05.2893124+05:30 8000002b-0006-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571318976184362"", Request ID ""8000002b-0006-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:05.2893741+05:30 8000002b-0006-fd00-b63f-84710c7967bb [INF] Request finished in 367.5941ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:05.3029159+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 26.0312ms (afa2e885)
2021-09-22T20:37:05.3029611+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:05.3030467+05:30 800000b7-0000-f900-b63f-84710c7967bb [INF] Request finished in 26.8716ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:05.3153456+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:05.3157239+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:05.3158361+05:30 80000012-0007-fe00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:05.3160253+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 39.2951ms (afa2e885)
2021-09-22T20:37:05.3160641+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:05.3161167+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:37:05.3161361+05:30 8000004a-0007-ff00-b63f-84710c7967bb [INF] Request finished in 39.982ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:05.3165509+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 42.9301ms (afa2e885)
2021-09-22T20:37:05.3166018+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:05.3167151+05:30 80000012-0007-fe00-b63f-84710c7967bb [INF] Request finished in 43.4323ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:37:05.5472763+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:05.5473676+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.5474538+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.5475613+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.5535338+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:05.5567081+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:05.5588320+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:05.5611866+05:30 80000057-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:05.5612028+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:05.5612667+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:05.5614590+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 13.8541ms (afa2e885)
2021-09-22T20:37:05.5614963+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:05.5642545+05:30 80000057-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:05.6562438+05:30 8000004c-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:05.6563225+05:30 8000004c-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.6563940+05:30 800000ba-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:37:05.6564380+05:30 800000ba-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.6564855+05:30 8000004c-0007-ff00-b63f-84710c7967bb [INF] Request finished in 0.2867ms 204  (791a596a)
2021-09-22T20:37:05.6565185+05:30 800000ba-0002-fa00-b63f-84710c7967bb [INF] Request finished in 0.1498ms 204  (791a596a)
2021-09-22T20:37:05.6603225+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:05.6603793+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.6603899+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:05.6604112+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:05.6604405+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.6604513+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:05.6605083+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.6605083+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:05.6614806+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:05.6636431+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:05.6643256+05:30 80000057-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354582"", Request ID ""80000057-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:05.6643790+05:30 80000057-0003-fc00-b63f-84710c7967bb [INF] Request finished in 117.1746ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:05.6646947+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:05.6649293+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:05.6652488+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 4.6867ms (afa2e885)
2021-09-22T20:37:05.6652958+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:05.6653878+05:30 8000004e-0007-ff00-b63f-84710c7967bb [INF] Request finished in 5.1232ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:35.6763297+05:30 8000002d-0006-fd00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,015"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:37:35.6816057+05:30 8000002d-0006-fd00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:37:35.8966562+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30236.0818ms (afa2e885)
2021-09-22T20:37:35.8968468+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:35.9000204+05:30 8000002d-0006-fd00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:37:35.9033407+05:30 8000002d-0006-fd00-b63f-84710c7967bb [INF] Request finished in 30242.8972ms 500 text/plain (791a596a)
2021-09-22T20:37:37.7705924+05:30 8000005b-0001-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:37.7706820+05:30 8000005b-0001-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7708514+05:30 8000005b-0001-ff00-b63f-84710c7967bb [INF] Request finished in 0.3138ms 204  (791a596a)
2021-09-22T20:37:37.7711290+05:30 80000018-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:37:37.7711350+05:30 80000021-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:37.7711813+05:30 80000018-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7711890+05:30 80000021-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7713043+05:30 80000021-0001-fe00-b63f-84710c7967bb [INF] Request finished in 0.1889ms 204  (791a596a)
2021-09-22T20:37:37.7713032+05:30 80000018-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.1885ms 204  (791a596a)
2021-09-22T20:37:37.7777997+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:37.7778075+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:37.7778654+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7778609+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7779712+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:37.7779715+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:37.7780640+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:37.7780622+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:37.7782650+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:37.7783152+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:37.7783853+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:37.7784602+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:37.7790665+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:37.7796929+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:37.7816073+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:37.7822991+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:37:37.7829508+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:37:37.7853869+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 7.0817ms (afa2e885)
2021-09-22T20:37:37.7854610+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:37.7866341+05:30 800000bc-0002-fa00-b63f-84710c7967bb [INF] Request finished in 8.8221ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:37.7871358+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:37.7874418+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:37.8002231+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.8105ms (afa2e885)
2021-09-22T20:37:37.8017690+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:37.8021671+05:30 80000032-0002-f800-b63f-84710c7967bb [INF] Request finished in 24.327ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:37.8144311+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("10"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:37.8219205+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:37.8222589+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 43.7416ms (afa2e885)
2021-09-22T20:37:37.8223490+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:37.8224796+05:30 80000075-0002-fb00-b63f-84710c7967bb [INF] Request finished in 44.2283ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.3447791+05:30 800000b9-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:37:38.3450066+05:30 800000b9-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.3452510+05:30 800000b9-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.6366ms 204  (791a596a)
2021-09-22T20:37:38.3506513+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:38.3507453+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.3508831+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.3509780+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:38.3509982+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.3510960+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.3512005+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.3513217+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.3543648+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:38.3545916+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.3547934+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.3549957+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.3572778+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:38.3579945+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:38.3588044+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:38.3595012+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 8.4295ms (afa2e885)
2021-09-22T20:37:38.3595841+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.3597063+05:30 8000002f-0006-fd00-b63f-84710c7967bb [INF] Request finished in 9.2419ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.3607170+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:38.3636767+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:38.3639773+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:38.3643724+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.474ms (afa2e885)
2021-09-22T20:37:38.3644375+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.3645941+05:30 80000050-0007-ff00-b63f-84710c7967bb [INF] Request finished in 13.661ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.3668610+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:38.3718495+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:38.3729074+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:38.3758239+05:30 80000045-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:38.3758602+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:38.3759185+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:38.3761349+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 21.0851ms (afa2e885)
2021-09-22T20:37:38.3761850+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.3787047+05:30 80000045-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:38.5458593+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:38.5459651+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.5460949+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.5462321+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.5530645+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:38.5533531+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.5537115+05:30 8000006b-0005-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:37:38.5532223+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:38.5541235+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.5541887+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.5544964+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.5545480+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.5546704+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.5548492+05:30 8000006b-0005-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:38.5566688+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:38.5809956+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("23"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:38.5810530+05:30 80000045-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256452"", Request ID ""80000045-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:38.5811522+05:30 80000045-0006-fc00-b63f-84710c7967bb [INF] Request finished in 226.8221ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:38.6106358+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("28"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:38.6109387+05:30 8000006b-0005-fe00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:37:38.6112105+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:37:38.6113392+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:38.6117858+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 65.4735ms (afa2e885)
2021-09-22T20:37:38.6118262+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:38.6118584+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.6118624+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 57.1133ms (afa2e885)
2021-09-22T20:37:38.6119455+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.6119459+05:30 8000006b-0005-fe00-b63f-84710c7967bb [INF] Request finished in 66.1519ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.6123281+05:30 80000023-0001-fe00-b63f-84710c7967bb [INF] Request finished in 59.2938ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.6148343+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:38.6152286+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:38.6157152+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 61.1114ms (afa2e885)
2021-09-22T20:37:38.6157884+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.6159054+05:30 8000001a-0001-fd00-b63f-84710c7967bb [INF] Request finished in 62.9905ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:38.9518831+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:38.9519331+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:38.9519934+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:38.9520646+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:38.9534523+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:38.9559260+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:38.9568876+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:38.9593085+05:30 80000047-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:38.9593670+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:38.9593942+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:38.9595860+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 7.4789ms (afa2e885)
2021-09-22T20:37:38.9596238+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:38.9620418+05:30 80000047-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:39.0806143+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:39.0807978+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:39.0810556+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:39.0811800+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:39.0849912+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:39.0853760+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:39.0854928+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:39.0859675+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:39.0867785+05:30 80000047-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256454"", Request ID ""80000047-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:39.0870466+05:30 80000047-0006-fc00-b63f-84710c7967bb [INF] Request finished in 135.0878ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:39.0907080+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:39.0922435+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:39.0947212+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:39.0950757+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:39.0955939+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 9.4938ms (afa2e885)
2021-09-22T20:37:39.0956471+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:39.0957445+05:30 8000001c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 10.8023ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.0431168+05:30 80000049-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:53.0434210+05:30 80000049-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0436612+05:30 80000049-0006-fc00-b63f-84710c7967bb [INF] Request finished in 0.5598ms 204  (791a596a)
2021-09-22T20:37:53.0437564+05:30 8000001e-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:37:53.0438402+05:30 8000001e-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0438424+05:30 80000031-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:53.0438954+05:30 80000031-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0439938+05:30 8000001e-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.2458ms 204  (791a596a)
2021-09-22T20:37:53.0442041+05:30 80000031-0006-fd00-b63f-84710c7967bb [INF] Request finished in 0.369ms 204  (791a596a)
2021-09-22T20:37:53.0503203+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:53.0504095+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0505323+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.0509043+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.0510500+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:53.0510698+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:37:53.0511073+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0511235+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.0512281+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.0512685+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.0513257+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.0513609+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.0518221+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:53.0521075+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:53.0526006+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.0541479+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:53.0704349+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:53.0711526+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:53.0715932+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.0716081+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 20.1792ms (afa2e885)
2021-09-22T20:37:53.0716849+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.0719219+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:53.0723120+05:30 800000be-0002-fa00-b63f-84710c7967bb [INF] Request finished in 21.0989ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.0723686+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 21.3745ms (afa2e885)
2021-09-22T20:37:53.0724290+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.0725169+05:30 80000077-0002-fb00-b63f-84710c7967bb [INF] Request finished in 22.2503ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.0732653+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:37:53.0735183+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:37:53.0738577+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 22.462ms (afa2e885)
2021-09-22T20:37:53.0739347+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.0740392+05:30 80000034-0002-f800-b63f-84710c7967bb [INF] Request finished in 23.0983ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.6695355+05:30 800000bb-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:37:53.6697198+05:30 800000bb-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.6699381+05:30 800000bb-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.4244ms 204  (791a596a)
2021-09-22T20:37:53.6750657+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:53.6751310+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.6752090+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.6753238+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.6762777+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:53.6762777+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:53.6763452+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.6763503+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.6764256+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.6764267+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.6765150+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.6765172+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.6776296+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:53.6778791+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:53.6787502+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:37:53.6790551+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 2.4914ms (afa2e885)
2021-09-22T20:37:53.6791146+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.6792215+05:30 80000091-0004-fc00-b63f-84710c7967bb [INF] Request finished in 2.9618ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.6828563+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:53.6863568+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:53.6863568+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.6874681+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:53.6889275+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.6891692+05:30 8000000c-0004-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:53.6891952+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:53.6892454+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:53.6892864+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:53.6895331+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 14.0941ms (afa2e885)
2021-09-22T20:37:53.6895843+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.6895919+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 13.0315ms (afa2e885)
2021-09-22T20:37:53.6896552+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.6897431+05:30 8000006d-0005-fe00-b63f-84710c7967bb [INF] Request finished in 13.4733ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.6925599+05:30 8000000c-0004-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:37:53.9067012+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:37:53.9068700+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.9072043+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.9073318+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.9131889+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:37:53.9132707+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.9133119+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:37:53.9133666+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:37:53.9133885+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.9134527+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:37:53.9135025+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.9135485+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:37:53.9173170+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:37:53.9171858+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:37:53.9192090+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.9201336+05:30 8000000c-0004-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283340196610059"", Request ID ""8000000c-0004-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:53.9202387+05:30 8000000c-0004-f800-b63f-84710c7967bb [INF] Request finished in 245.2077ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:53.9236160+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:53.9238932+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:37:53.9253727+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:37:53.9255358+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:37:53.9257745+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:37:53.9260795+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.4714ms (afa2e885)
2021-09-22T20:37:53.9261178+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.9261968+05:30 8000006f-0005-fe00-b63f-84710c7967bb [INF] Request finished in 12.9314ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:37:53.9299336+05:30 800000bd-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:37:53.9300940+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:37:53.9304275+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.0258ms (afa2e885)
2021-09-22T20:37:53.9304942+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:37:53.9305354+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:37:53.9334760+05:30 800000bd-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668988"", Request ID ""800000bd-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:37:53.9335974+05:30 800000bd-0000-f900-b63f-84710c7967bb [INF] Request finished in 26.9405ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:37:53.9363695+05:30 800000bd-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:38:09.0849155+05:30 80000059-0003-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,003"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:38:09.0884823+05:30 80000059-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:38:09.1870863+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30105.8301ms (afa2e885)
2021-09-22T20:38:09.1872810+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:38:09.1898149+05:30 80000059-0003-fc00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:5e54b3ad-d517-44d3-ae3b-595b43299ae0
Error Number:-2,State:0,Class:11
2021-09-22T20:38:09.1923160+05:30 80000059-0003-fc00-b63f-84710c7967bb [INF] Request finished in 30111.9332ms 500 text/plain (791a596a)
2021-09-22T20:38:23.9370929+05:30 80000093-0004-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,023"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (627a98df)
2021-09-22T20:38:23.9417521+05:30 80000093-0004-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:518bf886-62a7-4c12-94f9-ff4a83cca7d6
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
ClientConnectionId:518bf886-62a7-4c12-94f9-ff4a83cca7d6
Error Number:-2,State:0,Class:11
2021-09-22T20:38:24.0492959+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 30135.7123ms (afa2e885)
2021-09-22T20:38:24.0494871+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:38:24.0520569+05:30 80000093-0004-fc00-b63f-84710c7967bb [ERR] An unhandled exception has occurred while executing the request. (48a46595)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__169_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at IoT.DataLayer.Repository.UserRepository.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 128
   at IoT.BusinessLayer.UserBL.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\UserBL.cs:line 44
   at IoT.WebAPI.Controllers.UserController.GetUserPermission(String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\UserController.cs:line 67
   at lambda_method(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
ClientConnectionId:518bf886-62a7-4c12-94f9-ff4a83cca7d6
Error Number:-2,State:0,Class:11
2021-09-22T20:38:24.0546027+05:30 80000093-0004-fc00-b63f-84710c7967bb [INF] Request finished in 30141.4452ms 500 text/plain (791a596a)
2021-09-22T20:39:55.2960855+05:30 800000bf-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:39:55.2961657+05:30 800000bf-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.2963492+05:30 800000bf-0000-f900-b63f-84710c7967bb [INF] Request finished in 0.3297ms 204  (791a596a)
2021-09-22T20:39:55.2969684+05:30 80000033-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/addUser   (ca22a1cb)
2021-09-22T20:39:55.2970088+05:30 80000020-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:55.2970386+05:30 80000033-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.2970593+05:30 80000020-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.2971719+05:30 80000020-0001-fd00-b63f-84710c7967bb [INF] Request finished in 0.2961ms 204  (791a596a)
2021-09-22T20:39:55.2971697+05:30 80000033-0006-fd00-b63f-84710c7967bb [INF] Request finished in 0.2694ms 204  (791a596a)
2021-09-22T20:39:55.3031394+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/device/getDeviceTypeDropdown   (ca22a1cb)
2021-09-22T20:39:55.3039700+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.3043488+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.3045728+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:55.3051137+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetDeviceTypeDropdown\", controller = \"Device\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetDeviceTypeDropdown()" on controller "IoT.WebAPI.Controllers.DeviceController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.3052233+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.3054431+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.3056427+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.3111310+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [d].[DeviceTypeId], [d].[DeviceTypeName]
FROM [DeviceType] AS [d]
ORDER BY [d].[DeviceTypeName]" (0723d8ff)
2021-09-22T20:39:55.3139321+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:55.3139744+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[<>f__AnonymousType8`2[[System.Int32, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], IoT.DataLayer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'. (8a1b66c8)
2021-09-22T20:39:55.3139942+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.3139875+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:55.3140831+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.3157539+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.3194428+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)" in 14.1548ms (afa2e885)
2021-09-22T20:39:55.3195528+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.DeviceController.GetDeviceTypeDropdown (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.3197274+05:30 80000038-0002-f800-b63f-84710c7967bb [INF] Request finished in 16.7957ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:55.3348162+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("12"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:55.3386652+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:55.3391475+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 23.3017ms (afa2e885)
2021-09-22T20:39:55.3392177+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.3393287+05:30 800000c1-0000-f900-b63f-84710c7967bb [INF] Request finished in 28.171ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:55.3404335+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("17"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:55.3437721+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:55.3440566+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:55.3444265+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 38.6535ms (afa2e885)
2021-09-22T20:39:55.3444805+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.3445636+05:30 80000022-0001-fd00-b63f-84710c7967bb [INF] Request finished in 40.0747ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:55.8909214+05:30 80000052-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 OPTIONS https://localhost:44342/api/v1/activityLog/add   (ca22a1cb)
2021-09-22T20:39:55.8911624+05:30 80000052-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.8917342+05:30 80000052-0007-ff00-b63f-84710c7967bb [INF] Request finished in 0.7219ms 204  (791a596a)
2021-09-22T20:39:55.9063800+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:55.9081276+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.9083035+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.9084708+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.9155715+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:55.9157057+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.9158841+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.9160844+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.9191005+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:55.9201879+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:55.9203656+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:55.9205745+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:55.9209585+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:55.9215592+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:55.9224746+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:55.9234436+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.1784ms (afa2e885)
2021-09-22T20:39:55.9236716+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.9238495+05:30 80000024-0001-fd00-b63f-84710c7967bb [INF] Request finished in 8.3591ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:55.9251436+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:55.9282652+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:55.9321929+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:55.9324282+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:55.9325174+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:55.9330575+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 11.3734ms (afa2e885)
2021-09-22T20:39:55.9331132+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.9332030+05:30 8000003a-0002-f800-b63f-84710c7967bb [INF] Request finished in 12.9993ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:55.9370534+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:55.9410570+05:30 8000005b-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:55.9411744+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:55.9415264+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 32.877ms (afa2e885)
2021-09-22T20:39:55.9415824+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:55.9439411+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:55.9445979+05:30 8000005b-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354586"", Request ID ""8000005b-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:55.9446818+05:30 8000005b-0003-fc00-b63f-84710c7967bb [INF] Request finished in 38.3774ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:55.9473630+05:30 8000005b-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:56.2034367+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:56.2034845+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.2035380+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.2036026+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.2051240+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:56.2080977+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.2109519+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.2114262+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:56.2114434+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:56.2114998+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.2115043+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.2115736+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.2115724+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.2116629+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.2116636+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.2121327+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:56.2131893+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.2145771+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:56.2148024+05:30 80000054-0007-ff00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:56.2148525+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.2148821+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:56.2152782+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.5388ms (afa2e885)
2021-09-22T20:39:56.2152819+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 11.6098ms (afa2e885)
2021-09-22T20:39:56.2153556+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.2156381+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.2168769+05:30 80000035-0006-fd00-b63f-84710c7967bb [INF] Request finished in 5.4566ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:56.2168684+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:56.2180403+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.2233373+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.2235618+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:56.2238034+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 12.0979ms (afa2e885)
2021-09-22T20:39:56.2238349+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.2239515+05:30 80000071-0005-fe00-b63f-84710c7967bb [INF] Request finished in 12.509ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:56.2243043+05:30 80000054-0007-ff00-b63f-84710c7967bb [ERR] Connection ID ""18374686511347007571"", Request ID ""80000054-0007-ff00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:56.2243942+05:30 80000054-0007-ff00-b63f-84710c7967bb [INF] Request finished in 20.9662ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:56.2245216+05:30 80000054-0007-ff00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:56.5014523+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:56.5015566+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.5016626+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.5017660+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.5064776+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:56.5101638+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:56.5101637+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:56.5102757+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.5103121+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.5103815+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.5103830+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.5104208+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.5104565+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.5104568+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.5108223+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:56.5112420+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.5122981+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.5134041+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:56.5134130+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.5134124+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.5137174+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.2156ms (afa2e885)
2021-09-22T20:39:56.5138328+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.5139333+05:30 80000037-0006-fd00-b63f-84710c7967bb [INF] Request finished in 3.8498ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:56.5148580+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.5152161+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:56.5155939+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.0731ms (afa2e885)
2021-09-22T20:39:56.5156379+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.5157166+05:30 8000004b-0006-fc00-b63f-84710c7967bb [INF] Request finished in 5.6293ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:56.5188930+05:30 800000d9-0004-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:56.5192886+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:56.5203904+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 18.5251ms (afa2e885)
2021-09-22T20:39:56.5204580+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.5229453+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("7"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:56.5239310+05:30 800000d9-0004-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456122310394072"", Request ID ""800000d9-0004-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:56.5240892+05:30 800000d9-0004-fb00-b63f-84710c7967bb [INF] Request finished in 22.6965ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:56.5261459+05:30 800000d9-0004-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:56.8578244+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:56.8579045+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.8579919+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.8581313+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.8599079+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:56.8638119+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.8673573+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.8698417+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:56.8699079+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.8706361+05:30 80000026-0001-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:56.8706912+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.8707346+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:56.8707978+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.8709568+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.7753ms (afa2e885)
2021-09-22T20:39:56.8709908+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.8698663+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:56.8711460+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:56.8712263+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:56.8714362+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:56.8717951+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:56.8749151+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:56.8749142+05:30 80000026-0001-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571297501347877"", Request ID ""80000026-0001-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:56.8751414+05:30 80000026-0001-fd00-b63f-84710c7967bb [INF] Request finished in 17.2938ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:56.8758624+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:56.8758892+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:56.8763181+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.4609ms (afa2e885)
2021-09-22T20:39:56.8763724+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.8767125+05:30 80000026-0001-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:56.8767835+05:30 8000003c-0002-f800-b63f-84710c7967bb [INF] Request finished in 6.6681ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:56.8772396+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.8798712+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:56.8814103+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:56.8817008+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:56.8820438+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.5391ms (afa2e885)
2021-09-22T20:39:56.8820947+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:56.8821821+05:30 8000005d-0003-fc00-b63f-84710c7967bb [INF] Request finished in 12.3893ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.0869333+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:57.0870253+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.0872329+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.0874725+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.0920318+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:57.0935221+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:57.0939930+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.0944586+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.0946782+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.0974857+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.0997691+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:57.0999691+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:57.1000478+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.1005959+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.823ms (afa2e885)
2021-09-22T20:39:57.1007108+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.1007869+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.1009421+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.1010660+05:30 8000003e-0002-f800-b63f-84710c7967bb [INF] Request finished in 7.4528ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.1021897+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.1023428+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.1037143+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.1051146+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.1051784+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.1054974+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:57.1059202+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 4.8635ms (afa2e885)
2021-09-22T20:39:57.1060175+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.1062608+05:30 80000073-0005-fe00-b63f-84710c7967bb [INF] Request finished in 6.6312ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.1108067+05:30 800000db-0004-fb00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:57.1109271+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:57.1109579+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:57.1113120+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 23.6528ms (afa2e885)
2021-09-22T20:39:57.1113773+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.1151925+05:30 800000db-0004-fb00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:57.3059192+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:57.3061102+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.3065227+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.3069123+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.3124868+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:57.3129209+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.3131822+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.3136897+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.3164887+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:57.3175001+05:30 8000004d-0006-fc00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("8"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (627a98df)
2021-09-22T20:39:57.3203569+05:30 8000004d-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()" (f5c7ac34)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:39:57.3204363+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:57.3213151+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.3241641+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.3244129+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.3675375+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:57.3676006+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("48"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.4055945+05:30 800000db-0004-fb00-b63f-84710c7967bb [ERR] Connection ID ""18086456122310394074"", Request ID ""800000db-0004-fb00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: Invalid operation. The connection is closed.
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Span`1 buff, Int32 len, Int32& totalRead)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipPlpValue(UInt64 cb, TdsParserStateObject stateObj, UInt64& totalBytesSkipped)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipValue(SqlMetaDataPriv md, Int32 columnOrdinal, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TrySkipRow(_SqlMetaDataSet columns, Int32 startCol, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:57.4058787+05:30 800000db-0004-fb00-b63f-84710c7967bb [INF] Request finished in 318.8086ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:57.4067941+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.4069817+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:57.4093883+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 95.5646ms (afa2e885)
2021-09-22T20:39:57.4094837+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.4095235+05:30 8000004d-0006-fc00-b63f-84710c7967bb [ERR] Error Occured while Adding the Activity log: User Key "100965730392215373474" (8dd3a42a)
System.InvalidOperationException: Internal connection fatal error.
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.ActivityLogRepository.Add(ActivityLog entity, String userKey) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\ActivityLogRepository.cs:line 23
   at IoT.BusinessLayer.ActivityLogsBL.Add(ActivityLog activityLog, String userKey) in E:\IoTAutomation\IoTAutomation\IoT.BusinessLayer\ActivityLogsBL.cs:line 23
   at IoT.WebAPI.Controllers.ActivityLogController.Add(ActivityLog device, String userKey) in E:\IoTAutomation\IoTAutomation\IoTAutomation\Controllers\ActivityLogController.cs:line 34
2021-09-22T20:39:57.4098900+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"Microsoft.AspNetCore.Mvc.ProblemDetails"'. (8a1b66c8)
2021-09-22T20:39:57.4164801+05:30 8000005f-0003-fc00-b63f-84710c7967bb [INF] Request finished in 103.9554ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.4165952+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("6"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.4166444+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 109.5949ms (afa2e885)
2021-09-22T20:39:57.4167065+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.4168332+05:30 8000004d-0006-fc00-b63f-84710c7967bb [INF] Request finished in 111.1925ms 400 application/problem+json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.4205231+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.4209101+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:57.4214775+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 96.9418ms (afa2e885)
2021-09-22T20:39:57.4215674+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.4217118+05:30 80000095-0004-fc00-b63f-84710c7967bb [INF] Request finished in 102.0471ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.5424203+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:57.5424673+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.5425208+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.5425961+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.5444957+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:57.5476413+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.5504048+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.5556308+05:30 800000c3-0000-f900-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:57.5557503+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:57.5560987+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 13.4565ms (afa2e885)
2021-09-22T20:39:57.5561479+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.5567427+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:57.5593487+05:30 800000c3-0000-f900-b63f-84710c7967bb [ERR] Connection ID ""17942340917054668994"", Request ID ""800000c3-0000-f900-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:57.5594420+05:30 800000c3-0000-f900-b63f-84710c7967bb [INF] Request finished in 17.038ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:57.5601660+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:57.5602590+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.5604598+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.5605714+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.5605742+05:30 800000c3-0000-f900-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:57.5639686+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:57.5646116+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.5648465+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.5649891+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.5651601+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.5654518+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:57.5658923+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 5.2168ms (afa2e885)
2021-09-22T20:39:57.5659543+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.5660717+05:30 8000004f-0006-fc00-b63f-84710c7967bb [INF] Request finished in 5.9344ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.5670694+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.5705011+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.5720195+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.5722739+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:57.5726541+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 7.4324ms (afa2e885)
2021-09-22T20:39:57.5727201+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.5728140+05:30 80000040-0002-f800-b63f-84710c7967bb [INF] Request finished in 9.0787ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.8731633+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:57.8732406+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.8733320+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.8735305+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.8761494+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:57.8788333+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.8814951+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.8857177+05:30 80000051-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:57.8858893+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:57.8861983+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.5433ms (afa2e885)
2021-09-22T20:39:57.8862562+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.8877374+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:57.8883743+05:30 80000051-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256464"", Request ID ""80000051-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:57.8884552+05:30 80000051-0006-fc00-b63f-84710c7967bb [INF] Request finished in 15.3441ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:57.8890359+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:57.8891205+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.8891618+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:57.8891977+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:57.8892175+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.8892413+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:57.8893038+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.8893068+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:57.8900659+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:57.8925833+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.8953489+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:57.8957594+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Executed DbCommand ("5"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:57.8961929+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:57.8969853+05:30 80000051-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:57.8970074+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 7.6338ms (afa2e885)
2021-09-22T20:39:57.8975263+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.8976690+05:30 80000025-0001-fe00-b63f-84710c7967bb [INF] Request finished in 8.6593ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:57.8987815+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:57.8990420+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:57.8993736+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 10.019ms (afa2e885)
2021-09-22T20:39:57.8994186+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:57.8995508+05:30 80000028-0001-fd00-b63f-84710c7967bb [INF] Request finished in 10.4009ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.3305041+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:58.3305929+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.3306962+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.3308751+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.3330542+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:58.3348542+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:58.3348542+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:58.3349145+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.3349145+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.3349880+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.3349880+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.3350595+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.3350595+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.3356326+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:58.3360472+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.3364348+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.3374004+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.3383021+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.3382997+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:58.3385554+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.3386129+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.5053ms (afa2e885)
2021-09-22T20:39:58.3386738+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.3388028+05:30 8000002f-0003-fb00-b63f-84710c7967bb [INF] Request finished in 3.9861ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.3401305+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.3403816+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:58.3407282+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 5.6013ms (afa2e885)
2021-09-22T20:39:58.3407799+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.3409022+05:30 8000002a-0001-fd00-b63f-84710c7967bb [INF] Request finished in 6.0844ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.3418661+05:30 80000061-0003-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:58.3419972+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:58.3423918+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 11.2983ms (afa2e885)
2021-09-22T20:39:58.3424436+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.3427633+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:58.3455617+05:30 80000061-0003-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513712053354592"", Request ID ""80000061-0003-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:58.3456424+05:30 80000061-0003-fc00-b63f-84710c7967bb [INF] Request finished in 15.1904ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:58.3466390+05:30 80000061-0003-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:58.5952718+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:58.5956407+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.5958903+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.5961353+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.5994841+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:58.6003211+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:58.6004906+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.6006187+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.6007311+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.6007463+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:58.6007960+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.6008688+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.6009432+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.6019754+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:58.6033973+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.6035619+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.6046152+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:58.6049743+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.1833ms (afa2e885)
2021-09-22T20:39:58.6050318+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.6051436+05:30 80000079-0002-fb00-b63f-84710c7967bb [INF] Request finished in 4.9152ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.6055205+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.6064111+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.6086425+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.6086471+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.6089027+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:58.6092562+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 8.2638ms (afa2e885)
2021-09-22T20:39:58.6092965+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.6093668+05:30 80000053-0006-fc00-b63f-84710c7967bb [INF] Request finished in 8.6487ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.6134422+05:30 80000042-0002-f800-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:58.6135524+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:58.6137920+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 17.565ms (afa2e885)
2021-09-22T20:39:58.6138420+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.6151467+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:58.6169922+05:30 80000042-0002-f800-b63f-84710c7967bb [ERR] Connection ID ""17870283331606675521"", Request ID ""80000042-0002-f800-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:58.6172870+05:30 80000042-0002-f800-b63f-84710c7967bb [INF] Request finished in 21.9661ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:58.6194522+05:30 80000042-0002-f800-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:58.8207699+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:58.8208270+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.8209101+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.8210041+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.8232724+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:58.8268508+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.8300272+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.8330664+05:30 8000002c-0001-fd00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:58.8331752+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:58.8334273+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 12.3632ms (afa2e885)
2021-09-22T20:39:58.8334912+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.8355570+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:58.8360038+05:30 8000002c-0001-fd00-b63f-84710c7967bb [ERR] Connection ID ""18230571297501347883"", Request ID ""8000002c-0001-fd00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:58.8361371+05:30 8000002c-0001-fd00-b63f-84710c7967bb [INF] Request finished in 15.3609ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:39:58.8399526+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:58.8400382+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.8401188+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:58.8401252+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.8401449+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:58.8402098+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:58.8402191+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.8402577+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:58.8406645+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:58.8409523+05:30 8000002c-0001-fd00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:58.8416568+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.8431459+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("2"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:58.8436062+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:58.8439830+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime2), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Users] SET [APIKey] = @p0, [AuthProvidor] = @p1, [CreatedDate] = @p2, [Email] = @p3, [FirstName] = @p4, [Language] = @p5, [LastLogin] = @p6, [Lastname] = @p7, [ModifiedDate] = @p8, [Temperature] = @p9, [Timezone] = @p10, [UserKey] = @p11
WHERE [UserId] = @p12;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:58.8440429+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 3.7326ms (afa2e885)
2021-09-22T20:39:58.8441073+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.8442480+05:30 80000056-0007-ff00-b63f-84710c7967bb [INF] Request finished in 4.1266ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:58.8458103+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (0723d8ff)
2021-09-22T20:39:58.8460901+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.User"'. (8a1b66c8)
2021-09-22T20:39:58.8464459+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)" in 6.1637ms (afa2e885)
2021-09-22T20:39:58.8464980+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:58.8465932+05:30 80000097-0004-fc00-b63f-84710c7967bb [INF] Request finished in 7.0863ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:59.1152253+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/activityLog/add application/json;charset=UTF-8 144 (ca22a1cb)
2021-09-22T20:39:59.1152969+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:59.1153788+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:59.1154915+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Route matched with "{action = \"Add\", controller = \"ActivityLog\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult Add(IoT.DataLayer.Models.ActivityLog, System.String)" on controller "IoT.WebAPI.Controllers.ActivityLogController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:59.1179288+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [a].[ActivityLogId], [a].[Activity], [a].[AppName], [a].[CreatedDate], [a].[IPAddress], [a].[Location], [a].[ModifiedDate], [a].[UserKey]
FROM [ActivityLog] AS [a]
WHERE [a].[UserKey] = @__userKey_0
ORDER BY [a].[CreatedDate] DESC" (0723d8ff)
2021-09-22T20:39:59.1252564+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
DELETE FROM [ActivityLog]
WHERE [ActivityLogId] = @p0;
SELECT @@ROWCOUNT;" (0723d8ff)
2021-09-22T20:39:59.1287303+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:59.1299218+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 GET https://localhost:44342/api/v1/user/getUserPermission   (ca22a1cb)
2021-09-22T20:39:59.1299218+05:30 80000014-0007-fe00-b63f-84710c7967bb [INF] Request starting HTTP/2.0 POST https://localhost:44342/api/v1/user/addUser application/json;charset=UTF-8 163 (ca22a1cb)
2021-09-22T20:39:59.1299780+05:30 80000014-0007-fe00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:59.1300072+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] CORS policy execution successful. (5409d6ef)
2021-09-22T20:39:59.1300472+05:30 80000014-0007-fe00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.AddUser (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:59.1300678+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Executing endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (500cc934)
2021-09-22T20:39:59.1301206+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Route matched with "{action = \"GetUserPermission\", controller = \"User\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[IoT.DataLayer.Models.UserPermission] GetUserPermission(System.String)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:59.1301227+05:30 80000014-0007-fe00-b63f-84710c7967bb [INF] Route matched with "{action = \"AddUser\", controller = \"User\"}". Executing controller action with signature "IoT.DataLayer.Models.User AddUser(IoT.DataLayer.Models.User)" on controller "IoT.WebAPI.Controllers.UserController" ("IoT.WebAPI"). (122b2fdf)
2021-09-22T20:39:59.1321901+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@__userKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserPermissionId], [u].[CanCreate], [u].[CanDelete], [u].[CanUpdate], [u].[CanView], [u].[CreatedDate], [u].[IsAdmin], [u].[ModifiedDate], [u].[UserId], [u].[UserKey]
FROM [UserPermission] AS [u]
WHERE [u].[UserKey] = @__userKey_0" (0723d8ff)
2021-09-22T20:39:59.1323405+05:30 80000055-0006-fc00-b63f-84710c7967bb [ERR] Unable to Add Activity Log: User Key "100965730392215373474" (d7ff0863)
2021-09-22T20:39:59.1324501+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"System.String"'. (8a1b66c8)
2021-09-22T20:39:59.1324734+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ActivityLog] ([Activity], [AppName], [CreatedDate], [IPAddress], [Location], [ModifiedDate], [UserKey])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ActivityLogId]
FROM [ActivityLog]
WHERE @@ROWCOUNT = 1 AND [ActivityLogId] = scope_identity();" (0723d8ff)
2021-09-22T20:39:59.1325149+05:30 80000014-0007-fe00-b63f-84710c7967bb [INF] Entity Framework Core "5.0.9" initialized '"AppDbContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MaxPoolSize=128 " (9958f5bb)
2021-09-22T20:39:59.1327135+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)" in 17.1084ms (afa2e885)
2021-09-22T20:39:59.1327560+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.ActivityLogController.Add (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:59.1345268+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Executing ObjectResult, writing value of type '"IoT.DataLayer.Models.UserPermission"'. (8a1b66c8)
2021-09-22T20:39:59.1350799+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Executed action "IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)" in 4.8742ms (afa2e885)
2021-09-22T20:39:59.1359166+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Executed endpoint '"IoT.WebAPI.Controllers.UserController.GetUserPermission (IoT.WebAPI)"' (99874f2b)
2021-09-22T20:39:59.1360933+05:30 80000058-0007-ff00-b63f-84710c7967bb [INF] Request finished in 6.1758ms 200 application/json; charset=utf-8 (791a596a)
2021-09-22T20:39:59.1415381+05:30 80000055-0006-fc00-b63f-84710c7967bb [ERR] An exception occurred in the database while saving changes for context type '"IoT.DataLayer.AppDbContext"'."
""System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" (170f029e)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Remove(Object entity, IEntityType entityType, EntityState oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityReferenceMap.Update(InternalEntityEntry entry, EntityState state, Nullable`1 oldState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-09-22T20:39:59.1418611+05:30 80000055-0006-fc00-b63f-84710c7967bb [ERR] Connection ID ""18158513724938256468"", Request ID ""80000055-0006-fc00-b63f-84710c7967bb"": An unhandled exception was thrown by the application. (bf316047)
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.DisposeAsync()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IResettableService.ResetStateAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.DbContextPool`1.ReturnAsync(IDbContextPoolable context, CancellationToken cancellationToken)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|15_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.FireOnCompleted()
2021-09-22T20:39:59.1419156+05:30 80000055-0006-fc00-b63f-84710c7967bb [INF] Request finished in 26.7282ms 400 text/plain; charset=utf-8 (791a596a)
2021-09-22T20:40:29.1486668+05:30 80000014-0007-fe00-b63f-84710c7967bb [ERR] Failed executing DbCommand ("30,012"ms) [Parameters=["@__newUser_UserKey_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [u].[UserId], [u].[APIKey], [u].[AuthProvidor], [u].[CreatedDate], [u].[Email], [u].[FirstName], [u].[Language], [u].[LastLogin], [u].[Lastname], [u].[ModifiedDate], [u].[Temperature], [u].[Timezone], [u].[UserKey]
FROM [Users] AS [u]
WHERE [u].[UserKey] = @__newUser_UserKey_0" (627a98df)
2021-09-22T20:40:29.1508163+05:30 80000014-0007-fe00-b63f-84710c7967bb [ERR] An exception occurred while iterating over the results of a query for context type '"IoT.DataLayer.AppDbContext"'."
""Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:518bf886-62a7-4c12-94f9-ff4a83cca7d6
Error Number:-2,State:0,Class:11" (f5c7ac34)
Microsoft.Data.SqlClient.SqlException (0x80131904): Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(DbContext _, Boolean result)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at IoT.DataLayer.Repository.UserRepository.Add(User newUser) in E:\IoTAutomation\IoTAutomation\DataLayer\Repository\UserRepository.cs:line 24
ClientConnectionId:518bf886-62a7-4c12-94f9-ff4a83cca7d6
Error Number:-2,State:0,Class:11
